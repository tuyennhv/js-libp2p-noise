(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PNoise = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PNoise=(()=>{var Ih=Object.create;var ii=Object.defineProperty;var Lh=Object.getOwnPropertyDescriptor;var Rh=Object.getOwnPropertyNames;var Uh=Object.getPrototypeOf,Nh=Object.prototype.hasOwnProperty;var _o=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var k=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ot=(e,t)=>{for(var r in t)ii(e,r,{get:t[r],enumerable:!0})},Co=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Rh(t))!Nh.call(e,i)&&i!==r&&ii(e,i,{get:()=>t[i],enumerable:!(n=Lh(t,i))||n.enumerable});return e};var Y=(e,t,r)=>(r=e!=null?Ih(Uh(e)):{},Co(t||!e||!e.__esModule?ii(r,"default",{value:e,enumerable:!0}):r,e)),Ph=e=>Co(ii({},"__esModule",{value:!0}),e);var oe=k((Qg,ko)=>{"use strict";function Po(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function Gh(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return Po(e,r)}catch{r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),Po(new i,r)}}ko.exports=Gh});var Fo=k((ux,Ko)=>{Ko.exports=class{constructor(t){if(!(t>0)||(t-1&t)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){let t=this.buffer[this.btm];if(t!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var Ho=k((lx,Oo)=>{var Mo=Fo();Oo.exports=class{constructor(t){this.hwm=t||16,this.head=new Mo(this.hwm),this.tail=this.head}push(t){if(!this.head.push(t)){let r=this.head;this.head=r.next=new Mo(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(t===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return t}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var qo=k((px,Vo)=>{var ms=Ho();Vo.exports=e=>{e=e||{};let t;typeof e=="function"?(t=e,e={}):t=e.onEnd;let r=new ms,n,i,s,a=()=>{if(!r.isEmpty()){if(e.writev){let y,g=[];for(;!r.isEmpty();){if(y=r.shift(),y.error)throw y.error;g.push(y.value)}return{done:y.done,value:g}}let p=r.shift();if(p.error)throw p.error;return p}return s?{done:!0}:new Promise((p,y)=>{i=g=>(i=null,g.error?y(g.error):e.writev&&!g.done?p({done:g.done,value:[g.value]}):p(g),n)})},o=p=>i?i(p):(r.push(p),n),f=p=>(r=new ms,i?i({error:p}):(r.push({error:p}),n)),c=p=>s?n:o({done:!1,value:p}),u=p=>s?n:(s=!0,p?f(p):o({done:!0})),h=()=>(r=new ms,u(),{done:!0}),l=p=>(u(p),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:a,return:h,throw:l,push:c,end:u},!t)return n;let d=n;return n={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(p){return d.throw(p),t&&(t(p),t=null),{done:!0}},return(){return d.return(),t&&(t(),t=null),{done:!0}},push:c,end(p){return d.end(p),t&&(t(p),t=null),n}},n}});var Go=k((dx,zo)=>{"use strict";var $h=qo(),Zh=async function*(...e){let t=$h();setTimeout(async()=>{try{await Promise.all(e.map(async r=>{for await(let n of r)t.push(n)})),t.end()}catch(r){t.end(r)}},0),yield*t};zo.exports=Zh});var Zo=k(ws=>{"use strict";Object.defineProperty(ws,"__esModule",{value:!0});function jh(e){return typeof e.saveState<"u"&&typeof e.restoreState<"u"&&typeof e.cleanSavedState<"u"}ws.isSerializableHash=jh});var ui=k(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});function tl(e,t,r){return~(e-1)&t|e-1&r}Mr.select=tl;function el(e,t){return(e|0)-(t|0)-1>>>31&1}Mr.lessOrEqual=el;function Qo(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}Mr.compare=Qo;function rl(e,t){return e.length===0||t.length===0?!1:Qo(e,t)!==0}Mr.equal=rl});var Be=k(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});function nl(e){for(var t=0;t<e.length;t++)e[t]=0;return e}bs.wipe=nl});var jo=k(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});var Ae=Zo(),il=ui(),sl=Be(),Jo=function(){function e(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),Ae.isSerializableHash(this._inner)&&Ae.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),sl.wipe(n)}return e.prototype.reset=function(){if(!Ae.isSerializableHash(this._inner)||!Ae.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){Ae.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ae.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(t){return this._inner.update(t),this},e.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(!Ae.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(t){if(!Ae.isSerializableHash(this._inner)||!Ae.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(t){if(!Ae.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},e}();En.HMAC=Jo;function al(e,t,r){var n=new Jo(e,t);n.update(r);var i=n.digest();return n.clean(),i}En.hmac=al;En.equal=il.equal});var r0=k(Es=>{"use strict";Object.defineProperty(Es,"__esModule",{value:!0});var t0=jo(),e0=Be(),ol=function(){function e(t,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=i;var s=t0.hmac(this._hash,n,r);this._hmac=new t0.HMAC(t,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(t){for(var r=new Uint8Array(t),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},e.prototype.clean=function(){this._hmac.clean(),e0.wipe(this._buffer),e0.wipe(this._counter),this._bufpos=0},e}();Es.HKDF=ol});var i0=k(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});hi.BrowserRandomSource=void 0;var n0=65536,Ss=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");let r=new Uint8Array(t);for(let n=0;n<r.length;n+=n0)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,n0)));return r}};hi.BrowserRandomSource=Ss});var mr=k(()=>{});var s0=k(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.NodeRandomSource=void 0;var fl=Be(),Bs=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof _o<"u"){let t=mr();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");let n=new Uint8Array(t);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,fl.wipe)(r),n}};li.NodeRandomSource=Bs});var a0=k(pi=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0});pi.SystemRandomSource=void 0;var cl=i0(),ul=s0(),As=class{constructor(){if(this.isAvailable=!1,this.name="",this._source=new cl.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new ul.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}};pi.SystemRandomSource=As});var o0=k(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});function hl(e,t){var r=e>>>16&65535,n=e&65535,i=t>>>16&65535,s=t&65535;return n*s+(r*s+n*i<<16>>>0)|0}fe.mul=Math.imul||hl;function ll(e,t){return e+t|0}fe.add=ll;function pl(e,t){return e-t|0}fe.sub=pl;function dl(e,t){return e<<t|e>>>32-t}fe.rotl=dl;function yl(e,t){return e<<32-t|e>>>t}fe.rotr=yl;function gl(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}fe.isInteger=Number.isInteger||gl;fe.MAX_SAFE_INTEGER=9007199254740991;fe.isSafeInteger=function(e){return fe.isInteger(e)&&e>=-fe.MAX_SAFE_INTEGER&&e<=fe.MAX_SAFE_INTEGER}});var Sn=k(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});var f0=o0();function xl(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}X.readInt16BE=xl;function ml(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}X.readUint16BE=ml;function vl(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}X.readInt16LE=vl;function wl(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}X.readUint16LE=wl;function c0(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}X.writeUint16BE=c0;X.writeInt16BE=c0;function u0(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}X.writeUint16LE=u0;X.writeInt16LE=u0;function _s(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}X.readInt32BE=_s;function Cs(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}X.readUint32BE=Cs;function Ts(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}X.readInt32LE=Ts;function Is(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}X.readUint32LE=Is;function di(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}X.writeUint32BE=di;X.writeInt32BE=di;function yi(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}X.writeUint32LE=yi;X.writeInt32LE=yi;function bl(e,t){t===void 0&&(t=0);var r=_s(e,t),n=_s(e,t+4);return r*4294967296+n-(n>>31)*4294967296}X.readInt64BE=bl;function El(e,t){t===void 0&&(t=0);var r=Cs(e,t),n=Cs(e,t+4);return r*4294967296+n}X.readUint64BE=El;function Sl(e,t){t===void 0&&(t=0);var r=Ts(e,t),n=Ts(e,t+4);return n*4294967296+r-(r>>31)*4294967296}X.readInt64LE=Sl;function Bl(e,t){t===void 0&&(t=0);var r=Is(e,t),n=Is(e,t+4);return n*4294967296+r}X.readUint64LE=Bl;function h0(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),di(e/4294967296>>>0,t,r),di(e>>>0,t,r+4),t}X.writeUint64BE=h0;X.writeInt64BE=h0;function l0(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),yi(e>>>0,t,r),yi(e/4294967296>>>0,t,r+4),t}X.writeUint64LE=l0;X.writeInt64LE=l0;function Al(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=e/8+r-1;s>=r;s--)n+=t[s]*i,i*=256;return n}X.readUintBE=Al;function _l(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+e/8;s++)n+=t[s]*i,i*=256;return n}X.readUintLE=_l;function Cl(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!f0.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,s=e/8+n-1;s>=n;s--)r[s]=t/i&255,i*=256;return r}X.writeUintBE=Cl;function Tl(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!f0.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+e/8;s++)r[s]=t/i&255,i*=256;return r}X.writeUintLE=Tl;function Il(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}X.readFloat32BE=Il;function Ll(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}X.readFloat32LE=Ll;function Rl(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}X.readFloat64BE=Rl;function Ul(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}X.readFloat64LE=Ul;function Nl(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}X.writeFloat32BE=Nl;function Pl(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}X.writeFloat32LE=Pl;function kl(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}X.writeFloat64BE=kl;function Dl(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}X.writeFloat64LE=Dl});var g0=k(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.randomStringForEntropy=Jt.randomString=Jt.randomUint32=Jt.randomBytes=Jt.defaultRandomSource=void 0;var Kl=a0(),Fl=Sn(),p0=Be();Jt.defaultRandomSource=new Kl.SystemRandomSource;function Ls(e,t=Jt.defaultRandomSource){return t.randomBytes(e)}Jt.randomBytes=Ls;function Ml(e=Jt.defaultRandomSource){let t=Ls(4,e),r=(0,Fl.readUint32LE)(t);return(0,p0.wipe)(t),r}Jt.randomUint32=Ml;var d0="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function y0(e,t=d0,r=Jt.defaultRandomSource){if(t.length<2)throw new Error("randomString charset is too short");if(t.length>256)throw new Error("randomString charset is too long");let n="",i=t.length,s=256-256%i;for(;e>0;){let a=Ls(Math.ceil(e*256/s),r);for(let o=0;o<a.length&&e>0;o++){let f=a[o];f<s&&(n+=t.charAt(f%i),e--)}(0,p0.wipe)(a)}return n}Jt.randomString=y0;function Ol(e,t=d0,r=Jt.defaultRandomSource){let n=Math.ceil(e/(Math.log(t.length)/Math.LN2));return y0(n,t,r)}Jt.randomStringForEntropy=Ol});var w0=k(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.sharedKey=Tt.generateKeyPair=Tt.generateKeyPairFromSeed=Tt.scalarMultBase=Tt.scalarMult=Tt.SHARED_KEY_LENGTH=Tt.SECRET_KEY_LENGTH=Tt.PUBLIC_KEY_LENGTH=void 0;var Hl=g0(),Vl=Be();Tt.PUBLIC_KEY_LENGTH=32;Tt.SECRET_KEY_LENGTH=32;Tt.SHARED_KEY_LENGTH=32;function _e(e){let t=new Float64Array(16);if(e)for(let r=0;r<e.length;r++)t[r]=e[r];return t}var x0=new Uint8Array(32);x0[0]=9;var ql=_e([56129,1]);function Rs(e){let t=1;for(let r=0;r<16;r++){let n=e[r]+t+65535;t=Math.floor(n/65536),e[r]=n-t*65536}e[0]+=t-1+37*(t-1)}function Bn(e,t,r){let n=~(r-1);for(let i=0;i<16;i++){let s=n&(e[i]^t[i]);e[i]^=s,t[i]^=s}}function zl(e,t){let r=_e(),n=_e();for(let i=0;i<16;i++)n[i]=t[i];Rs(n),Rs(n),Rs(n);for(let i=0;i<2;i++){r[0]=n[0]-65517;for(let a=1;a<15;a++)r[a]=n[a]-65535-(r[a-1]>>16&1),r[a-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);let s=r[15]>>16&1;r[14]&=65535,Bn(n,r,1-s)}for(let i=0;i<16;i++)e[2*i]=n[i]&255,e[2*i+1]=n[i]>>8}function Gl(e,t){for(let r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function gi(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]+r[n]}function xi(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]-r[n]}function Ve(e,t,r){let n,i,s=0,a=0,o=0,f=0,c=0,u=0,h=0,l=0,d=0,p=0,y=0,g=0,m=0,b=0,w=0,C=0,A=0,B=0,L=0,R=0,D=0,O=0,G=0,z=0,nt=0,pt=0,M=0,V=0,S=0,H=0,gt=0,Z=r[0],Q=r[1],J=r[2],at=r[3],ot=r[4],ft=r[5],ct=r[6],ut=r[7],zt=r[8],Gt=r[9],Wt=r[10],Yt=r[11],Xt=r[12],$t=r[13],Zt=r[14],Qt=r[15];n=t[0],s+=n*Z,a+=n*Q,o+=n*J,f+=n*at,c+=n*ot,u+=n*ft,h+=n*ct,l+=n*ut,d+=n*zt,p+=n*Gt,y+=n*Wt,g+=n*Yt,m+=n*Xt,b+=n*$t,w+=n*Zt,C+=n*Qt,n=t[1],a+=n*Z,o+=n*Q,f+=n*J,c+=n*at,u+=n*ot,h+=n*ft,l+=n*ct,d+=n*ut,p+=n*zt,y+=n*Gt,g+=n*Wt,m+=n*Yt,b+=n*Xt,w+=n*$t,C+=n*Zt,A+=n*Qt,n=t[2],o+=n*Z,f+=n*Q,c+=n*J,u+=n*at,h+=n*ot,l+=n*ft,d+=n*ct,p+=n*ut,y+=n*zt,g+=n*Gt,m+=n*Wt,b+=n*Yt,w+=n*Xt,C+=n*$t,A+=n*Zt,B+=n*Qt,n=t[3],f+=n*Z,c+=n*Q,u+=n*J,h+=n*at,l+=n*ot,d+=n*ft,p+=n*ct,y+=n*ut,g+=n*zt,m+=n*Gt,b+=n*Wt,w+=n*Yt,C+=n*Xt,A+=n*$t,B+=n*Zt,L+=n*Qt,n=t[4],c+=n*Z,u+=n*Q,h+=n*J,l+=n*at,d+=n*ot,p+=n*ft,y+=n*ct,g+=n*ut,m+=n*zt,b+=n*Gt,w+=n*Wt,C+=n*Yt,A+=n*Xt,B+=n*$t,L+=n*Zt,R+=n*Qt,n=t[5],u+=n*Z,h+=n*Q,l+=n*J,d+=n*at,p+=n*ot,y+=n*ft,g+=n*ct,m+=n*ut,b+=n*zt,w+=n*Gt,C+=n*Wt,A+=n*Yt,B+=n*Xt,L+=n*$t,R+=n*Zt,D+=n*Qt,n=t[6],h+=n*Z,l+=n*Q,d+=n*J,p+=n*at,y+=n*ot,g+=n*ft,m+=n*ct,b+=n*ut,w+=n*zt,C+=n*Gt,A+=n*Wt,B+=n*Yt,L+=n*Xt,R+=n*$t,D+=n*Zt,O+=n*Qt,n=t[7],l+=n*Z,d+=n*Q,p+=n*J,y+=n*at,g+=n*ot,m+=n*ft,b+=n*ct,w+=n*ut,C+=n*zt,A+=n*Gt,B+=n*Wt,L+=n*Yt,R+=n*Xt,D+=n*$t,O+=n*Zt,G+=n*Qt,n=t[8],d+=n*Z,p+=n*Q,y+=n*J,g+=n*at,m+=n*ot,b+=n*ft,w+=n*ct,C+=n*ut,A+=n*zt,B+=n*Gt,L+=n*Wt,R+=n*Yt,D+=n*Xt,O+=n*$t,G+=n*Zt,z+=n*Qt,n=t[9],p+=n*Z,y+=n*Q,g+=n*J,m+=n*at,b+=n*ot,w+=n*ft,C+=n*ct,A+=n*ut,B+=n*zt,L+=n*Gt,R+=n*Wt,D+=n*Yt,O+=n*Xt,G+=n*$t,z+=n*Zt,nt+=n*Qt,n=t[10],y+=n*Z,g+=n*Q,m+=n*J,b+=n*at,w+=n*ot,C+=n*ft,A+=n*ct,B+=n*ut,L+=n*zt,R+=n*Gt,D+=n*Wt,O+=n*Yt,G+=n*Xt,z+=n*$t,nt+=n*Zt,pt+=n*Qt,n=t[11],g+=n*Z,m+=n*Q,b+=n*J,w+=n*at,C+=n*ot,A+=n*ft,B+=n*ct,L+=n*ut,R+=n*zt,D+=n*Gt,O+=n*Wt,G+=n*Yt,z+=n*Xt,nt+=n*$t,pt+=n*Zt,M+=n*Qt,n=t[12],m+=n*Z,b+=n*Q,w+=n*J,C+=n*at,A+=n*ot,B+=n*ft,L+=n*ct,R+=n*ut,D+=n*zt,O+=n*Gt,G+=n*Wt,z+=n*Yt,nt+=n*Xt,pt+=n*$t,M+=n*Zt,V+=n*Qt,n=t[13],b+=n*Z,w+=n*Q,C+=n*J,A+=n*at,B+=n*ot,L+=n*ft,R+=n*ct,D+=n*ut,O+=n*zt,G+=n*Gt,z+=n*Wt,nt+=n*Yt,pt+=n*Xt,M+=n*$t,V+=n*Zt,S+=n*Qt,n=t[14],w+=n*Z,C+=n*Q,A+=n*J,B+=n*at,L+=n*ot,R+=n*ft,D+=n*ct,O+=n*ut,G+=n*zt,z+=n*Gt,nt+=n*Wt,pt+=n*Yt,M+=n*Xt,V+=n*$t,S+=n*Zt,H+=n*Qt,n=t[15],C+=n*Z,A+=n*Q,B+=n*J,L+=n*at,R+=n*ot,D+=n*ft,O+=n*ct,G+=n*ut,z+=n*zt,nt+=n*Gt,pt+=n*Wt,M+=n*Yt,V+=n*Xt,S+=n*$t,H+=n*Zt,gt+=n*Qt,s+=38*A,a+=38*B,o+=38*L,f+=38*R,c+=38*D,u+=38*O,h+=38*G,l+=38*z,d+=38*nt,p+=38*pt,y+=38*M,g+=38*V,m+=38*S,b+=38*H,w+=38*gt,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=C+i+65535,i=Math.floor(n/65536),C=n-i*65536,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=C+i+65535,i=Math.floor(n/65536),C=n-i*65536,s+=i-1+37*(i-1),e[0]=s,e[1]=a,e[2]=o,e[3]=f,e[4]=c,e[5]=u,e[6]=h,e[7]=l,e[8]=d,e[9]=p,e[10]=y,e[11]=g,e[12]=m,e[13]=b,e[14]=w,e[15]=C}function An(e,t){Ve(e,t,t)}function Wl(e,t){let r=_e();for(let n=0;n<16;n++)r[n]=t[n];for(let n=253;n>=0;n--)An(r,r),n!==2&&n!==4&&Ve(r,r,t);for(let n=0;n<16;n++)e[n]=r[n]}function Us(e,t){let r=new Uint8Array(32),n=new Float64Array(80),i=_e(),s=_e(),a=_e(),o=_e(),f=_e(),c=_e();for(let d=0;d<31;d++)r[d]=e[d];r[31]=e[31]&127|64,r[0]&=248,Gl(n,t);for(let d=0;d<16;d++)s[d]=n[d];i[0]=o[0]=1;for(let d=254;d>=0;--d){let p=r[d>>>3]>>>(d&7)&1;Bn(i,s,p),Bn(a,o,p),gi(f,i,a),xi(i,i,a),gi(a,s,o),xi(s,s,o),An(o,f),An(c,i),Ve(i,a,i),Ve(a,s,f),gi(f,i,a),xi(i,i,a),An(s,i),xi(a,o,c),Ve(i,a,ql),gi(i,i,o),Ve(a,a,i),Ve(i,o,c),Ve(o,s,n),An(s,f),Bn(i,s,p),Bn(a,o,p)}for(let d=0;d<16;d++)n[d+16]=i[d],n[d+32]=a[d],n[d+48]=s[d],n[d+64]=o[d];let u=n.subarray(32),h=n.subarray(16);Wl(u,u),Ve(h,h,u);let l=new Uint8Array(32);return zl(l,h),l}Tt.scalarMult=Us;function m0(e){return Us(e,x0)}Tt.scalarMultBase=m0;function v0(e){if(e.length!==Tt.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${Tt.SECRET_KEY_LENGTH} bytes`);let t=new Uint8Array(e);return{publicKey:m0(t),secretKey:t}}Tt.generateKeyPairFromSeed=v0;function Yl(e){let t=(0,Hl.randomBytes)(32,e),r=v0(t);return(0,Vl.wipe)(t),r}Tt.generateKeyPair=Yl;function Xl(e,t,r=!1){if(e.length!==Tt.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(t.length!==Tt.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");let n=Us(e,t);if(r){let i=0;for(let s=0;s<n.length;s++)i|=n[s];if(i===0)throw new Error("X25519: invalid shared key")}return n}Tt.sharedKey=Xl});var E0=k(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});var vi=Sn(),mi=Be();tr.DIGEST_LENGTH=32;tr.BLOCK_SIZE=64;var b0=function(){function e(){this.digestLength=tr.DIGEST_LENGTH,this.blockSize=tr.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){mi.wipe(this._buffer),mi.wipe(this._temp),this.reset()},e.prototype.update=function(t,r){if(r===void 0&&(r=t.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var n=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&r>0;)this._buffer[this._bufferLength++]=t[n++],r--;this._bufferLength===this.blockSize&&(Ns(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(n=Ns(this._temp,this._state,t,n,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=t[n++],r--;return this},e.prototype.finish=function(t){if(!this._finished){var r=this._bytesHashed,n=this._bufferLength,i=r/536870912|0,s=r<<3,a=r%64<56?64:128;this._buffer[n]=128;for(var o=n+1;o<a-8;o++)this._buffer[o]=0;vi.writeUint32BE(i,this._buffer,a-8),vi.writeUint32BE(s,this._buffer,a-4),Ns(this._temp,this._state,this._buffer,0,a),this._finished=!0}for(var o=0;o<this.digestLength/4;o++)vi.writeUint32BE(this._state[o],t,o*4);return this},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(t){return this._state.set(t.state),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(t){mi.wipe(t.state),t.buffer&&mi.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},e}();tr.SHA256=b0;var $l=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function Ns(e,t,r,n,i){for(;i>=64;){for(var s=t[0],a=t[1],o=t[2],f=t[3],c=t[4],u=t[5],h=t[6],l=t[7],d=0;d<16;d++){var p=n+d*4;e[d]=vi.readUint32BE(r,p)}for(var d=16;d<64;d++){var y=e[d-2],g=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=e[d-15];var m=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;e[d]=(g+e[d-7]|0)+(m+e[d-16]|0)}for(var d=0;d<64;d++){var g=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&u^~c&h)|0)+(l+($l[d]+e[d]|0)|0)|0,m=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&a^s&o^a&o)|0;l=h,h=u,u=c,c=f+g|0,f=o,o=a,a=s,s=g+m|0}t[0]+=s,t[1]+=a,t[2]+=o,t[3]+=f,t[4]+=c,t[5]+=u,t[6]+=h,t[7]+=l,n+=64,i-=64}return n}function Zl(e){var t=new b0;t.update(e);var r=t.digest();return t.clean(),r}tr.hash=Zl});var B0=k(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});var jt=Sn(),Ps=Be(),Ql=20;function Jl(e,t,r){for(var n=1634760805,i=857760878,s=2036477234,a=1797285236,o=r[3]<<24|r[2]<<16|r[1]<<8|r[0],f=r[7]<<24|r[6]<<16|r[5]<<8|r[4],c=r[11]<<24|r[10]<<16|r[9]<<8|r[8],u=r[15]<<24|r[14]<<16|r[13]<<8|r[12],h=r[19]<<24|r[18]<<16|r[17]<<8|r[16],l=r[23]<<24|r[22]<<16|r[21]<<8|r[20],d=r[27]<<24|r[26]<<16|r[25]<<8|r[24],p=r[31]<<24|r[30]<<16|r[29]<<8|r[28],y=t[3]<<24|t[2]<<16|t[1]<<8|t[0],g=t[7]<<24|t[6]<<16|t[5]<<8|t[4],m=t[11]<<24|t[10]<<16|t[9]<<8|t[8],b=t[15]<<24|t[14]<<16|t[13]<<8|t[12],w=n,C=i,A=s,B=a,L=o,R=f,D=c,O=u,G=h,z=l,nt=d,pt=p,M=y,V=g,S=m,H=b,gt=0;gt<Ql;gt+=2)w=w+L|0,M^=w,M=M>>>32-16|M<<16,G=G+M|0,L^=G,L=L>>>32-12|L<<12,C=C+R|0,V^=C,V=V>>>32-16|V<<16,z=z+V|0,R^=z,R=R>>>32-12|R<<12,A=A+D|0,S^=A,S=S>>>32-16|S<<16,nt=nt+S|0,D^=nt,D=D>>>32-12|D<<12,B=B+O|0,H^=B,H=H>>>32-16|H<<16,pt=pt+H|0,O^=pt,O=O>>>32-12|O<<12,A=A+D|0,S^=A,S=S>>>32-8|S<<8,nt=nt+S|0,D^=nt,D=D>>>32-7|D<<7,B=B+O|0,H^=B,H=H>>>32-8|H<<8,pt=pt+H|0,O^=pt,O=O>>>32-7|O<<7,C=C+R|0,V^=C,V=V>>>32-8|V<<8,z=z+V|0,R^=z,R=R>>>32-7|R<<7,w=w+L|0,M^=w,M=M>>>32-8|M<<8,G=G+M|0,L^=G,L=L>>>32-7|L<<7,w=w+R|0,H^=w,H=H>>>32-16|H<<16,nt=nt+H|0,R^=nt,R=R>>>32-12|R<<12,C=C+D|0,M^=C,M=M>>>32-16|M<<16,pt=pt+M|0,D^=pt,D=D>>>32-12|D<<12,A=A+O|0,V^=A,V=V>>>32-16|V<<16,G=G+V|0,O^=G,O=O>>>32-12|O<<12,B=B+L|0,S^=B,S=S>>>32-16|S<<16,z=z+S|0,L^=z,L=L>>>32-12|L<<12,A=A+O|0,V^=A,V=V>>>32-8|V<<8,G=G+V|0,O^=G,O=O>>>32-7|O<<7,B=B+L|0,S^=B,S=S>>>32-8|S<<8,z=z+S|0,L^=z,L=L>>>32-7|L<<7,C=C+D|0,M^=C,M=M>>>32-8|M<<8,pt=pt+M|0,D^=pt,D=D>>>32-7|D<<7,w=w+R|0,H^=w,H=H>>>32-8|H<<8,nt=nt+H|0,R^=nt,R=R>>>32-7|R<<7;jt.writeUint32LE(w+n|0,e,0),jt.writeUint32LE(C+i|0,e,4),jt.writeUint32LE(A+s|0,e,8),jt.writeUint32LE(B+a|0,e,12),jt.writeUint32LE(L+o|0,e,16),jt.writeUint32LE(R+f|0,e,20),jt.writeUint32LE(D+c|0,e,24),jt.writeUint32LE(O+u|0,e,28),jt.writeUint32LE(G+h|0,e,32),jt.writeUint32LE(z+l|0,e,36),jt.writeUint32LE(nt+d|0,e,40),jt.writeUint32LE(pt+p|0,e,44),jt.writeUint32LE(M+y|0,e,48),jt.writeUint32LE(V+g|0,e,52),jt.writeUint32LE(S+m|0,e,56),jt.writeUint32LE(H+b|0,e,60)}function S0(e,t,r,n,i){if(i===void 0&&(i=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(i===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-t.length,s.set(t,a)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=t,a=i}for(var o=new Uint8Array(64),f=0;f<r.length;f+=64){Jl(o,s,e);for(var c=f;c<f+64&&c<r.length;c++)n[c]=r[c]^o[c-f];tp(s,0,a)}return Ps.wipe(o),i===0&&Ps.wipe(s),n}wi.streamXOR=S0;function jl(e,t,r,n){return n===void 0&&(n=0),Ps.wipe(r),S0(e,t,r,r,n)}wi.stream=jl;function tp(e,t,r){for(var n=1;r--;)n=n+(e[t]&255)|0,e[t]=n&255,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}});var _0=k(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});var ep=ui(),bi=Be();qe.DIGEST_LENGTH=16;var A0=function(){function e(t){this.digestLength=qe.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=t[0]|t[1]<<8;this._r[0]=r&8191;var n=t[2]|t[3]<<8;this._r[1]=(r>>>13|n<<3)&8191;var i=t[4]|t[5]<<8;this._r[2]=(n>>>10|i<<6)&7939;var s=t[6]|t[7]<<8;this._r[3]=(i>>>7|s<<9)&8191;var a=t[8]|t[9]<<8;this._r[4]=(s>>>4|a<<12)&255,this._r[5]=a>>>1&8190;var o=t[10]|t[11]<<8;this._r[6]=(a>>>14|o<<2)&8191;var f=t[12]|t[13]<<8;this._r[7]=(o>>>11|f<<5)&8065;var c=t[14]|t[15]<<8;this._r[8]=(f>>>8|c<<8)&8191,this._r[9]=c>>>5&127,this._pad[0]=t[16]|t[17]<<8,this._pad[1]=t[18]|t[19]<<8,this._pad[2]=t[20]|t[21]<<8,this._pad[3]=t[22]|t[23]<<8,this._pad[4]=t[24]|t[25]<<8,this._pad[5]=t[26]|t[27]<<8,this._pad[6]=t[28]|t[29]<<8,this._pad[7]=t[30]|t[31]<<8}return e.prototype._blocks=function(t,r,n){for(var i=this._fin?0:2048,s=this._h[0],a=this._h[1],o=this._h[2],f=this._h[3],c=this._h[4],u=this._h[5],h=this._h[6],l=this._h[7],d=this._h[8],p=this._h[9],y=this._r[0],g=this._r[1],m=this._r[2],b=this._r[3],w=this._r[4],C=this._r[5],A=this._r[6],B=this._r[7],L=this._r[8],R=this._r[9];n>=16;){var D=t[r+0]|t[r+1]<<8;s+=D&8191;var O=t[r+2]|t[r+3]<<8;a+=(D>>>13|O<<3)&8191;var G=t[r+4]|t[r+5]<<8;o+=(O>>>10|G<<6)&8191;var z=t[r+6]|t[r+7]<<8;f+=(G>>>7|z<<9)&8191;var nt=t[r+8]|t[r+9]<<8;c+=(z>>>4|nt<<12)&8191,u+=nt>>>1&8191;var pt=t[r+10]|t[r+11]<<8;h+=(nt>>>14|pt<<2)&8191;var M=t[r+12]|t[r+13]<<8;l+=(pt>>>11|M<<5)&8191;var V=t[r+14]|t[r+15]<<8;d+=(M>>>8|V<<8)&8191,p+=V>>>5|i;var S=0,H=S;H+=s*y,H+=a*(5*R),H+=o*(5*L),H+=f*(5*B),H+=c*(5*A),S=H>>>13,H&=8191,H+=u*(5*C),H+=h*(5*w),H+=l*(5*b),H+=d*(5*m),H+=p*(5*g),S+=H>>>13,H&=8191;var gt=S;gt+=s*g,gt+=a*y,gt+=o*(5*R),gt+=f*(5*L),gt+=c*(5*B),S=gt>>>13,gt&=8191,gt+=u*(5*A),gt+=h*(5*C),gt+=l*(5*w),gt+=d*(5*b),gt+=p*(5*m),S+=gt>>>13,gt&=8191;var Z=S;Z+=s*m,Z+=a*g,Z+=o*y,Z+=f*(5*R),Z+=c*(5*L),S=Z>>>13,Z&=8191,Z+=u*(5*B),Z+=h*(5*A),Z+=l*(5*C),Z+=d*(5*w),Z+=p*(5*b),S+=Z>>>13,Z&=8191;var Q=S;Q+=s*b,Q+=a*m,Q+=o*g,Q+=f*y,Q+=c*(5*R),S=Q>>>13,Q&=8191,Q+=u*(5*L),Q+=h*(5*B),Q+=l*(5*A),Q+=d*(5*C),Q+=p*(5*w),S+=Q>>>13,Q&=8191;var J=S;J+=s*w,J+=a*b,J+=o*m,J+=f*g,J+=c*y,S=J>>>13,J&=8191,J+=u*(5*R),J+=h*(5*L),J+=l*(5*B),J+=d*(5*A),J+=p*(5*C),S+=J>>>13,J&=8191;var at=S;at+=s*C,at+=a*w,at+=o*b,at+=f*m,at+=c*g,S=at>>>13,at&=8191,at+=u*y,at+=h*(5*R),at+=l*(5*L),at+=d*(5*B),at+=p*(5*A),S+=at>>>13,at&=8191;var ot=S;ot+=s*A,ot+=a*C,ot+=o*w,ot+=f*b,ot+=c*m,S=ot>>>13,ot&=8191,ot+=u*g,ot+=h*y,ot+=l*(5*R),ot+=d*(5*L),ot+=p*(5*B),S+=ot>>>13,ot&=8191;var ft=S;ft+=s*B,ft+=a*A,ft+=o*C,ft+=f*w,ft+=c*b,S=ft>>>13,ft&=8191,ft+=u*m,ft+=h*g,ft+=l*y,ft+=d*(5*R),ft+=p*(5*L),S+=ft>>>13,ft&=8191;var ct=S;ct+=s*L,ct+=a*B,ct+=o*A,ct+=f*C,ct+=c*w,S=ct>>>13,ct&=8191,ct+=u*b,ct+=h*m,ct+=l*g,ct+=d*y,ct+=p*(5*R),S+=ct>>>13,ct&=8191;var ut=S;ut+=s*R,ut+=a*L,ut+=o*B,ut+=f*A,ut+=c*C,S=ut>>>13,ut&=8191,ut+=u*w,ut+=h*b,ut+=l*m,ut+=d*g,ut+=p*y,S+=ut>>>13,ut&=8191,S=(S<<2)+S|0,S=S+H|0,H=S&8191,S=S>>>13,gt+=S,s=H,a=gt,o=Z,f=Q,c=J,u=at,h=ot,l=ft,d=ct,p=ut,r+=16,n-=16}this._h[0]=s,this._h[1]=a,this._h[2]=o,this._h[3]=f,this._h[4]=c,this._h[5]=u,this._h[6]=h,this._h[7]=l,this._h[8]=d,this._h[9]=p},e.prototype.finish=function(t,r){r===void 0&&(r=0);var n=new Uint16Array(10),i,s,a,o;if(this._leftover){for(o=this._leftover,this._buffer[o++]=1;o<16;o++)this._buffer[o]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(i=this._h[1]>>>13,this._h[1]&=8191,o=2;o<10;o++)this._h[o]+=i,i=this._h[o]>>>13,this._h[o]&=8191;for(this._h[0]+=i*5,i=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=i,i=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=i,n[0]=this._h[0]+5,i=n[0]>>>13,n[0]&=8191,o=1;o<10;o++)n[o]=this._h[o]+i,i=n[o]>>>13,n[o]&=8191;for(n[9]-=1<<13,s=(i^1)-1,o=0;o<10;o++)n[o]&=s;for(s=~s,o=0;o<10;o++)this._h[o]=this._h[o]&s|n[o];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,a=this._h[0]+this._pad[0],this._h[0]=a&65535,o=1;o<8;o++)a=(this._h[o]+this._pad[o]|0)+(a>>>16)|0,this._h[o]=a&65535;return t[r+0]=this._h[0]>>>0,t[r+1]=this._h[0]>>>8,t[r+2]=this._h[1]>>>0,t[r+3]=this._h[1]>>>8,t[r+4]=this._h[2]>>>0,t[r+5]=this._h[2]>>>8,t[r+6]=this._h[3]>>>0,t[r+7]=this._h[3]>>>8,t[r+8]=this._h[4]>>>0,t[r+9]=this._h[4]>>>8,t[r+10]=this._h[5]>>>0,t[r+11]=this._h[5]>>>8,t[r+12]=this._h[6]>>>0,t[r+13]=this._h[6]>>>8,t[r+14]=this._h[7]>>>0,t[r+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(t){var r=0,n=t.length,i;if(this._leftover){i=16-this._leftover,i>n&&(i=n);for(var s=0;s<i;s++)this._buffer[this._leftover+s]=t[r+s];if(n-=i,r+=i,this._leftover+=i,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(i=n-n%16,this._blocks(t,r,i),r+=i,n-=i),n){for(var s=0;s<n;s++)this._buffer[this._leftover+s]=t[r+s];this._leftover+=n}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var t=new Uint8Array(16);return this.finish(t),t},e.prototype.clean=function(){return bi.wipe(this._buffer),bi.wipe(this._r),bi.wipe(this._h),bi.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();qe.Poly1305=A0;function rp(e,t){var r=new A0(e);r.update(t);var n=r.digest();return r.clean(),n}qe.oneTimeAuth=rp;function np(e,t){return e.length!==qe.DIGEST_LENGTH||t.length!==qe.DIGEST_LENGTH?!1:ep.equal(e,t)}qe.equal=np});var ks=k(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});var Ei=B0(),ip=_0(),_n=Be(),C0=Sn(),sp=ui();ze.KEY_LENGTH=32;ze.NONCE_LENGTH=12;ze.TAG_LENGTH=16;var T0=new Uint8Array(16),ap=function(){function e(t){if(this.nonceLength=ze.NONCE_LENGTH,this.tagLength=ze.TAG_LENGTH,t.length!==ze.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(t)}return e.prototype.seal=function(t,r,n,i){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(t,s.length-t.length);var a=new Uint8Array(32);Ei.stream(this._key,s,a,4);var o=r.length+this.tagLength,f;if(i){if(i.length!==o)throw new Error("ChaCha20Poly1305: incorrect destination length");f=i}else f=new Uint8Array(o);return Ei.streamXOR(this._key,s,r,f,4),this._authenticate(f.subarray(f.length-this.tagLength,f.length),a,f.subarray(0,f.length-this.tagLength),n),_n.wipe(s),f},e.prototype.open=function(t,r,n,i){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(t,s.length-t.length);var a=new Uint8Array(32);Ei.stream(this._key,s,a,4);var o=new Uint8Array(this.tagLength);if(this._authenticate(o,a,r.subarray(0,r.length-this.tagLength),n),!sp.equal(o,r.subarray(r.length-this.tagLength,r.length)))return null;var f=r.length-this.tagLength,c;if(i){if(i.length!==f)throw new Error("ChaCha20Poly1305: incorrect destination length");c=i}else c=new Uint8Array(f);return Ei.streamXOR(this._key,s,r.subarray(0,r.length-this.tagLength),c,4),_n.wipe(s),c},e.prototype.clean=function(){return _n.wipe(this._key),this},e.prototype._authenticate=function(t,r,n,i){var s=new ip.Poly1305(r);i&&(s.update(i),i.length%16>0&&s.update(T0.subarray(i.length%16))),s.update(n),n.length%16>0&&s.update(T0.subarray(n.length%16));var a=new Uint8Array(8);i&&C0.writeUint64LE(i.length,a),s.update(a),C0.writeUint64LE(n.length,a),s.update(a);for(var o=s.digest(),f=0;f<o.length;f++)t[f]=o[f];s.clean(),_n.wipe(o),_n.wipe(a)},e}();ze.ChaCha20Poly1305=ap});var O0=k((zx,M0)=>{"use strict";M0.exports=fp;function fp(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,f){r[n]=function(u){if(s)if(s=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{e.apply(t||null,r)}catch(c){s&&(s=!1,f(c))}})}});var z0=k(q0=>{"use strict";var Bi=q0;Bi.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var Vr=new Array(64),V0=new Array(123);for(xe=0;xe<64;)V0[Vr[xe]=xe<26?xe+65:xe<52?xe+71:xe<62?xe-4:xe-59|43]=xe++;var xe;Bi.encode=function(t,r,n){for(var i=null,s=[],a=0,o=0,f;r<n;){var c=t[r++];switch(o){case 0:s[a++]=Vr[c>>2],f=(c&3)<<4,o=1;break;case 1:s[a++]=Vr[f|c>>4],f=(c&15)<<2,o=2;break;case 2:s[a++]=Vr[f|c>>6],s[a++]=Vr[c&63],o=0;break}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return o&&(s[a++]=Vr[f],s[a++]=61,o===1&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var H0="invalid encoding";Bi.decode=function(t,r,n){for(var i=n,s=0,a,o=0;o<t.length;){var f=t.charCodeAt(o++);if(f===61&&s>1)break;if((f=V0[f])===void 0)throw Error(H0);switch(s){case 0:a=f,s=1;break;case 1:r[n++]=a<<2|(f&48)>>4,a=f,s=2;break;case 2:r[n++]=(a&15)<<4|(f&60)>>2,a=f,s=3;break;case 3:r[n++]=(a&3)<<6|f,s=0;break}}if(s===1)throw Error(H0);return n-i};Bi.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var W0=k((Wx,G0)=>{"use strict";G0.exports=Ai;function Ai(){this._listeners={}}Ai.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};Ai.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Ai.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var j0=k((Yx,J0)=>{"use strict";J0.exports=Y0(Y0);function Y0(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function i(f,c,u){t[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function s(f,c,u){t[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}e.writeFloatLE=n?i:s,e.writeFloatBE=n?s:i;function a(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],t[0]}function o(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],t[0]}e.readFloatLE=n?a:o,e.readFloatBE=n?o:a}():function(){function t(n,i,s,a){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,s,a);else if(isNaN(i))n(2143289344,s,a);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,s,a);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,s,a);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((o<<31|f+127<<23|c)>>>0,s,a)}}e.writeFloatLE=t.bind(null,X0),e.writeFloatBE=t.bind(null,$0);function r(n,i,s){var a=n(i,s),o=(a>>31)*2+1,f=a>>>23&255,c=a&8388607;return f===255?c?NaN:o*(1/0):f===0?o*1401298464324817e-60*c:o*Math.pow(2,f-150)*(c+8388608)}e.readFloatLE=r.bind(null,Z0),e.readFloatBE=r.bind(null,Q0)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function i(f,c,u){t[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function s(f,c,u){t[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}e.writeDoubleLE=n?i:s,e.writeDoubleBE=n?s:i;function a(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],t[0]}function o(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],t[0]}e.readDoubleLE=n?a:o,e.readDoubleBE=n?o:a}():function(){function t(n,i,s,a,o,f){var c=a<0?1:0;if(c&&(a=-a),a===0)n(0,o,f+i),n(1/a>0?0:2147483648,o,f+s);else if(isNaN(a))n(0,o,f+i),n(2146959360,o,f+s);else if(a>17976931348623157e292)n(0,o,f+i),n((c<<31|2146435072)>>>0,o,f+s);else{var u;if(a<22250738585072014e-324)u=a/5e-324,n(u>>>0,o,f+i),n((c<<31|u/4294967296)>>>0,o,f+s);else{var h=Math.floor(Math.log(a)/Math.LN2);h===1024&&(h=1023),u=a*Math.pow(2,-h),n(u*4503599627370496>>>0,o,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,o,f+s)}}}e.writeDoubleLE=t.bind(null,X0,0,4),e.writeDoubleBE=t.bind(null,$0,4,0);function r(n,i,s,a,o){var f=n(a,o+i),c=n(a,o+s),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}e.readDoubleLE=r.bind(null,Z0,0,4),e.readDoubleBE=r.bind(null,Q0,4,0)}(),e}function X0(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function $0(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function Z0(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function Q0(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var tf=k((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var rf=k(ef=>{"use strict";var Ms=ef;Ms.length=function(t){for(var r=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Ms.read=function(t,r,n){var i=n-r;if(i<1)return"";for(var s=null,a=[],o=0,f;r<n;)f=t[r++],f<128?a[o++]=f:f>191&&f<224?a[o++]=(f&31)<<6|t[r++]&63:f>239&&f<365?(f=((f&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,a[o++]=55296+(f>>10),a[o++]=56320+(f&1023)):a[o++]=(f&15)<<12|(t[r++]&63)<<6|t[r++]&63,o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};Ms.write=function(t,r,n){for(var i=n,s,a,o=0;o<t.length;++o)s=t.charCodeAt(o),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((a=t.charCodeAt(o+1))&64512)===56320?(s=65536+((s&1023)<<10)+(a&1023),++o,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var sf=k(($x,nf)=>{"use strict";nf.exports=cp;function cp(e,t,r){var n=r||8192,i=n>>>1,s=null,a=n;return function(f){if(f<1||f>i)return e(f);a+f>n&&(s=e(n),a=0);var c=t.call(s,a,a+=f);return a&7&&(a=(a|7)+1),c}}});var of=k((Zx,af)=>{"use strict";af.exports=Pt;var In=br();function Pt(e,t){this.lo=e>>>0,this.hi=t>>>0}var wr=Pt.zero=new Pt(0,0);wr.toNumber=function(){return 0};wr.zzEncode=wr.zzDecode=function(){return this};wr.length=function(){return 1};var up=Pt.zeroHash="\0\0\0\0\0\0\0\0";Pt.fromNumber=function(t){if(t===0)return wr;var r=t<0;r&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Pt(n,i)};Pt.from=function(t){if(typeof t=="number")return Pt.fromNumber(t);if(In.isString(t))if(In.Long)t=In.Long.fromString(t);else return Pt.fromNumber(parseInt(t,10));return t.low||t.high?new Pt(t.low>>>0,t.high>>>0):wr};Pt.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Pt.prototype.toLong=function(t){return In.Long?new In.Long(this.lo|0,this.hi|0,Boolean(t)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(t)}};var er=String.prototype.charCodeAt;Pt.fromHash=function(t){return t===up?wr:new Pt((er.call(t,0)|er.call(t,1)<<8|er.call(t,2)<<16|er.call(t,3)<<24)>>>0,(er.call(t,4)|er.call(t,5)<<8|er.call(t,6)<<16|er.call(t,7)<<24)>>>0)};Pt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Pt.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};Pt.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};Pt.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var br=k(Os=>{"use strict";var K=Os;K.asPromise=O0();K.base64=z0();K.EventEmitter=W0();K.float=j0();K.inquire=tf();K.utf8=rf();K.pool=sf();K.LongBits=of();K.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);K.global=K.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Os;K.emptyArray=Object.freeze?Object.freeze([]):[];K.emptyObject=Object.freeze?Object.freeze({}):{};K.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};K.isString=function(t){return typeof t=="string"||t instanceof String};K.isObject=function(t){return t&&typeof t=="object"};K.isset=K.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};K.Buffer=function(){try{var e=K.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}();K._Buffer_from=null;K._Buffer_allocUnsafe=null;K.newBuffer=function(t){return typeof t=="number"?K.Buffer?K._Buffer_allocUnsafe(t):new K.Array(t):K.Buffer?K._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};K.Array=typeof Uint8Array<"u"?Uint8Array:Array;K.Long=K.global.dcodeIO&&K.global.dcodeIO.Long||K.global.Long||K.inquire("long");K.key2Re=/^true|false|0|1$/;K.key32Re=/^-?(?:0|[1-9][0-9]*)$/;K.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;K.longToHash=function(t){return t?K.LongBits.from(t).toHash():K.LongBits.zeroHash};K.longFromHash=function(t,r){var n=K.LongBits.fromHash(t);return K.Long?K.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function ff(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(e[n[i]]===void 0||!r)&&(e[n[i]]=t[n[i]]);return e}K.merge=ff;K.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function cf(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&ff(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}K.newError=cf;K.ProtocolError=cf("ProtocolError");K.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};K.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};K.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};K._configure=function(){var e=K.Buffer;if(!e){K._Buffer_from=K._Buffer_allocUnsafe=null;return}K._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},K._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var qs=k((Jx,df)=>{"use strict";df.exports=Lt;var Ce=br(),Vs,lf=Ce.LongBits,hp=Ce.utf8;function me(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Lt(e){this.buf=e,this.pos=0,this.len=e.length}var uf=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new Lt(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new Lt(t);throw Error("illegal buffer")},pf=function(){return Ce.Buffer?function(r){return(Lt.create=function(i){return Ce.Buffer.isBuffer(i)?new Vs(i):uf(i)})(r)}:uf};Lt.create=pf();Lt.prototype._slice=Ce.Array.prototype.subarray||Ce.Array.prototype.slice;Lt.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,me(this,10);return t}}();Lt.prototype.int32=function(){return this.uint32()|0};Lt.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function Hs(){var e=new lf(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw me(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw me(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}Lt.prototype.bool=function(){return this.uint32()!==0};function _i(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}Lt.prototype.fixed32=function(){if(this.pos+4>this.len)throw me(this,4);return _i(this.buf,this.pos+=4)};Lt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw me(this,4);return _i(this.buf,this.pos+=4)|0};function hf(){if(this.pos+8>this.len)throw me(this,8);return new lf(_i(this.buf,this.pos+=4),_i(this.buf,this.pos+=4))}Lt.prototype.float=function(){if(this.pos+4>this.len)throw me(this,4);var t=Ce.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};Lt.prototype.double=function(){if(this.pos+8>this.len)throw me(this,4);var t=Ce.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};Lt.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw me(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};Lt.prototype.string=function(){var t=this.bytes();return hp.read(t,0,t.length)};Lt.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw me(this,t);this.pos+=t}else do if(this.pos>=this.len)throw me(this);while(this.buf[this.pos++]&128);return this};Lt.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};Lt._configure=function(e){Vs=e,Lt.create=pf(),Vs._configure();var t=Ce.Long?"toLong":"toNumber";Ce.merge(Lt.prototype,{int64:function(){return Hs.call(this)[t](!1)},uint64:function(){return Hs.call(this)[t](!0)},sint64:function(){return Hs.call(this).zzDecode()[t](!1)},fixed64:function(){return hf.call(this)[t](!0)},sfixed64:function(){return hf.call(this)[t](!1)}})}});var mf=k((jx,xf)=>{"use strict";xf.exports=Er;var gf=qs();(Er.prototype=Object.create(gf.prototype)).constructor=Er;var yf=br();function Er(e){gf.call(this,e)}Er._configure=function(){yf.Buffer&&(Er.prototype._slice=yf.Buffer.prototype.slice)};Er.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};Er._configure()});var Zs=k((tm,Ef)=>{"use strict";Ef.exports=it;var le=br(),zs,Ci=le.LongBits,vf=le.base64,wf=le.utf8;function Ln(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function Ws(){}function lp(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function it(){this.len=0,this.head=new Ln(Ws,0,0),this.tail=this.head,this.states=null}var bf=function(){return le.Buffer?function(){return(it.create=function(){return new zs})()}:function(){return new it}};it.create=bf();it.alloc=function(t){return new le.Array(t)};le.Array!==Array&&(it.alloc=le.pool(it.alloc,le.Array.prototype.subarray));it.prototype._push=function(t,r,n){return this.tail=this.tail.next=new Ln(t,r,n),this.len+=r,this};function Ys(e,t,r){t[r]=e&255}function pp(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function Xs(e,t){this.len=e,this.next=void 0,this.val=t}Xs.prototype=Object.create(Ln.prototype);Xs.prototype.fn=pp;it.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new Xs((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};it.prototype.int32=function(t){return t<0?this._push($s,10,Ci.fromNumber(t)):this.uint32(t)};it.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function $s(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}it.prototype.uint64=function(t){var r=Ci.from(t);return this._push($s,r.length(),r)};it.prototype.int64=it.prototype.uint64;it.prototype.sint64=function(t){var r=Ci.from(t).zzEncode();return this._push($s,r.length(),r)};it.prototype.bool=function(t){return this._push(Ys,1,t?1:0)};function Gs(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}it.prototype.fixed32=function(t){return this._push(Gs,4,t>>>0)};it.prototype.sfixed32=it.prototype.fixed32;it.prototype.fixed64=function(t){var r=Ci.from(t);return this._push(Gs,4,r.lo)._push(Gs,4,r.hi)};it.prototype.sfixed64=it.prototype.fixed64;it.prototype.float=function(t){return this._push(le.float.writeFloatLE,4,t)};it.prototype.double=function(t){return this._push(le.float.writeDoubleLE,8,t)};var dp=le.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var i=0;i<t.length;++i)r[n+i]=t[i]};it.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(Ys,1,0);if(le.isString(t)){var n=it.alloc(r=vf.length(t));vf.decode(t,n,0),t=n}return this.uint32(r)._push(dp,r,t)};it.prototype.string=function(t){var r=wf.length(t);return r?this.uint32(r)._push(wf.write,r,t):this._push(Ys,1,0)};it.prototype.fork=function(){return this.states=new lp(this),this.head=this.tail=new Ln(Ws,0,0),this.len=0,this};it.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ln(Ws,0,0),this.len=0),this};it.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};it.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};it._configure=function(e){zs=e,it.create=bf(),zs._configure()}});var Af=k((em,Bf)=>{"use strict";Bf.exports=Te;var Sf=Zs();(Te.prototype=Object.create(Sf.prototype)).constructor=Te;var rr=br();function Te(){Sf.call(this)}Te._configure=function(){Te.alloc=rr._Buffer_allocUnsafe,Te.writeBytesBuffer=rr.Buffer&&rr.Buffer.prototype instanceof Uint8Array&&rr.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var i=0;i<t.length;)r[n++]=t[i++]}};Te.prototype.bytes=function(t){rr.isString(t)&&(t=rr._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(Te.writeBytesBuffer,r,t),this};function yp(e,t,r){e.length<40?rr.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}Te.prototype.string=function(t){var r=rr.Buffer.byteLength(t);return this.uint32(r),r&&this._push(yp,r,t),this};Te._configure()});var yt=k((vm,Lf)=>{Lf.exports={options:{usePureJavaScript:!1}}});var Nf=k((wm,Uf)=>{var na={};Uf.exports=na;var Rf={};na.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=vp(e,t);else{var i=0,s=t.length,a=t.charAt(0),o=[0];for(i=0;i<e.length;++i){for(var f=0,c=e[i];f<o.length;++f)c+=o[f]<<8,o[f]=c%s,c=c/s|0;for(;c>0;)o.push(c%s),c=c/s|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=a;for(i=o.length-1;i>=0;--i)n+=t[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};na.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=Rf[t];if(!r){r=Rf[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,s=t.charAt(0),a=[0],n=0;n<e.length;n++){var o=r[e.charCodeAt(n)];if(o===void 0)return;for(var f=0,c=o;f<a.length;++f)c+=a[f]*i,a[f]=c&255,c>>=8;for(;c>0;)a.push(c&255),c>>=8}for(var u=0;e[u]===s&&u<e.length-1;++u)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function vp(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var a=0,o=e.at(r);a<s.length;++a)o+=s[a]<<8,s[a]=o%n,o=o/n|0;for(;o>0;)s.push(o%n),o=o/n|0}var f="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)f+=i;for(r=s.length-1;r>=0;--r)f+=t[s[r]];return f}});var Rt=k((bm,Kf)=>{var Pf=yt(),kf=Nf(),x=Kf.exports=Pf.util=Pf.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){x.nextTick=process.nextTick,typeof setImmediate=="function"?x.setImmediate=setImmediate:x.setImmediate=x.nextTick;return}if(typeof setImmediate=="function"){x.setImmediate=function(){return setImmediate.apply(void 0,arguments)},x.nextTick=function(o){return setImmediate(o)};return}if(x.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===e){f.stopPropagation();var c=t.slice();t.length=0,c.forEach(function(u){u()})}};var a=o,e="forge.setImmediate",t=[];x.setImmediate=function(f){t.push(f),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var f=t.slice();t.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var s=x.setImmediate;x.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),s(f)):(t.push(f),t.length===1&&i.setAttribute("a",n=!n))}}x.nextTick=x.setImmediate})();x.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;x.globalScope=function(){return x.isNodejs?globalThis:typeof self>"u"?window:self}();x.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};x.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};x.isArrayBufferView=function(e){return e&&x.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Rn(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}x.ByteBuffer=ia;function ia(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(x.isArrayBuffer(e)||x.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof ia||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}x.ByteStringBuffer=ia;var wp=4096;x.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>wp&&(this.data.substr(0,1),this._constructedStringLength=0)};x.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};x.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};x.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};x.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};x.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};x.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(x.encodeUtf8(e))};x.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};x.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};x.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};x.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};x.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};x.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};x.ByteStringBuffer.prototype.putInt=function(e,t){Rn(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};x.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};x.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};x.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};x.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};x.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};x.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};x.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};x.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};x.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};x.ByteStringBuffer.prototype.getInt=function(e){Rn(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};x.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};x.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};x.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};x.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};x.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};x.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};x.ByteStringBuffer.prototype.copy=function(){var e=x.createBuffer(this.data);return e.read=this.read,e};x.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};x.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};x.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};x.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};x.ByteStringBuffer.prototype.toString=function(){return x.decodeUtf8(this.bytes())};function bp(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=x.isArrayBuffer(e),n=x.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}x.DataBuffer=bp;x.DataBuffer.prototype.length=function(){return this.write-this.read};x.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};x.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};x.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};x.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};x.DataBuffer.prototype.putBytes=function(e,t){if(x.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(x.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof x.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&x.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof x.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var s;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.hex.decode(e,s,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.base64.decode(e,s,this.write),this;if(t==="utf8"&&(e=x.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=x.binary.raw.decode(s),this;if(t==="utf16")return this.accommodate(e.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=x.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};x.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};x.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};x.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};x.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};x.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};x.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};x.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};x.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};x.DataBuffer.prototype.putInt=function(e,t){Rn(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};x.DataBuffer.prototype.putSignedInt=function(e,t){return Rn(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};x.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};x.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};x.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};x.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};x.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};x.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};x.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};x.DataBuffer.prototype.getInt=function(e){Rn(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};x.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};x.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};x.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};x.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};x.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};x.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};x.DataBuffer.prototype.copy=function(){return new x.DataBuffer(this)};x.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};x.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};x.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};x.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};x.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return x.binary.raw.encode(t);if(e==="hex")return x.binary.hex.encode(t);if(e==="base64")return x.binary.base64.encode(t);if(e==="utf8")return x.text.utf8.decode(t);if(e==="utf16")return x.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};x.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=x.encodeUtf8(e)),new x.ByteBuffer(e)};x.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};x.xorBytes=function(e,t,r){for(var n="",i="",s="",a=0,o=0;r>0;--r,++a)i=e.charCodeAt(a)^t.charCodeAt(a),o>=10&&(n+=s,s="",o=0),s+=String.fromCharCode(i),++o;return n+=s,n};x.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};x.bytesToHex=function(e){return x.createBuffer(e).toHex()};x.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var nr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ir=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Df="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";x.encode64=function(e,t){for(var r="",n="",i,s,a,o=0;o<e.length;)i=e.charCodeAt(o++),s=e.charCodeAt(o++),a=e.charCodeAt(o++),r+=nr.charAt(i>>2),r+=nr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=nr.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":nr.charAt(a&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};x.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,s,a=0;a<e.length;)r=ir[e.charCodeAt(a++)-43],n=ir[e.charCodeAt(a++)-43],i=ir[e.charCodeAt(a++)-43],s=ir[e.charCodeAt(a++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t};x.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};x.decodeUtf8=function(e){return decodeURIComponent(escape(e))};x.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:kf.encode,decode:kf.decode}};x.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};x.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};x.binary.hex.encode=x.bytesToHex;x.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(e.length&1&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n};x.binary.base64.encode=function(e,t){for(var r="",n="",i,s,a,o=0;o<e.byteLength;)i=e[o++],s=e[o++],a=e[o++],r+=nr.charAt(i>>2),r+=nr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=nr.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":nr.charAt(a&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};x.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,a,o,f=0,c=r;f<e.length;)i=ir[e.charCodeAt(f++)-43],s=ir[e.charCodeAt(f++)-43],a=ir[e.charCodeAt(f++)-43],o=ir[e.charCodeAt(f++)-43],n[c++]=i<<2|s>>4,a!==64&&(n[c++]=(s&15)<<4|a>>2,o!==64&&(n[c++]=(a&3)<<6|o));return t?c-r:n.subarray(0,c)};x.binary.base58.encode=function(e,t){return x.binary.baseN.encode(e,Df,t)};x.binary.base58.decode=function(e,t){return x.binary.baseN.decode(e,Df,t)};x.text={utf8:{},utf16:{}};x.text.utf8.encode=function(e,t,r){e=x.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};x.text.utf8.decode=function(e){return x.decodeUtf8(String.fromCharCode.apply(null,e))};x.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,a=r,o=0;o<e.length;++o)i[a++]=e.charCodeAt(o),s+=2;return t?s-r:n};x.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};x.deflate=function(e,t,r){if(t=x.decode64(e.deflate(x.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};x.inflate=function(e,t,r){var n=e.inflate(x.encode64(t)).rval;return n===null?null:x.decode64(n)};var sa=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=x.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},aa=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(x.decode64(r))),r},Ep=function(e,t,r,n){var i=aa(e,t);i===null&&(i={}),i[r]=n,sa(e,t,i)},Sp=function(e,t,r){var n=aa(e,t);return n!==null&&(n=r in n?n[r]:null),n},Bp=function(e,t,r){var n=aa(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),sa(e,t,n)}},Ap=function(e,t){sa(e,t,null)},Li=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,a=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),s=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),s=!0)}catch(f){a=f}if(s)break}if(!s)throw a;return n};x.setItem=function(e,t,r,n,i){Li(Ep,arguments,i)};x.getItem=function(e,t,r,n){return Li(Sp,arguments,n)};x.removeItem=function(e,t,r,n){Li(Bp,arguments,n)};x.clearItems=function(e,t,r){Li(Ap,arguments,r)};x.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};x.format=function(e){for(var t=/%./g,r,n,i=0,s=[],a=0;r=t.exec(e);){n=e.substring(a,t.lastIndex-2),n.length>0&&s.push(n),a=t.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(e.substring(a)),s.join("")};x.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,a=r===void 0?",":r,o=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+o:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?a+Math.abs(i-c).toFixed(s).slice(2):"")};x.formatSize=function(e){return e>=1073741824?e=x.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=x.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=x.formatNumber(e/1024,0)+" KiB":e=x.formatNumber(e,0)+" bytes",e};x.bytesFromIP=function(e){return e.indexOf(".")!==-1?x.bytesFromIPv4(e):e.indexOf(":")!==-1?x.bytesFromIPv6(e):null};x.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=x.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};x.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(a){return a.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=x.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=x.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};x.bytesToIP=function(e){return e.length===4?x.bytesToIPv4(e):e.length===16?x.bytesToIPv6(e):null};x.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};x.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=x.bytesToHex(e[i]+e[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],o=t.length;!a||o!==a.end+1?r.push({start:o,end:o}):(a.end=o,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(s)}if(r.length>0){var f=r[n];f.end-f.start>0&&(t.splice(f.start,f.end-f.start+1,""),f.start===0&&t.unshift(""),f.end===7&&t.push(""))}return t.join(":")};x.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in x&&!e.update)return t(null,x.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return x.cores=navigator.hardwareConcurrency,t(null,x.cores);if(typeof Worker>"u")return x.cores=1,t(null,x.cores);if(typeof Blob>"u")return x.cores=2,t(null,x.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var o=Date.now(),f=o+4;Date.now()<f;);self.postMessage({st:o,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,o,f){if(o===0){var c=Math.floor(a.reduce(function(u,h){return u+h},0)/a.length);return x.cores=Math.max(1,c),URL.revokeObjectURL(r),t(null,x.cores)}i(f,function(u,h){a.push(s(f,h)),n(a,o-1,f)})}function i(a,o){for(var f=[],c=[],u=0;u<a;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===a){for(var d=0;d<a;++d)f[d].terminate();o(null,c)}}),f.push(h)}for(var u=0;u<a;++u)f[u].postMessage(u)}function s(a,o){for(var f=[],c=0;c<a;++c)for(var u=o[c],h=f[c]=[],l=0;l<a;++l)if(c!==l){var d=o[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return f.reduce(function(p,y){return Math.max(p,y.length)},0)}}});var Ri=k((Em,Ff)=>{var Un=yt();Un.pki=Un.pki||{};var oa=Ff.exports=Un.pki.oids=Un.oids=Un.oids||{};function I(e,t){oa[e]=t,oa[t]=e}function lt(e,t){oa[e]=t}I("1.2.840.113549.1.1.1","rsaEncryption");I("1.2.840.113549.1.1.4","md5WithRSAEncryption");I("1.2.840.113549.1.1.5","sha1WithRSAEncryption");I("1.2.840.113549.1.1.7","RSAES-OAEP");I("1.2.840.113549.1.1.8","mgf1");I("1.2.840.113549.1.1.9","pSpecified");I("1.2.840.113549.1.1.10","RSASSA-PSS");I("1.2.840.113549.1.1.11","sha256WithRSAEncryption");I("1.2.840.113549.1.1.12","sha384WithRSAEncryption");I("1.2.840.113549.1.1.13","sha512WithRSAEncryption");I("1.3.101.112","EdDSA25519");I("1.2.840.10040.4.3","dsa-with-sha1");I("1.3.14.3.2.7","desCBC");I("1.3.14.3.2.26","sha1");I("1.3.14.3.2.29","sha1WithRSASignature");I("2.16.840.1.101.3.4.2.1","sha256");I("2.16.840.1.101.3.4.2.2","sha384");I("2.16.840.1.101.3.4.2.3","sha512");I("2.16.840.1.101.3.4.2.4","sha224");I("2.16.840.1.101.3.4.2.5","sha512-224");I("2.16.840.1.101.3.4.2.6","sha512-256");I("1.2.840.113549.2.2","md2");I("1.2.840.113549.2.5","md5");I("1.2.840.113549.1.7.1","data");I("1.2.840.113549.1.7.2","signedData");I("1.2.840.113549.1.7.3","envelopedData");I("1.2.840.113549.1.7.4","signedAndEnvelopedData");I("1.2.840.113549.1.7.5","digestedData");I("1.2.840.113549.1.7.6","encryptedData");I("1.2.840.113549.1.9.1","emailAddress");I("1.2.840.113549.1.9.2","unstructuredName");I("1.2.840.113549.1.9.3","contentType");I("1.2.840.113549.1.9.4","messageDigest");I("1.2.840.113549.1.9.5","signingTime");I("1.2.840.113549.1.9.6","counterSignature");I("1.2.840.113549.1.9.7","challengePassword");I("1.2.840.113549.1.9.8","unstructuredAddress");I("1.2.840.113549.1.9.14","extensionRequest");I("1.2.840.113549.1.9.20","friendlyName");I("1.2.840.113549.1.9.21","localKeyId");I("1.2.840.113549.1.9.22.1","x509Certificate");I("1.2.840.113549.1.12.10.1.1","keyBag");I("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");I("1.2.840.113549.1.12.10.1.3","certBag");I("1.2.840.113549.1.12.10.1.4","crlBag");I("1.2.840.113549.1.12.10.1.5","secretBag");I("1.2.840.113549.1.12.10.1.6","safeContentsBag");I("1.2.840.113549.1.5.13","pkcs5PBES2");I("1.2.840.113549.1.5.12","pkcs5PBKDF2");I("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");I("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");I("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");I("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");I("1.2.840.113549.2.7","hmacWithSHA1");I("1.2.840.113549.2.8","hmacWithSHA224");I("1.2.840.113549.2.9","hmacWithSHA256");I("1.2.840.113549.2.10","hmacWithSHA384");I("1.2.840.113549.2.11","hmacWithSHA512");I("1.2.840.113549.3.7","des-EDE3-CBC");I("2.16.840.1.101.3.4.1.2","aes128-CBC");I("2.16.840.1.101.3.4.1.22","aes192-CBC");I("2.16.840.1.101.3.4.1.42","aes256-CBC");I("2.5.4.3","commonName");I("2.5.4.4","surname");I("2.5.4.5","serialNumber");I("2.5.4.6","countryName");I("2.5.4.7","localityName");I("2.5.4.8","stateOrProvinceName");I("2.5.4.9","streetAddress");I("2.5.4.10","organizationName");I("2.5.4.11","organizationalUnitName");I("2.5.4.12","title");I("2.5.4.13","description");I("2.5.4.15","businessCategory");I("2.5.4.17","postalCode");I("2.5.4.42","givenName");I("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");I("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");I("2.16.840.1.113730.1.1","nsCertType");I("2.16.840.1.113730.1.13","nsComment");lt("2.5.29.1","authorityKeyIdentifier");lt("2.5.29.2","keyAttributes");lt("2.5.29.3","certificatePolicies");lt("2.5.29.4","keyUsageRestriction");lt("2.5.29.5","policyMapping");lt("2.5.29.6","subtreesConstraint");lt("2.5.29.7","subjectAltName");lt("2.5.29.8","issuerAltName");lt("2.5.29.9","subjectDirectoryAttributes");lt("2.5.29.10","basicConstraints");lt("2.5.29.11","nameConstraints");lt("2.5.29.12","policyConstraints");lt("2.5.29.13","basicConstraints");I("2.5.29.14","subjectKeyIdentifier");I("2.5.29.15","keyUsage");lt("2.5.29.16","privateKeyUsagePeriod");I("2.5.29.17","subjectAltName");I("2.5.29.18","issuerAltName");I("2.5.29.19","basicConstraints");lt("2.5.29.20","cRLNumber");lt("2.5.29.21","cRLReason");lt("2.5.29.22","expirationDate");lt("2.5.29.23","instructionCode");lt("2.5.29.24","invalidityDate");lt("2.5.29.25","cRLDistributionPoints");lt("2.5.29.26","issuingDistributionPoint");lt("2.5.29.27","deltaCRLIndicator");lt("2.5.29.28","issuingDistributionPoint");lt("2.5.29.29","certificateIssuer");lt("2.5.29.30","nameConstraints");I("2.5.29.31","cRLDistributionPoints");I("2.5.29.32","certificatePolicies");lt("2.5.29.33","policyMappings");lt("2.5.29.34","policyConstraints");I("2.5.29.35","authorityKeyIdentifier");lt("2.5.29.36","policyConstraints");I("2.5.29.37","extKeyUsage");lt("2.5.29.46","freshestCRL");lt("2.5.29.54","inhibitAnyPolicy");I("1.3.6.1.4.1.11129.2.4.2","timestampList");I("1.3.6.1.5.5.7.1.1","authorityInfoAccess");I("1.3.6.1.5.5.7.3.1","serverAuth");I("1.3.6.1.5.5.7.3.2","clientAuth");I("1.3.6.1.5.5.7.3.3","codeSigning");I("1.3.6.1.5.5.7.3.4","emailProtection");I("1.3.6.1.5.5.7.3.8","timeStamping")});var Pn=k((Sm,Of)=>{var mt=yt();Rt();Ri();var U=Of.exports=mt.asn1=mt.asn1||{};U.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};U.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};U.create=function(e,t,r,n,i){if(mt.util.isArray(n)){for(var s=[],a=0;a<n.length;++a)n[a]!==void 0&&s.push(n[a]);n=s}var o={tagClass:e,type:t,constructed:r,composed:r||mt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=U.copy(o)),o};U.copy=function(e,t){var r;if(mt.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(U.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:U.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};U.equals=function(e,t,r){if(mt.util.isArray(e)){if(!mt.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!U.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&U.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};U.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function Nn(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var _p=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;Nn(e,t,s),n=e.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};U.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=mt.util.createBuffer(e));var r=e.length(),n=Ui(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function Ui(e,t,r,n){var i;Nn(e,t,2);var s=e.getByte();t--;var a=s&192,o=s&31;i=e.length();var f=_p(e,t);if(t-=i-e.length(),f!==void 0&&f>t){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=e.length(),c.remaining=t,c.requested=f,c}f=t}var u,h,l=(s&32)===32;if(l)if(u=[],f===void 0)for(;;){if(Nn(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),u.push(Ui(e,t,r+1,n)),t-=i-e.length()}else for(;f>0;)i=e.length(),u.push(Ui(e,f,r+1,n)),t-=i-e.length(),f-=i-e.length();if(u===void 0&&a===U.Class.UNIVERSAL&&o===U.Type.BITSTRING&&(h=e.bytes(f)),u===void 0&&n.decodeBitStrings&&a===U.Class.UNIVERSAL&&o===U.Type.BITSTRING&&f>1){var d=e.read,p=t,y=0;if(o===U.Type.BITSTRING&&(Nn(e,t,1),y=e.getByte(),t--),y===0)try{i=e.length();var g={strict:!0,decodeBitStrings:!0},m=Ui(e,t,r+1,g),b=i-e.length();t-=b,o==U.Type.BITSTRING&&b++;var w=m.tagClass;b===f&&(w===U.Class.UNIVERSAL||w===U.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(e.read=d,t=p)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(o===U.Type.BMPSTRING)for(u="";f>0;f-=2)Nn(e,t,2),u+=String.fromCharCode(e.getInt16()),t-=2;else u=e.getBytes(f),t-=f}var C=h===void 0?null:{bitStringContents:h};return U.create(a,o,l,u,C)}U.toDer=function(e){var t=mt.util.createBuffer(),r=e.tagClass|e.type,n=mt.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=U.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var s=0;s<e.value.length;++s)e.value[s]!==void 0&&n.putBuffer(U.toDer(e.value[s]))}else if(e.type===U.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)n.putInt16(e.value.charCodeAt(s));else e.type===U.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&(e.value.charCodeAt(1)&128)===0||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var a=n.length(),o="";do o+=String.fromCharCode(a&255),a=a>>>8;while(a>0);t.putByte(o.length|128);for(var s=o.length-1;s>=0;--s)t.putByte(o.charCodeAt(s))}return t.putBuffer(n),t};U.oidToDer=function(e){var t=e.split("."),r=mt.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,a,o=2;o<t.length;++o){n=!0,i=[],s=parseInt(t[o],10);do a=s&127,s=s>>>7,n||(a|=128),i.push(a),n=!1;while(s>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};U.derToOid=function(e){var t;typeof e=="string"&&(e=mt.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};U.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var f=e.charAt(10),c=10;f!=="+"&&f!=="-"&&(o=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,0),c&&(f=e.charAt(c),f==="+"||f==="-")){var u=parseInt(e.substr(c+1,2),10),h=parseInt(e.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?t.setTime(+t-l):t.setTime(+t+l)}return t};U.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),f=0,c=0,u=!1;e.charAt(e.length-1)==="Z"&&(u=!0);var h=e.length-5,l=e.charAt(h);if(l==="+"||l==="-"){var d=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);c=d*60+p,c*=6e4,l==="+"&&(c*=-1),u=!0}return e.charAt(14)==="."&&(f=parseFloat(e.substr(14),10)*1e3),u?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,f),t.setTime(+t+c)):(t.setFullYear(r,n,i),t.setHours(s,a,o,f)),t};U.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};U.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};U.integerToDer=function(e){var t=mt.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};U.derToInteger=function(e){typeof e=="string"&&(e=mt.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};U.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&mt.util.isArray(t.value))for(var s=0,a=0;i&&a<t.value.length;++a)i=t.value[a].optional||!1,e.value[s]&&(i=U.validate(e.value[s],t.value[a],r,n),i?++s:t.value[a].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var o;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var f=e.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var Mf=/[^\\u0000-\\u00ff]/;U.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",s=0;s<t*r;++s)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case U.Class.UNIVERSAL:n+="Universal:";break;case U.Class.APPLICATION:n+="Application:";break;case U.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case U.Class.PRIVATE:n+="Private:";break}if(e.tagClass===U.Class.UNIVERSAL)switch(n+=e.type,e.type){case U.Type.NONE:n+=" (None)";break;case U.Type.BOOLEAN:n+=" (Boolean)";break;case U.Type.INTEGER:n+=" (Integer)";break;case U.Type.BITSTRING:n+=" (Bit string)";break;case U.Type.OCTETSTRING:n+=" (Octet string)";break;case U.Type.NULL:n+=" (Null)";break;case U.Type.OID:n+=" (Object Identifier)";break;case U.Type.ODESC:n+=" (Object Descriptor)";break;case U.Type.EXTERNAL:n+=" (External or Instance of)";break;case U.Type.REAL:n+=" (Real)";break;case U.Type.ENUMERATED:n+=" (Enumerated)";break;case U.Type.EMBEDDED:n+=" (Embedded PDV)";break;case U.Type.UTF8:n+=" (UTF8)";break;case U.Type.ROID:n+=" (Relative Object Identifier)";break;case U.Type.SEQUENCE:n+=" (Sequence)";break;case U.Type.SET:n+=" (Set)";break;case U.Type.PRINTABLESTRING:n+=" (Printable String)";break;case U.Type.IA5String:n+=" (IA5String (ASCII))";break;case U.Type.UTCTIME:n+=" (UTC time)";break;case U.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case U.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var a=0,o="",s=0;s<e.value.length;++s)e.value[s]!==void 0&&(a+=1,o+=U.prettyPrint(e.value[s],t+1,r),s+1<e.value.length&&(o+=","));n+=i+"Sub values: "+a+o}else{if(n+=i+"Value: ",e.type===U.Type.OID){var f=U.derToOid(e.value);n+=f,mt.pki&&mt.pki.oids&&f in mt.pki.oids&&(n+=" ("+mt.pki.oids[f]+") ")}if(e.type===U.Type.INTEGER)try{n+=U.derToInteger(e.value)}catch{n+="0x"+mt.util.bytesToHex(e.value)}else if(e.type===U.Type.BITSTRING){if(e.value.length>1?n+="0x"+mt.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var c=e.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(e.type===U.Type.OCTETSTRING)Mf.test(e.value)||(n+="("+e.value+") "),n+="0x"+mt.util.bytesToHex(e.value);else if(e.type===U.Type.UTF8)try{n+=mt.util.decodeUtf8(e.value)}catch(u){if(u.message==="URI malformed")n+="0x"+mt.util.bytesToHex(e.value)+" (malformed UTF8)";else throw u}else e.type===U.Type.PRINTABLESTRING||e.type===U.Type.IA5String?n+=e.value:Mf.test(e.value)?n+="0x"+mt.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var ca=k((Bm,Hf)=>{var kt=yt();Rt();Hf.exports=kt.cipher=kt.cipher||{};kt.cipher.algorithms=kt.cipher.algorithms||{};kt.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=kt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new kt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};kt.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=kt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new kt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};kt.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),kt.cipher.algorithms[e]=t};kt.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in kt.cipher.algorithms?kt.cipher.algorithms[e]:null};var fa=kt.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};fa.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=kt.util.createBuffer(),this.output=e.output||kt.util.createBuffer(),this.mode.start(t)};fa.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};fa.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var ha=k((Am,Vf)=>{var Dt=yt();Rt();Dt.cipher=Dt.cipher||{};var $=Vf.exports=Dt.cipher.modes=Dt.cipher.modes||{};$.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.ecb.prototype.start=function(e){};$.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};$.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};$.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};$.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};$.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=Ni(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};$.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};$.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};$.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};$.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};$.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0};$.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Ni(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0};$.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Ni(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb.prototype.decrypt=$.ofb.prototype.encrypt;$.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0};$.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Ni(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Pi(this._inBlock)};$.ctr.prototype.decrypt=$.ctr.prototype.encrypt;$.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Dt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};$.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Dt.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=Dt.util.createBuffer(e.additionalData):r=Dt.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Dt.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(ua(n*8)))}this._inBlock=this._j0.slice(0),Pi(this._inBlock),this._partialBytes=0,r=Dt.util.createBuffer(r),this._aDataLength=ua(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};$.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Pi(this._inBlock)};$.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Pi(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};$.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Dt.util.createBuffer();var n=this._aDataLength.concat(ua(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};$.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};$.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};$.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t};$.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};$.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),a=0;a<i;++a){var o=[0,0,0,0],f=a/n|0,c=(n-1-a%n)*t;o[f]=1<<t-1<<c,s[a]=this.generateSubHashTable(this.multiply(o,e),t)}return s};$.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var o=i[s],f=i[a];i[s+a]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var c=i[s^n];i[s]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return i};function Ni(e,t){if(typeof e=="string"&&(e=Dt.util.createBuffer(e)),Dt.util.isArray(e)&&e.length>4){var r=e;e=Dt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Dt.util.isArray(e)){for(var i=[],s=t/4,n=0;n<s;++n)i.push(e.getInt32());e=i}return e}function Pi(e){e[e.length-1]=e[e.length-1]+1&4294967295}function ua(e){return[e/4294967296|0,e&4294967295]}});var ya=k((_m,Wf)=>{var xt=yt();ca();ha();Rt();Wf.exports=xt.aes=xt.aes||{};xt.aes.startEncrypting=function(e,t,r,n){var i=ki({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};xt.aes.createEncryptionCipher=function(e,t){return ki({key:e,output:null,decrypt:!1,mode:t})};xt.aes.startDecrypting=function(e,t,r,n){var i=ki({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};xt.aes.createDecryptionCipher=function(e,t){return ki({key:e,output:null,decrypt:!0,mode:t})};xt.aes.Algorithm=function(e,t){da||zf();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return pa(r._w,n,i,!1)},decrypt:function(n,i){return pa(r._w,n,i,!0)}}}),r._init=!1};xt.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=xt.util.createBuffer(t);else if(xt.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=xt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!xt.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!xt.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=Gf(t,e.decrypt&&!a),this._init=!0}};xt.aes._expandKey=function(e,t){return da||zf(),Gf(e,t)};xt.aes._updateBlock=pa;Gr("AES-ECB",xt.cipher.modes.ecb);Gr("AES-CBC",xt.cipher.modes.cbc);Gr("AES-CFB",xt.cipher.modes.cfb);Gr("AES-OFB",xt.cipher.modes.ofb);Gr("AES-CTR",xt.cipher.modes.ctr);Gr("AES-GCM",xt.cipher.modes.gcm);function Gr(e,t){var r=function(){return new xt.aes.Algorithm(e,t)};xt.cipher.registerAlgorithm(e,r)}var da=!1,zr=4,te,la,qf,_r,ve;function zf(){da=!0,qf=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;te=new Array(256),la=new Array(256),_r=new Array(4),ve=new Array(4);for(var t=0;t<4;++t)_r[t]=new Array(256),ve[t]=new Array(256);for(var r=0,n=0,i,s,a,o,f,c,u,t=0;t<256;++t){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,te[r]=o,la[o]=r,f=e[o],i=e[r],s=e[i],a=e[s],c=f<<24^o<<16^o<<8^(o^f),u=(i^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^i^a);for(var h=0;h<4;++h)_r[h][r]=c,ve[h][o]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^e[e[e[i^a]]],n^=e[e[n]])}}function Gf(e,t){for(var r=e.slice(0),n,i=1,s=r.length,a=s+6+1,o=zr*a,f=s;f<o;++f)n=r[f-1],f%s===0?(n=te[n>>>16&255]<<24^te[n>>>8&255]<<16^te[n&255]<<8^te[n>>>24]^qf[i]<<24,i++):s>6&&f%s===4&&(n=te[n>>>24]<<24^te[n>>>16&255]<<16^te[n>>>8&255]<<8^te[n&255]),r[f]=r[f-s]^n;if(t){var c,u=ve[0],h=ve[1],l=ve[2],d=ve[3],p=r.slice(0);o=r.length;for(var f=0,y=o-zr;f<o;f+=zr,y-=zr)if(f===0||f===o-zr)p[f]=r[y],p[f+1]=r[y+3],p[f+2]=r[y+2],p[f+3]=r[y+1];else for(var g=0;g<zr;++g)c=r[y+g],p[f+(3&-g)]=u[te[c>>>24]]^h[te[c>>>16&255]]^l[te[c>>>8&255]]^d[te[c&255]];r=p}return r}function pa(e,t,r,n){var i=e.length/4-1,s,a,o,f,c;n?(s=ve[0],a=ve[1],o=ve[2],f=ve[3],c=la):(s=_r[0],a=_r[1],o=_r[2],f=_r[3],c=te);var u,h,l,d,p,y,g;u=t[0]^e[0],h=t[n?3:1]^e[1],l=t[2]^e[2],d=t[n?1:3]^e[3];for(var m=3,b=1;b<i;++b)p=s[u>>>24]^a[h>>>16&255]^o[l>>>8&255]^f[d&255]^e[++m],y=s[h>>>24]^a[l>>>16&255]^o[d>>>8&255]^f[u&255]^e[++m],g=s[l>>>24]^a[d>>>16&255]^o[u>>>8&255]^f[h&255]^e[++m],d=s[d>>>24]^a[u>>>16&255]^o[h>>>8&255]^f[l&255]^e[++m],u=p,h=y,l=g;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[d&255]^e[++m],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[d>>>8&255]<<8^c[u&255]^e[++m],r[2]=c[l>>>24]<<24^c[d>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^e[++m],r[n?1:3]=c[d>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^e[++m]}function ki(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=xt.cipher.createDecipher(r,e.key):n=xt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof xt.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var $f=k((Cm,Xf)=>{var Et=yt();ca();ha();Rt();Xf.exports=Et.des=Et.des||{};Et.des.startEncrypting=function(e,t,r,n){var i=Di({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};Et.des.createEncryptionCipher=function(e,t){return Di({key:e,output:null,decrypt:!1,mode:t})};Et.des.startDecrypting=function(e,t,r,n){var i=Di({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};Et.des.createDecryptionCipher=function(e,t){return Di({key:e,output:null,decrypt:!0,mode:t})};Et.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return Yf(r._keys,n,i,!1)},decrypt:function(n,i){return Yf(r._keys,n,i,!0)}}}),r._init=!1};Et.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=Et.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=kp(t),this._init=!0}};Re("DES-ECB",Et.cipher.modes.ecb);Re("DES-CBC",Et.cipher.modes.cbc);Re("DES-CFB",Et.cipher.modes.cfb);Re("DES-OFB",Et.cipher.modes.ofb);Re("DES-CTR",Et.cipher.modes.ctr);Re("3DES-ECB",Et.cipher.modes.ecb);Re("3DES-CBC",Et.cipher.modes.cbc);Re("3DES-CFB",Et.cipher.modes.cfb);Re("3DES-OFB",Et.cipher.modes.ofb);Re("3DES-CTR",Et.cipher.modes.ctr);function Re(e,t){var r=function(){return new Et.des.Algorithm(e,t)};Et.cipher.registerAlgorithm(e,r)}var Cp=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Tp=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Ip=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Lp=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Rp=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Up=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Np=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Pp=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function kp(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=e.length()>8?3:1,g=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,w,C=0;C<y;C++){var A=e.getInt32(),B=e.getInt32();w=(A>>>4^B)&252645135,B^=w,A^=w<<4,w=(B>>>-16^A)&65535,A^=w,B^=w<<-16,w=(A>>>2^B)&858993459,B^=w,A^=w<<2,w=(B>>>-16^A)&65535,A^=w,B^=w<<-16,w=(A>>>1^B)&1431655765,B^=w,A^=w<<1,w=(B>>>8^A)&16711935,A^=w,B^=w<<8,w=(A>>>1^B)&1431655765,B^=w,A^=w<<1,w=A<<8|B>>>20&240,A=B<<24|B<<8&16711680|B>>>8&65280|B>>>24&240,B=w;for(var L=0;L<m.length;++L){m[L]?(A=A<<2|A>>>26,B=B<<2|B>>>26):(A=A<<1|A>>>27,B=B<<1|B>>>27),A&=-15,B&=-15;var R=t[A>>>28]|r[A>>>24&15]|n[A>>>20&15]|i[A>>>16&15]|s[A>>>12&15]|a[A>>>8&15]|o[A>>>4&15],D=f[B>>>28]|c[B>>>24&15]|u[B>>>20&15]|h[B>>>16&15]|l[B>>>12&15]|d[B>>>8&15]|p[B>>>4&15];w=(D>>>16^R)&65535,g[b++]=R^w,g[b++]=D^w<<16}}return g}function Yf(e,t,r,n){var i=e.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,o=t[0],f=t[1];a=(o>>>4^f)&252645135,f^=a,o^=a<<4,a=(o>>>16^f)&65535,f^=a,o^=a<<16,a=(f>>>2^o)&858993459,o^=a,f^=a<<2,a=(f>>>8^o)&16711935,o^=a,f^=a<<8,a=(o>>>1^f)&1431655765,f^=a,o^=a<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=s[c+1],h=s[c+2],l=s[c];l!=u;l+=h){var d=f^e[l],p=(f>>>4|f<<28)^e[l+1];a=o,o=f,f=a^(Tp[d>>>24&63]|Lp[d>>>16&63]|Up[d>>>8&63]|Pp[d&63]|Cp[p>>>24&63]|Ip[p>>>16&63]|Rp[p>>>8&63]|Np[p&63])}a=o,o=f,f=a}o=o>>>1|o<<31,f=f>>>1|f<<31,a=(o>>>1^f)&1431655765,f^=a,o^=a<<1,a=(f>>>8^o)&16711935,o^=a,f^=a<<8,a=(f>>>2^o)&858993459,o^=a,f^=a<<2,a=(o>>>16^f)&65535,f^=a,o^=a<<16,a=(o>>>4^f)&252645135,f^=a,o^=a<<4,r[0]=o,r[1]=f}function Di(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=Et.cipher.createDecipher(r,e.key):n=Et.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof Et.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var Cr=k((Tm,Zf)=>{var Ki=yt();Zf.exports=Ki.md=Ki.md||{};Ki.md.algorithms=Ki.md.algorithms||{}});var Jf=k((Im,Qf)=>{var We=yt();Cr();Rt();var Dp=Qf.exports=We.hmac=We.hmac||{};Dp.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in We.md.algorithms)t=We.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else t=s;if(a===null)a=e;else{if(typeof a=="string")a=We.util.createBuffer(a);else if(We.util.isArray(a)){var o=a;a=We.util.createBuffer();for(var f=0;f<o.length;++f)a.putByte(o[f])}var c=a.length();c>t.blockLength&&(t.start(),t.update(a.bytes()),a=t.digest()),r=We.util.createBuffer(),n=We.util.createBuffer(),c=a.length();for(var f=0;f<c;++f){var o=a.at(f);r.putByte(54^o),n.putByte(92^o)}if(c<t.blockLength)for(var o=t.blockLength-c,f=0;f<o;++f)r.putByte(54),n.putByte(92);e=a,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(s){t.update(s)},i.getMac=function(){var s=t.digest().bytes();return t.start(),t.update(n),t.update(s),t.digest()},i.digest=i.getMac,i}});var tc=k((Lm,jf)=>{var ee=yt();Jf();Cr();Rt();var Kp=ee.pkcs5=ee.pkcs5||{},Ye;ee.util.isNodejs&&!ee.options.usePureJavaScript&&(Ye=mr());jf.exports=ee.pbkdf2=Kp.pbkdf2=function(e,t,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),ee.util.isNodejs&&!ee.options.usePureJavaScript&&Ye.pbkdf2&&(i===null||typeof i!="object")&&(Ye.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),s?Ye.pbkdf2Sync.length===4?Ye.pbkdf2(e,t,r,n,function(w,C){if(w)return s(w);s(null,C.toString("binary"))}):Ye.pbkdf2(e,t,r,n,i,function(w,C){if(w)return s(w);s(null,C.toString("binary"))}):Ye.pbkdf2Sync.length===4?Ye.pbkdf2Sync(e,t,r,n).toString("binary"):Ye.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in ee.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=ee.md[i].create()}var a=i.digestLength;if(n>4294967295*a){var o=new Error("Derived key is too long.");if(s)return s(o);throw o}var f=Math.ceil(n/a),c=n-(f-1)*a,u=ee.hmac.create();u.start(i,e);var h="",l,d,p;if(!s){for(var y=1;y<=f;++y){u.start(null,null),u.update(t),u.update(ee.util.int32ToBytes(y)),l=p=u.digest().getBytes();for(var g=2;g<=r;++g)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=ee.util.xorBytes(l,d,a),p=d;h+=y<f?l:l.substr(0,c)}return h}var y=1,g;function m(){if(y>f)return s(null,h);u.start(null,null),u.update(t),u.update(ee.util.int32ToBytes(y)),l=p=u.digest().getBytes(),g=2,b()}function b(){if(g<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=ee.util.xorBytes(l,d,a),p=d,++g,ee.util.setImmediate(b);h+=y<f?l:l.substr(0,c),++y,m()}m()}});var nc=k((Rm,rc)=>{var Mi=yt();Rt();var ec=rc.exports=Mi.pem=Mi.pem||{};ec.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=Fi(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=Fi(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=Fi(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=Fi(e.headers[i]);return e.procType&&(r+=`\r
`),r+=Mi.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};ec.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(e),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var o={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Mi.util.decode64(s[3])};if(t.push(o),!!s[2]){for(var f=s[2].split(i),c=0;s&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(s=u.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),y=0;y<p.length;++y)d.values.push(Fp(p[y]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function Fi(e){for(var t=e.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var s=0,a=-1,i=0;i<t.length;++i,++s)if(s>65&&a!==-1){var o=t[a];o===","?(++a,t=t.substr(0,a)+`\r
 `+t.substr(a)):t=t.substr(0,a)+`\r
`+o+t.substr(a+1),s=i-a-1,a=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(a=i);return t}function Fp(e){return e.replace(/^\s+/,"")}});var cc=k((Um,fc)=>{var Ue=yt();Cr();Rt();var sc=fc.exports=Ue.sha256=Ue.sha256||{};Ue.md.sha256=Ue.md.algorithms.sha256=sc;sc.create=function(){ac||Mp();var e=null,t=Ue.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=Ue.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Ue.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),ic(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Ue.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(ga.substr(0,n.blockLength-a));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};ic(h,r,i);var l=Ue.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var ga=null,ac=!1,oc=null;function Mp(){ga=String.fromCharCode(128),ga+=Ue.util.fillString(String.fromCharCode(0),64),oc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],ac=!0}function ic(e,t,r){for(var n,i,s,a,o,f,c,u,h,l,d,p,y,g,m,b=r.length();b>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=t[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[c]=n+t[c-7]+i+t[c-16]|0;for(u=e.h0,h=e.h1,l=e.h2,d=e.h3,p=e.h4,y=e.h5,g=e.h6,m=e.h7,c=0;c<64;++c)a=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=g^p&(y^g),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=m+a+o+oc[c]+t[c],i=s+f,m=g,g=y,y=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;e.h0=e.h0+u|0,e.h1=e.h1+h|0,e.h2=e.h2+l|0,e.h3=e.h3+d|0,e.h4=e.h4+p|0,e.h5=e.h5+y|0,e.h6=e.h6+g|0,e.h7=e.h7+m|0,b-=64}}});var hc=k((Nm,uc)=>{var Ne=yt();Rt();var Oi=null;Ne.util.isNodejs&&!Ne.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Oi=mr());var Op=uc.exports=Ne.prng=Ne.prng||{};Op.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(c,u){if(!u)return t.generateSync(c);var h=t.plugin.cipher,l=t.plugin.increment,d=t.plugin.formatKey,p=t.plugin.formatSeed,y=Ne.util.createBuffer();t.key=null,g();function g(m){if(m)return u(m);if(y.length()>=c)return u(null,y.getBytes(c));if(t.generated>1048575&&(t.key=null),t.key===null)return Ne.util.nextTick(function(){s(g)});var b=h(t.key,t.seed);t.generated+=b.length,y.putBytes(b),t.key=d(h(t.key,l(t.seed))),t.seed=p(h(t.key,t.seed)),Ne.util.setImmediate(g)}},t.generateSync=function(c){var u=t.plugin.cipher,h=t.plugin.increment,l=t.plugin.formatKey,d=t.plugin.formatSeed;t.key=null;for(var p=Ne.util.createBuffer();p.length()<c;){t.generated>1048575&&(t.key=null),t.key===null&&a();var y=u(t.key,t.seed);t.generated+=y.length,p.putBytes(y),t.key=l(u(t.key,h(t.seed))),t.seed=d(u(t.key,t.seed))}return p.getBytes(c)};function s(c){if(t.pools[0].messageLength>=32)return o(),c();var u=32-t.pools[0].messageLength<<5;t.seedFile(u,function(h,l){if(h)return c(h);t.collect(l),o(),c()})}function a(){if(t.pools[0].messageLength>=32)return o();var c=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(c)),o()}function o(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var c=t.plugin.md.create();c.update(t.keyBytes);for(var u=1,h=0;h<32;++h)t.reseeds%u===0&&(c.update(t.pools[h].digest().getBytes()),t.pools[h].start()),u=u<<1;t.keyBytes=c.digest().getBytes(),c.start(),c.update(t.keyBytes);var l=c.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(l),t.generated=0}function f(c){var u=null,h=Ne.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(A){return l.getRandomValues(A)});var d=Ne.util.createBuffer();if(u)for(;d.length()<c;){var p=Math.max(1,Math.min(c-d.length(),65536)/4),y=new Uint32Array(Math.floor(p));try{u(y);for(var g=0;g<y.length;++g)d.putInt32(y[g])}catch(A){if(!(typeof QuotaExceededError<"u"&&A instanceof QuotaExceededError))throw A}}if(d.length()<c)for(var m,b,w,C=Math.floor(Math.random()*65536);d.length()<c;){b=16807*(C&65535),m=16807*(C>>16),b+=(m&32767)<<16,b+=m>>15,b=(b&2147483647)+(b>>31),C=b&4294967295;for(var g=0;g<3;++g)w=C>>>(g<<3),w^=Math.floor(Math.random()*256),d.putByte(w&255)}return d.getBytes(c)}return Oi?(t.seedFile=function(c,u){Oi.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},t.seedFileSync=function(c){return Oi.randomBytes(c).toString()}):(t.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},t.seedFileSync=f),t.collect=function(c){for(var u=c.length,h=0;h<u;++h)t.pools[t.pool].update(c.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);t.collect(h)},t.registerWorker=function(c){if(c===self)t.seedFile=function(h,l){function d(p){var y=p.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",d),l(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&t.seedFile(l.forge.prng.needed,function(d,p){c.postMessage({forge:{prng:{err:d,bytes:p}}})})};c.addEventListener("message",u)}},t}});var kn=k((Pm,xa)=>{var Kt=yt();ya();cc();hc();Rt();(function(){if(Kt.random&&Kt.random.getBytes){xa.exports=Kt.random;return}(function(e){var t={},r=new Array(4),n=Kt.util.createBuffer();t.formatKey=function(h){var l=Kt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Kt.aes._expandKey(h,!1)},t.formatSeed=function(h){var l=Kt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},t.cipher=function(h,l){return Kt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=Kt.md.sha256;function i(){var h=Kt.prng.create(t);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),a=null,o=Kt.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(a=function(h){return f.getRandomValues(h)}),Kt.options.usePureJavaScript||!Kt.util.isNodejs&&!a){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}s.collect(c),c=null}e&&(e().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),e().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Kt.random)Kt.random=s;else for(var u in s)Kt.random[u]=s[u];Kt.random.createInstance=i,xa.exports=Kt.random})(typeof jQuery<"u"?jQuery:null)})()});var yc=k((km,dc)=>{var ne=yt();Rt();var ma=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],lc=[1,2,3,5],Hp=function(e,t){return e<<t&65535|(e&65535)>>16-t},Vp=function(e,t){return(e&65535)>>t|e<<16-t&65535};dc.exports=ne.rc2=ne.rc2||{};ne.rc2.expandKey=function(e,t){typeof e=="string"&&(e=ne.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,s=Math.ceil(i/8),a=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(ma[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-s,ma[r.at(128-s)&a]),o=127-s;o>=0;o--)r.setAt(o,ma[r.at(o+1)^r.at(o+s)]);return r};var pc=function(e,t,r){var n=!1,i=null,s=null,a=null,o,f,c,u,h=[];for(e=ne.rc2.expandKey(e,t),c=0;c<64;c++)h.push(e.getInt16Le());r?(o=function(p){for(c=0;c<4;c++)p[c]+=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=Hp(p[c],lc[c]),u++},f=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(o=function(p){for(c=3;c>=0;c--)p[c]=Vp(p[c],lc[c]),p[c]-=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),u--},f=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var y=[];for(c=0;c<4;c++){var g=i.getInt16Le();a!==null&&(r?g^=a.getInt16Le():a.putInt16Le(g)),y.push(g&65535)}u=r?0:63;for(var m=0;m<p.length;m++)for(var b=0;b<p[m][0];b++)p[m][1](y);for(c=0;c<4;c++)a!==null&&(r?a.putInt16Le(y[c]):y[c]^=a.getInt16Le()),s.putInt16Le(y[c])},d=null;return d={start:function(p,y){p&&typeof p=="string"&&(p=ne.util.createBuffer(p)),n=!1,i=ne.util.createBuffer(),s=y||new ne.util.createBuffer,a=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(p){var y=!0;if(r)if(p)y=p(8,i,!r);else{var g=i.length()===8?8:8-i.length();i.fillWithByte(g,g)}if(y&&(n=!0,d.update()),!r&&(y=i.length()===0,y))if(p)y=p(8,s,!r);else{var m=s.length(),b=s.at(m-1);b>m?y=!1:s.truncate(b)}return y}},d};ne.rc2.startEncrypting=function(e,t,r){var n=ne.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};ne.rc2.createEncryptionCipher=function(e,t){return pc(e,t,!0)};ne.rc2.startDecrypting=function(e,t,r){var n=ne.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};ne.rc2.createDecryptionCipher=function(e,t){return pc(e,t,!1)}});var qi=k((Dm,Sc)=>{var va=yt();Sc.exports=va.jsbn=va.jsbn||{};var Xe,qp=0xdeadbeefcafe,gc=(qp&16777215)==15715070;function _(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}va.jsbn.BigInteger=_;function st(){return new _(null)}function zp(e,t,r,n,i,s){for(;--s>=0;){var a=t*this.data[e++]+r.data[n]+i;i=Math.floor(a/67108864),r.data[n++]=a&67108863}return i}function Gp(e,t,r,n,i,s){for(var a=t&32767,o=t>>15;--s>=0;){var f=this.data[e]&32767,c=this.data[e++]>>15,u=o*f+c*a;f=a*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+o*c+(i>>>30),r.data[n++]=f&1073741823}return i}function xc(e,t,r,n,i,s){for(var a=t&16383,o=t>>14;--s>=0;){var f=this.data[e]&16383,c=this.data[e++]>>14,u=o*f+c*a;f=a*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+o*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(_.prototype.am=xc,Xe=28):gc&&navigator.appName=="Microsoft Internet Explorer"?(_.prototype.am=Gp,Xe=30):gc&&navigator.appName!="Netscape"?(_.prototype.am=zp,Xe=26):(_.prototype.am=xc,Xe=28);_.prototype.DB=Xe;_.prototype.DM=(1<<Xe)-1;_.prototype.DV=1<<Xe;var wa=52;_.prototype.FV=Math.pow(2,wa);_.prototype.F1=wa-Xe;_.prototype.F2=2*Xe-wa;var Wp="0123456789abcdefghijklmnopqrstuvwxyz",Hi=new Array,Wr,pe;Wr="0".charCodeAt(0);for(pe=0;pe<=9;++pe)Hi[Wr++]=pe;Wr="a".charCodeAt(0);for(pe=10;pe<36;++pe)Hi[Wr++]=pe;Wr="A".charCodeAt(0);for(pe=10;pe<36;++pe)Hi[Wr++]=pe;function mc(e){return Wp.charAt(e)}function vc(e,t){var r=Hi[e.charCodeAt(t)];return r??-1}function Yp(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function Xp(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function sr(e){var t=st();return t.fromInt(e),t}function $p(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=r==8?e[n]&255:vc(e,n);if(a<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(e[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&_.ZERO.subTo(this,this)}function Zp(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function Qp(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",a=this.t,o=this.DB-a*this.DB%t;if(a-- >0)for(o<this.DB&&(n=this.data[a]>>o)>0&&(i=!0,s=mc(n));a>=0;)o<t?(n=(this.data[a]&(1<<o)-1)<<t-o,n|=this.data[--a]>>(o+=this.DB-t)):(n=this.data[a]>>(o-=t)&r,o<=0&&(o+=this.DB,--a)),n>0&&(i=!0),i&&(s+=mc(n));return i?s:"0"}function Jp(){var e=st();return _.ZERO.subTo(this,e),e}function jp(){return this.s<0?this.negate():this}function td(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function Vi(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function ed(){return this.t<=0?0:this.DB*(this.t-1)+Vi(this.data[this.t-1]^this.s&this.DM)}function rd(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function nd(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function id(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t.data[o+s+1]=this.data[o]>>n|a,a=(this.data[o]&i)<<r;for(o=s-1;o>=0;--o)t.data[o]=0;t.data[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()}function sd(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)t.data[a-r-1]|=(this.data[a]&s)<<i,t.data[a-r]=this.data[a]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function ad(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function od(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&_.ZERO.subTo(t,t)}function fd(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function cd(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=st());var s=st(),a=this.s,o=e.s,f=this.DB-Vi(n.data[n.t-1]);f>0?(n.lShiftTo(f,s),i.lShiftTo(f,r)):(n.copyTo(s),i.copyTo(r));var c=s.t,u=s.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?s.data[c-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,y=r.t,g=y-c,m=t??st();for(s.dlShiftTo(g,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),_.ONE.dlShiftTo(c,m),m.subTo(s,s);s.t<c;)s.data[s.t++]=0;for(;--g>=0;){var b=r.data[--y]==u?this.DM:Math.floor(r.data[y]*l+(r.data[y-1]+p)*d);if((r.data[y]+=s.am(0,b,r,g,0,c))<b)for(s.dlShiftTo(g,m),r.subTo(m,r);r.data[y]<--b;)r.subTo(m,r)}t!=null&&(r.drShiftTo(c,t),a!=o&&_.ZERO.subTo(t,t)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),a<0&&_.ZERO.subTo(r,r)}}}function ud(e){var t=st();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(_.ZERO)>0&&e.subTo(t,t),t}function Tr(e){this.m=e}function hd(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function ld(e){return e}function pd(e){e.divRemTo(this.m,null,e)}function dd(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function yd(e,t){e.squareTo(t),this.reduce(t)}Tr.prototype.convert=hd;Tr.prototype.revert=ld;Tr.prototype.reduce=pd;Tr.prototype.mulTo=dd;Tr.prototype.sqrTo=yd;function gd(){if(this.t<1)return 0;var e=this.data[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Ir(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function xd(e){var t=st();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(_.ZERO)>0&&this.m.subTo(t,t),t}function md(e){var t=st();return e.copyTo(t),this.reduce(t),t}function vd(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function wd(e,t){e.squareTo(t),this.reduce(t)}function bd(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Ir.prototype.convert=xd;Ir.prototype.revert=md;Ir.prototype.reduce=vd;Ir.prototype.mulTo=bd;Ir.prototype.sqrTo=wd;function Ed(){return(this.t>0?this.data[0]&1:this.s)==0}function Sd(e,t){if(e>4294967295||e<1)return _.ONE;var r=st(),n=st(),i=t.convert(this),s=Vi(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var a=r;r=n,n=a}return t.revert(r)}function Bd(e,t){var r;return e<256||t.isEven()?r=new Tr(t):r=new Ir(t),this.exp(e,r)}_.prototype.copyTo=Yp;_.prototype.fromInt=Xp;_.prototype.fromString=$p;_.prototype.clamp=Zp;_.prototype.dlShiftTo=rd;_.prototype.drShiftTo=nd;_.prototype.lShiftTo=id;_.prototype.rShiftTo=sd;_.prototype.subTo=ad;_.prototype.multiplyTo=od;_.prototype.squareTo=fd;_.prototype.divRemTo=cd;_.prototype.invDigit=gd;_.prototype.isEven=Ed;_.prototype.exp=Sd;_.prototype.toString=Qp;_.prototype.negate=Jp;_.prototype.abs=jp;_.prototype.compareTo=td;_.prototype.bitLength=ed;_.prototype.mod=ud;_.prototype.modPowInt=Bd;_.ZERO=sr(0);_.ONE=sr(1);function Ad(){var e=st();return this.copyTo(e),e}function _d(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Cd(){return this.t==0?this.s:this.data[0]<<24>>24}function Td(){return this.t==0?this.s:this.data[0]<<16>>16}function Id(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Ld(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Rd(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=sr(r),i=st(),s=st(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(e)+a}function Ud(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,o=0;o<e.length;++o){var f=vc(e,o);if(f<0){e.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}a=t*a+f,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&_.ZERO.subTo(this,this)}function Nd(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(_.ONE.shiftLeft(e-1),ba,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(_.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Pd(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function kd(e){return this.compareTo(e)==0}function Dd(e){return this.compareTo(e)<0?this:e}function Kd(e){return this.compareTo(e)>0?this:e}function Fd(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function Md(e,t){return e&t}function Od(e){var t=st();return this.bitwiseTo(e,Md,t),t}function ba(e,t){return e|t}function Hd(e){var t=st();return this.bitwiseTo(e,ba,t),t}function wc(e,t){return e^t}function Vd(e){var t=st();return this.bitwiseTo(e,wc,t),t}function bc(e,t){return e&~t}function qd(e){var t=st();return this.bitwiseTo(e,bc,t),t}function zd(){for(var e=st(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function Gd(e){var t=st();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Wd(e){var t=st();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Yd(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function Xd(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+Yd(this.data[e]);return this.s<0?this.t*this.DB:-1}function $d(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Zd(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=$d(this.data[r]^t);return e}function Qd(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function Jd(e,t){var r=_.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function jd(e){return this.changeBit(e,ba)}function t1(e){return this.changeBit(e,bc)}function e1(e){return this.changeBit(e,wc)}function r1(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function n1(e){var t=st();return this.addTo(e,t),t}function i1(e){var t=st();return this.subTo(e,t),t}function s1(e){var t=st();return this.multiplyTo(e,t),t}function a1(e){var t=st();return this.divRemTo(e,t,null),t}function o1(e){var t=st();return this.divRemTo(e,null,t),t}function f1(e){var t=st(),r=st();return this.divRemTo(e,t,r),new Array(t,r)}function c1(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function u1(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Dn(){}function Ec(e){return e}function h1(e,t,r){e.multiplyTo(t,r)}function l1(e,t){e.squareTo(t)}Dn.prototype.convert=Ec;Dn.prototype.revert=Ec;Dn.prototype.mulTo=h1;Dn.prototype.sqrTo=l1;function p1(e){return this.exp(e,new Dn)}function d1(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function y1(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function Yr(e){this.r2=st(),this.q3=st(),_.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function g1(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=st();return e.copyTo(t),this.reduce(t),t}function x1(e){return e}function m1(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function v1(e,t){e.squareTo(t),this.reduce(t)}function w1(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Yr.prototype.convert=g1;Yr.prototype.revert=x1;Yr.prototype.reduce=m1;Yr.prototype.mulTo=w1;Yr.prototype.sqrTo=v1;function b1(e,t){var r=e.bitLength(),n,i=sr(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Tr(t):t.isEven()?s=new Yr(t):s=new Ir(t);var a=new Array,o=3,f=n-1,c=(1<<n)-1;if(a[1]=s.convert(this),n>1){var u=st();for(s.sqrTo(a[1],u);o<=c;)a[o]=st(),s.mulTo(u,a[o-2],a[o]),o+=2}var h=e.t-1,l,d=!0,p=st(),y;for(r=Vi(e.data[h])-1;h>=0;){for(r>=f?l=e.data[h]>>r-f&c:(l=(e.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=e.data[h-1]>>this.DB+r-f)),o=n;(l&1)==0;)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),d)a[l].copyTo(i),d=!1;else{for(;o>1;)s.sqrTo(i,p),s.sqrTo(p,i),o-=2;o>0?s.sqrTo(i,p):(y=i,i=p,p=y),s.mulTo(p,a[l],i)}for(;h>=0&&(e.data[h]&1<<r)==0;)s.sqrTo(i,p),y=i,i=p,p=y,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function E1(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function S1(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function B1(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return _.ZERO;for(var r=e.clone(),n=this.clone(),i=sr(1),s=sr(0),a=sr(0),o=sr(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(e,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(o,s)):(n.subTo(r,n),t&&a.subTo(i,a),o.subTo(s,o))}if(n.compareTo(_.ONE)!=0)return _.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var we=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],A1=(1<<26)/we[we.length-1];function _1(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=we[we.length-1]){for(t=0;t<we.length;++t)if(r.data[0]==we[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<we.length;){for(var n=we[t],i=t+1;i<we.length&&n<A1;)n*=we[i++];for(n=r.modInt(n);t<i;)if(n%we[t++]==0)return!1}return r.millerRabin(e)}function C1(e){var t=this.subtract(_.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=T1(),s,a=0;a<e;++a){do s=new _(this.bitLength(),i);while(s.compareTo(_.ONE)<=0||s.compareTo(t)>=0);var o=s.modPow(n,this);if(o.compareTo(_.ONE)!=0&&o.compareTo(t)!=0){for(var f=1;f++<r&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(_.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}function T1(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}_.prototype.chunkSize=Id;_.prototype.toRadix=Rd;_.prototype.fromRadix=Ud;_.prototype.fromNumber=Nd;_.prototype.bitwiseTo=Fd;_.prototype.changeBit=Jd;_.prototype.addTo=r1;_.prototype.dMultiply=c1;_.prototype.dAddOffset=u1;_.prototype.multiplyLowerTo=d1;_.prototype.multiplyUpperTo=y1;_.prototype.modInt=S1;_.prototype.millerRabin=C1;_.prototype.clone=Ad;_.prototype.intValue=_d;_.prototype.byteValue=Cd;_.prototype.shortValue=Td;_.prototype.signum=Ld;_.prototype.toByteArray=Pd;_.prototype.equals=kd;_.prototype.min=Dd;_.prototype.max=Kd;_.prototype.and=Od;_.prototype.or=Hd;_.prototype.xor=Vd;_.prototype.andNot=qd;_.prototype.not=zd;_.prototype.shiftLeft=Gd;_.prototype.shiftRight=Wd;_.prototype.getLowestSetBit=Xd;_.prototype.bitCount=Zd;_.prototype.testBit=Qd;_.prototype.setBit=jd;_.prototype.clearBit=t1;_.prototype.flipBit=e1;_.prototype.add=n1;_.prototype.subtract=i1;_.prototype.multiply=s1;_.prototype.divide=a1;_.prototype.remainder=o1;_.prototype.divideAndRemainder=f1;_.prototype.modPow=b1;_.prototype.modInverse=B1;_.prototype.pow=p1;_.prototype.gcd=E1;_.prototype.isProbablePrime=_1});var Tc=k((Km,Cc)=>{var Pe=yt();Cr();Rt();var Ac=Cc.exports=Pe.sha1=Pe.sha1||{};Pe.md.sha1=Pe.md.algorithms.sha1=Ac;Ac.create=function(){_c||I1();var e=null,t=Pe.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=Pe.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Pe.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),Bc(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Pe.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(Ea.substr(0,n.blockLength-a));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};Bc(h,r,i);var l=Pe.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Ea=null,_c=!1;function I1(){Ea=String.fromCharCode(128),Ea+=Pe.util.fillString(String.fromCharCode(0),64),_c=!0}function Bc(e,t,r){for(var n,i,s,a,o,f,c,u,h=r.length();h>=64;){for(i=e.h0,s=e.h1,a=e.h2,o=e.h3,f=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,c=o^s&(a^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,c=o^s&(a^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s&a|o&(s^a),n=(i<<5|i>>>27)+c+f+2400959708+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+3395469782+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+a|0,e.h3=e.h3+o|0,e.h4=e.h4+f|0,h-=64}}});var Rc=k((Fm,Lc)=>{var ke=yt();Rt();kn();Tc();var Ic=Lc.exports=ke.pkcs1=ke.pkcs1||{};Ic.encode_rsa_oaep=function(e,t,r){var n,i,s,a;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=ke.md.sha1.create(),a||(a=s);var o=Math.ceil(e.n.bitLength()/8),f=o-2*s.digestLength-2;if(t.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=t.length,c.maxLength=f,c}n||(n=""),s.update(n,"raw");for(var u=s.digest(),h="",l=f-t.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+t;if(!i)i=ke.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=s.digestLength,c}var y=zi(i,o-s.digestLength-1,a),g=ke.util.xorBytes(p,y,p.length),m=zi(g,s.digestLength,a),b=ke.util.xorBytes(i,m,i.length);return"\0"+b+g};Ic.decode_rsa_oaep=function(e,t,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(e.n.bitLength()/8);if(t.length!==a){var g=new Error("RSAES-OAEP encoded message length is invalid.");throw g.length=t.length,g.expectedLength=a,g}if(i===void 0?i=ke.md.sha1.create():i.start(),s||(s=i),a<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),f=t.charAt(0),c=t.substring(1,i.digestLength+1),u=t.substring(1+i.digestLength),h=zi(u,i.digestLength,s),l=ke.util.xorBytes(c,h,c.length),d=zi(l,a-i.digestLength-1,s),p=ke.util.xorBytes(u,d,u.length),y=p.substring(0,i.digestLength),g=f!=="\0",m=0;m<i.digestLength;++m)g|=o.charAt(m)!==y.charAt(m);for(var b=1,w=i.digestLength,C=i.digestLength;C<p.length;C++){var A=p.charCodeAt(C),B=A&1^1,L=b?65534:0;g|=A&L,b=b&B,w+=b}if(g||p.charCodeAt(w)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(w+1)};function zi(e,t,r){r||(r=ke.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(e+a),n+=r.digest().getBytes()}return n.substring(0,t)}});var Uc=k((Mm,Sa)=>{var ar=yt();Rt();qi();kn();(function(){if(ar.prime){Sa.exports=ar.prime;return}var e=Sa.exports=ar.prime=ar.prime||{},t=ar.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(h,l){return h|l};e.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var y=l.prng||ar.random,g={nextBytes:function(m){for(var b=y.getBytesSync(m.length),w=0;w<m.length;++w)m[w]=b.charCodeAt(w)}};if(p.name==="PRIMEINC")return s(h,g,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?f(h,l,d,p):a(h,l,d,p)}function a(h,l,d,p){var y=c(h,l),g=0,m=u(y.bitLength());"millerRabinTests"in d&&(m=d.millerRabinTests);var b=10;"maxBlockTime"in d&&(b=d.maxBlockTime),o(y,h,l,g,m,b,p)}function o(h,l,d,p,y,g,m){var b=+new Date;do{if(h.bitLength()>l&&(h=c(l,d)),h.isProbablePrime(y))return m(null,h);h.dAddOffset(r[p++%8],0)}while(g<0||+new Date-b<g);ar.util.setImmediate(function(){o(h,l,d,p,y,g,m)})}function f(h,l,d,p){if(typeof Worker>"u")return a(h,l,d,p);var y=c(h,l),g=d.workers,m=d.workLoad||100,b=m*30/8,w=d.workerScript||"forge/prime.worker.js";if(g===-1)return ar.util.estimateCores(function(A,B){A&&(B=2),g=B-1,C()});C();function C(){g=Math.max(1,g);for(var A=[],B=0;B<g;++B)A[B]=new Worker(w);for(var L=g,B=0;B<g;++B)A[B].addEventListener("message",D);var R=!1;function D(O){if(!R){--L;var G=O.data;if(G.found){for(var z=0;z<A.length;++z)A[z].terminate();return R=!0,p(null,new t(G.prime,16))}y.bitLength()>h&&(y=c(h,l));var nt=y.toString(16);O.target.postMessage({hex:nt,workLoad:m}),y.dAddOffset(b,0)}}}}function c(h,l){var d=new t(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(t.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Wi=k((Om,Mc)=>{var F=yt();Pn();qi();Ri();Rc();Uc();kn();Rt();typeof j>"u"&&(j=F.jsbn.BigInteger);var j,Ba=F.util.isNodejs?mr():null,v=F.asn1,de=F.util;F.pki=F.pki||{};Mc.exports=F.pki.rsa=F.rsa=F.rsa||{};var q=F.pki,L1=[6,4,2,4,2,4,6,2],R1={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},U1={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},N1={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},P1=F.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},k1={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},D1=function(e){var t;if(e.algorithm in q.oids)t=q.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=v.oidToDer(t).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),s=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);s.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),s.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var a=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(a),v.toDer(i).getBytes()},Kc=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(j.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(j.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new j(F.util.bytesToHex(F.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(j.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);var a=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return a=a.multiply(n.modInverse(t.n)).mod(t.n),a};q.rsa.encrypt=function(e,t,r){var n=r,i,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Fc(e,t,r)):(i=F.util.createBuffer(),i.putBytes(e));for(var a=new j(i.toHex(),16),o=Kc(a,t,n),f=o.toString(16),c=F.util.createBuffer(),u=s-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(F.util.hexToBytes(f)),c.getBytes()};q.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=i,s}var a=new j(F.util.createBuffer(e).toHex(),16);if(a.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=Kc(a,t,r),f=o.toString(16),c=F.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(F.util.hexToBytes(f)),n!==!1?Gi(c.getBytes(),t,r):c.getBytes()};q.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||F.random,i={nextBytes:function(o){for(var f=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=f.charCodeAt(c)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new j(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};q.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new j(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,a,o=0;e.keys===null&&(t<=0||o<t);){if(e.state===0){var f=e.p===null?e.pBits:e.qBits,c=f-1;e.pqState===0?(e.num=new j(f,e.rng),e.num.testBit(c)||e.num.bitwiseTo(j.ONE.shiftLeft(c),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>f?e.pqState=0:e.num.isProbablePrime(F1(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(L1[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(j.ONE).gcd(e.e).compareTo(j.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(j.ONE),e.q1=e.q.subtract(j.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(j.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var u=e.e.modInverse(e.phi);e.keys={privateKey:q.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:q.rsa.setPublicKey(e.n,e.e)}}a=+new Date,o+=a-s,s=a}return e.keys!==null};q.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!F.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(Nc("generateKeyPair"))return Ba.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,c){if(o)return n(o);n(null,{privateKey:q.privateKeyFromPem(c),publicKey:q.publicKeyFromPem(f)})});if(Pc("generateKey")&&Pc("exportKey"))return de.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Dc(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return de.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var f=q.privateKeyFromAsn1(v.fromDer(F.util.createBuffer(o)));n(null,{privateKey:f,publicKey:q.setRsaPublicKey(f.n,f.e)})}});if(kc("generateKey")&&kc("exportKey")){var i=de.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Dc(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var f=o.target.result,c=de.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=q.privateKeyFromAsn1(v.fromDer(F.util.createBuffer(h)));n(null,{privateKey:l,publicKey:q.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(Nc("generateKeyPairSync")){var s=Ba.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:q.privateKeyFromPem(s.privateKey),publicKey:q.publicKeyFromPem(s.publicKey)}}}var a=q.rsa.createKeyPairGenerationState(e,t,r);if(!n)return q.rsa.stepKeyPairGenerationState(a,0),a.keys;K1(a,r,n)};q.setRsaPublicKey=q.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,f,c){return Fc(o,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,f){return F.pkcs1.encode_rsa_oaep(f,o,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var a=i.encode(n,r,!0);return q.rsa.encrypt(a,r,!0)},r.verify=function(n,i,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(f,c){c=Gi(c,r,!0);var u=v.fromDer(c,{parseAllBytes:a._parseAllDigestBytes}),h={},l=[];if(!v.validate(u,k1,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=v.derToOid(h.algorithmIdentifier);if(!(p===F.oids.md2||p===F.oids.md5||p===F.oids.sha1||p===F.oids.sha224||p===F.oids.sha256||p===F.oids.sha384||p===F.oids.sha512||p===F.oids["sha512-224"]||p===F.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===F.oids.md2||p===F.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(f,c){return c=Gi(c,r,!0),f===c}});var o=q.rsa.decrypt(i,r,!0,!1);return s.verify(n,o,r.n.bitLength())},r};q.setRsaPrivateKey=q.rsa.setPrivateKey=function(e,t,r,n,i,s,a,o){var f={n:e,e:t,d:r,p:n,q:i,dP:s,dQ:a,qInv:o};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=q.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Gi};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return F.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:D1},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return q.rsa.encrypt(l,f,h)},f};q.wrapRsaPrivateKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(q.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(e).getBytes())])};q.privateKeyFromAsn1=function(e){var t={},r=[];if(v.validate(e,R1,t,r)&&(e=v.fromDer(F.util.createBuffer(t.privateKey))),t={},r=[],!v.validate(e,U1,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,a,o,f,c,u,h;return i=F.util.createBuffer(t.privateKeyModulus).toHex(),s=F.util.createBuffer(t.privateKeyPublicExponent).toHex(),a=F.util.createBuffer(t.privateKeyPrivateExponent).toHex(),o=F.util.createBuffer(t.privateKeyPrime1).toHex(),f=F.util.createBuffer(t.privateKeyPrime2).toHex(),c=F.util.createBuffer(t.privateKeyExponent1).toHex(),u=F.util.createBuffer(t.privateKeyExponent2).toHex(),h=F.util.createBuffer(t.privateKeyCoefficient).toHex(),q.setRsaPrivateKey(new j(i,16),new j(s,16),new j(a,16),new j(o,16),new j(f,16),new j(c,16),new j(u,16),new j(h,16))};q.privateKeyToAsn1=q.privateKeyToRSAPrivateKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.qInv))])};q.publicKeyFromAsn1=function(e){var t={},r=[];if(v.validate(e,P1,t,r)){var n=v.derToOid(t.publicKeyOid);if(n!==q.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!v.validate(e,N1,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=F.util.createBuffer(t.publicKeyModulus).toHex(),a=F.util.createBuffer(t.publicKeyExponent).toHex();return q.setRsaPublicKey(new j(s,16),new j(a,16))};q.publicKeyToAsn1=q.publicKeyToSubjectPublicKeyInfo=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(q.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[q.publicKeyToRSAPublicKey(e)])])};q.publicKeyToRSAPublicKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,De(e.e))])};function Fc(e,t,r){var n=F.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var a=i-3-e.length,o;if(r===0||r===1){o=r===0?0:255;for(var f=0;f<a;++f)n.putByte(o)}else for(;a>0;){for(var c=0,u=F.random.getBytes(a),f=0;f<a;++f)o=u.charCodeAt(f),o===0?++c:n.putByte(o);a=c}return n.putByte(0),n.putBytes(e),n}function Gi(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),s=F.util.createBuffer(e),a=s.getByte(),o=s.getByte();if(a!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=i-3-n;for(var c=0;c<f;++c)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++f}else if(o===2)for(f=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++f}var u=s.getByte();if(u!==0||f!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function K1(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){s(e.pBits,function(o,f){if(o)return r(o);if(e.p=f,e.q!==null)return a(o,e.q);s(e.qBits,a)})}function s(o,f){F.prime.generateProbablePrime(o,n,f)}function a(o,f){if(o)return r(o);if(e.q=f,e.p.compareTo(e.q)<0){var c=e.p;e.p=e.q,e.q=c}if(e.p.subtract(j.ONE).gcd(e.e).compareTo(j.ONE)!==0){e.p=null,i();return}if(e.q.subtract(j.ONE).gcd(e.e).compareTo(j.ONE)!==0){e.q=null,s(e.qBits,a);return}if(e.p1=e.p.subtract(j.ONE),e.q1=e.q.subtract(j.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(j.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,s(e.qBits,a);return}var u=e.e.modInverse(e.phi);e.keys={privateKey:q.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:q.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function De(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=F.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function F1(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function Nc(e){return F.util.isNodejs&&typeof Ba[e]=="function"}function Pc(e){return typeof de.globalScope<"u"&&typeof de.globalScope.crypto=="object"&&typeof de.globalScope.crypto.subtle=="object"&&typeof de.globalScope.crypto.subtle[e]=="function"}function kc(e){return typeof de.globalScope<"u"&&typeof de.globalScope.msCrypto=="object"&&typeof de.globalScope.msCrypto.subtle=="object"&&typeof de.globalScope.msCrypto.subtle[e]=="function"}function Dc(e){for(var t=F.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var Gc=k((Hm,zc)=>{var N=yt();ya();Pn();$f();Cr();Ri();tc();nc();kn();yc();Wi();Rt();typeof Oc>"u"&&(Oc=N.jsbn.BigInteger);var Oc,E=N.asn1,W=N.pki=N.pki||{};zc.exports=W.pbe=N.pbe=N.pbe||{};var Lr=W.oids,M1={name:"EncryptedPrivateKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},O1={name:"PBES2Algorithms",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},H1={name:"pkcs-12PbeParams",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"iterations"}]};W.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=N.random.getBytesSync(r.saltSize),i=r.count,s=E.integerToDer(i),a,o,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":a=16,c=16,u=Lr["aes128-CBC"],h=N.aes.createEncryptionCipher;break;case"aes192":a=24,c=16,u=Lr["aes192-CBC"],h=N.aes.createEncryptionCipher;break;case"aes256":a=32,c=16,u=Lr["aes256-CBC"],h=N.aes.createEncryptionCipher;break;case"des":a=8,c=8,u=Lr.desCBC,h=N.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=qc(d),y=N.pkcs5.pbkdf2(t,n,i,a,p),g=N.random.getBytesSync(c),m=h(y);m.start(g),m.update(E.toDer(e)),m.finish(),f=m.output.getBytes();var b=V1(n,s,a,d);o=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Lr.pkcs5PBES2).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Lr.pkcs5PBKDF2).getBytes()),b]),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(u).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,g)])])])}else if(r.algorithm==="3des"){a=24;var w=new N.util.ByteBuffer(n),y=W.pbe.generatePkcs12Key(t,w,1,i,a),g=W.pbe.generatePkcs12Key(t,w,2,i,a),m=N.des.createEncryptionCipher(y);m.start(g),m.update(E.toDer(e)),m.finish(),f=m.output.getBytes(),o=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Lr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,n),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var C=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[o,E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,f)]);return C};W.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!E.validate(e,M1,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=E.derToOid(n.encryptionOid),o=W.pbe.getCipher(a,n.encryptionParams,t),f=N.util.createBuffer(n.encryptedData);return o.update(f),o.finish()&&(r=E.fromDer(o.output)),r};W.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:E.toDer(e).getBytes()};return N.pem.encode(r,{maxline:t})};W.encryptedPrivateKeyFromPem=function(e){var t=N.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return E.fromDer(t.body)};W.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=W.wrapRsaPrivateKey(W.privateKeyToAsn1(e));return n=W.encryptPrivateKeyInfo(n,t,r),W.encryptedPrivateKeyToPem(n)}var i,s,a,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",a=16,s=N.random.getBytesSync(16),o=N.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",a=24,s=N.random.getBytesSync(16),o=N.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",a=32,s=N.random.getBytesSync(16),o=N.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",a=24,s=N.random.getBytesSync(8),o=N.des.createEncryptionCipher;break;case"des":i="DES-CBC",a=8,s=N.random.getBytesSync(8),o=N.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=N.pbe.opensslDeriveBytes(t,s.substr(0,8),a),u=o(c);u.start(s),u.update(E.toDer(W.privateKeyToAsn1(e))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:N.util.bytesToHex(s).toUpperCase()},body:u.output.getBytes()};return N.pem.encode(h)};W.decryptRsaPrivateKey=function(e,t){var r=null,n=N.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,a;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,a=N.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=N.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=N.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=N.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=N.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(h){return N.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,a=function(h){return N.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,a=function(h){return N.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=N.util.hexToBytes(n.dekInfo.parameters),f=N.pbe.opensslDeriveBytes(t,o.substr(0,8),s),c=a(f);if(c.start(o),c.update(N.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=W.decryptPrivateKeyInfo(E.fromDer(r),t):r=E.fromDer(r),r!==null&&(r=W.privateKeyFromAsn1(r)),r};W.pbe.generatePkcs12Key=function(e,t,r,n,i,s){var a,o;if(typeof s>"u"||s===null){if(!("sha1"in N.md))throw new Error('"sha1" hash algorithm unavailable.');s=N.md.sha1.create()}var f=s.digestLength,c=s.blockLength,u=new N.util.ByteBuffer,h=new N.util.ByteBuffer;if(e!=null){for(o=0;o<e.length;o++)h.putInt16(e.charCodeAt(o));h.putInt16(0)}var l=h.length(),d=t.length(),p=new N.util.ByteBuffer;p.fillWithByte(r,c);var y=c*Math.ceil(d/c),g=new N.util.ByteBuffer;for(o=0;o<y;o++)g.putByte(t.at(o%d));var m=c*Math.ceil(l/c),b=new N.util.ByteBuffer;for(o=0;o<m;o++)b.putByte(h.at(o%l));var w=g;w.putBuffer(b);for(var C=Math.ceil(i/f),A=1;A<=C;A++){var B=new N.util.ByteBuffer;B.putBytes(p.bytes()),B.putBytes(w.bytes());for(var L=0;L<n;L++)s.start(),s.update(B.getBytes()),B=s.digest();var R=new N.util.ByteBuffer;for(o=0;o<c;o++)R.putByte(B.at(o%f));var D=Math.ceil(d/c)+Math.ceil(l/c),O=new N.util.ByteBuffer;for(a=0;a<D;a++){var G=new N.util.ByteBuffer(w.getBytes(c)),z=511;for(o=R.length()-1;o>=0;o--)z=z>>8,z+=R.at(o)+G.at(o),G.setAt(o,z&255);O.putBuffer(G)}w=O,u.putBuffer(B)}return u.truncate(u.length()-i),u};W.pbe.getCipher=function(e,t,r){switch(e){case W.oids.pkcs5PBES2:return W.pbe.getCipherForPBES2(e,t,r);case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case W.oids["pbewithSHAAnd40BitRC2-CBC"]:return W.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};W.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!E.validate(t,O1,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(e=E.derToOid(n.kdfOid),e!==W.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=e,s.supportedOids=["pkcs5PBKDF2"],s}if(e=E.derToOid(n.encOid),e!==W.oids["aes128-CBC"]&&e!==W.oids["aes192-CBC"]&&e!==W.oids["aes256-CBC"]&&e!==W.oids["des-EDE3-CBC"]&&e!==W.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=n.kdfSalt,o=N.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var f,c;switch(W.oids[e]){case"aes128-CBC":f=16,c=N.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=N.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=N.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=N.des.createDecryptionCipher;break;case"desCBC":f=8,c=N.des.createDecryptionCipher;break}var u=Vc(n.prfOid),h=N.pkcs5.pbkdf2(r,a,o,f,u),l=n.encIv,d=c(h);return d.start(l),d};W.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!E.validate(t,H1,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=N.util.createBuffer(n.salt),o=N.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var f,c,u;switch(e){case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=N.des.startDecrypting;break;case W.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(y,g){var m=N.rc2.createDecryptionCipher(y,40);return m.start(g,null),m};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=e,s}var h=Vc(n.prfOid),l=W.pbe.generatePkcs12Key(r,a,1,o,f,h);h.start();var d=W.pbe.generatePkcs12Key(r,a,2,o,c,h);return u(l,d)};W.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in N.md))throw new Error('"md5" hash algorithm unavailable.');n=N.md.md5.create()}t===null&&(t="");for(var i=[Hc(n,e+t)],s=16,a=1;s<r;++a,s+=16)i.push(Hc(n,i[a-1]+e+t));return i.join("").substr(0,r)};function Hc(e,t){return e.start().update(t).digest().getBytes()}function Vc(e){var t;if(!e)t="hmacWithSHA1";else if(t=W.oids[E.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return qc(t)}function qc(e){var t=N.md;switch(e){case"hmacWithSHA224":t=N.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function V1(e,t,r,n){var i=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,e),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,N.util.hexToBytes(r.toString(16))),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(W.oids[n]).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])),i}});var mu=k((ow,xu)=>{var vt=yt();Cr();Rt();var Hn=xu.exports=vt.sha512=vt.sha512||{};vt.md.sha512=vt.md.algorithms.sha512=Hn;var yu=vt.sha384=vt.sha512.sha384=vt.sha512.sha384||{};yu.create=function(){return Hn.create("SHA-384")};vt.md.sha384=vt.md.algorithms.sha384=yu;vt.sha512.sha256=vt.sha512.sha256||{create:function(){return Hn.create("SHA-512/256")}};vt.md["sha512/256"]=vt.md.algorithms["sha512/256"]=vt.sha512.sha256;vt.sha512.sha224=vt.sha512.sha224||{create:function(){return Hn.create("SHA-512/224")}};vt.md["sha512/224"]=vt.md.algorithms["sha512/224"]=vt.sha512.sha224;Hn.create=function(e){if(gu||t2(),typeof e>"u"&&(e="SHA-512"),!(e in Rr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=Rr[e],r=null,n=vt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var a=64;switch(e){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var o={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,c=0;c<f;++c)o.fullMessageLength.push(0);n=vt.util.createBuffer(),r=new Array(t.length);for(var c=0;c<t.length;++c)r[c]=t[c].slice(0);return o},o.start(),o.update=function(f,c){c==="utf8"&&(f=vt.util.encodeUtf8(f));var u=f.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),du(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var f=vt.util.createBuffer();f.putBytes(n.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=c&o.blockLength-1;f.putBytes(Ya.substr(0,o.blockLength-u));for(var h,l,d=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var y=new Array(r.length),p=0;p<r.length;++p)y[p]=r[p].slice(0);du(y,i,f);var g=vt.util.createBuffer(),m;e==="SHA-512"?m=y.length:e==="SHA-384"?m=y.length-2:m=y.length-4;for(var p=0;p<m;++p)g.putInt32(y[p][0]),(p!==m-1||e!=="SHA-512/224")&&g.putInt32(y[p][1]);return g},o};var Ya=null,gu=!1,Xa=null,Rr=null;function t2(){Ya=String.fromCharCode(128),Ya+=vt.util.fillString(String.fromCharCode(0),128),Xa=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Rr={},Rr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Rr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Rr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Rr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],gu=!0}function du(e,t,r){for(var n,i,s,a,o,f,c,u,h,l,d,p,y,g,m,b,w,C,A,B,L,R,D,O,G,z,nt,pt,M,V,S,H,gt,Z,Q,J=r.length();J>=128;){for(M=0;M<16;++M)t[M][0]=r.getInt32()>>>0,t[M][1]=r.getInt32()>>>0;for(;M<80;++M)H=t[M-2],V=H[0],S=H[1],n=((V>>>19|S<<13)^(S>>>29|V<<3)^V>>>6)>>>0,i=((V<<13|S>>>19)^(S<<3|V>>>29)^(V<<26|S>>>6))>>>0,Z=t[M-15],V=Z[0],S=Z[1],s=((V>>>1|S<<31)^(V>>>8|S<<24)^V>>>7)>>>0,a=((V<<31|S>>>1)^(V<<24|S>>>8)^(V<<25|S>>>7))>>>0,gt=t[M-7],Q=t[M-16],S=i+gt[1]+a+Q[1],t[M][0]=n+gt[0]+s+Q[0]+(S/4294967296>>>0)>>>0,t[M][1]=S>>>0;for(y=e[0][0],g=e[0][1],m=e[1][0],b=e[1][1],w=e[2][0],C=e[2][1],A=e[3][0],B=e[3][1],L=e[4][0],R=e[4][1],D=e[5][0],O=e[5][1],G=e[6][0],z=e[6][1],nt=e[7][0],pt=e[7][1],M=0;M<80;++M)c=((L>>>14|R<<18)^(L>>>18|R<<14)^(R>>>9|L<<23))>>>0,u=((L<<18|R>>>14)^(L<<14|R>>>18)^(R<<23|L>>>9))>>>0,h=(G^L&(D^G))>>>0,l=(z^R&(O^z))>>>0,o=((y>>>28|g<<4)^(g>>>2|y<<30)^(g>>>7|y<<25))>>>0,f=((y<<4|g>>>28)^(g<<30|y>>>2)^(g<<25|y>>>7))>>>0,d=(y&m|w&(y^m))>>>0,p=(g&b|C&(g^b))>>>0,S=pt+u+l+Xa[M][1]+t[M][1],n=nt+c+h+Xa[M][0]+t[M][0]+(S/4294967296>>>0)>>>0,i=S>>>0,S=f+p,s=o+d+(S/4294967296>>>0)>>>0,a=S>>>0,nt=G,pt=z,G=D,z=O,D=L,O=R,S=B+i,L=A+n+(S/4294967296>>>0)>>>0,R=S>>>0,A=w,B=C,w=m,C=b,m=y,b=g,S=i+a,y=n+s+(S/4294967296>>>0)>>>0,g=S>>>0;S=e[0][1]+g,e[0][0]=e[0][0]+y+(S/4294967296>>>0)>>>0,e[0][1]=S>>>0,S=e[1][1]+b,e[1][0]=e[1][0]+m+(S/4294967296>>>0)>>>0,e[1][1]=S>>>0,S=e[2][1]+C,e[2][0]=e[2][0]+w+(S/4294967296>>>0)>>>0,e[2][1]=S>>>0,S=e[3][1]+B,e[3][0]=e[3][0]+A+(S/4294967296>>>0)>>>0,e[3][1]=S>>>0,S=e[4][1]+R,e[4][0]=e[4][0]+L+(S/4294967296>>>0)>>>0,e[4][1]=S>>>0,S=e[5][1]+O,e[5][0]=e[5][0]+D+(S/4294967296>>>0)>>>0,e[5][1]=S>>>0,S=e[6][1]+z,e[6][0]=e[6][0]+G+(S/4294967296>>>0)>>>0,e[6][1]=S>>>0,S=e[7][1]+pt,e[7][0]=e[7][0]+nt+(S/4294967296>>>0)>>>0,e[7][1]=S>>>0,J-=128}}});var wh=k((Cb,vh)=>{var xn=1e3,mn=xn*60,vn=mn*60,Kr=vn*24,ng=Kr*7,ig=Kr*365.25;vh.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return sg(e);if(r==="number"&&isFinite(e))return t.long?og(e):ag(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function sg(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!!t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*ig;case"weeks":case"week":case"w":return r*ng;case"days":case"day":case"d":return r*Kr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*vn;case"minutes":case"minute":case"mins":case"min":case"m":return r*mn;case"seconds":case"second":case"secs":case"sec":case"s":return r*xn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function ag(e){var t=Math.abs(e);return t>=Kr?Math.round(e/Kr)+"d":t>=vn?Math.round(e/vn)+"h":t>=mn?Math.round(e/mn)+"m":t>=xn?Math.round(e/xn)+"s":e+"ms"}function og(e){var t=Math.abs(e);return t>=Kr?os(e,t,Kr,"day"):t>=vn?os(e,t,vn,"hour"):t>=mn?os(e,t,mn,"minute"):t>=xn?os(e,t,xn,"second"):e+" ms"}function os(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}});var Eh=k((Tb,bh)=>{function fg(e){r.debug=r,r.default=r,r.coerce=f,r.disable=s,r.enable=i,r.enabled=a,r.humanize=wh(),r.destroy=c,Object.keys(e).forEach(u=>{r[u]=e[u]}),r.names=[],r.skips=[],r.formatters={};function t(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=t;function r(u){let h,l=null,d,p;function y(...g){if(!y.enabled)return;let m=y,b=Number(new Date),w=b-(h||b);m.diff=w,m.prev=h,m.curr=b,h=b,g[0]=r.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let C=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(B,L)=>{if(B==="%%")return"%";C++;let R=r.formatters[L];if(typeof R=="function"){let D=g[C];B=R.call(m,D),g.splice(C,1),C--}return B}),r.formatArgs.call(m,g),(m.log||r.log).apply(m,g)}return y.namespace=u,y.useColors=r.useColors(),y.color=r.selectColor(u),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(u)),p),set:g=>{l=g}}),typeof r.init=="function"&&r.init(y),y}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)!l[h]||(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function s(){let u=[...r.names.map(o),...r.skips.map(o).map(h=>"-"+h)].join(",");return r.enable(""),u}function a(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function o(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function f(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}bh.exports=fg});var Sh=k((he,fs)=>{he.formatArgs=ug;he.save=hg;he.load=lg;he.useColors=cg;he.storage=pg();he.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();he.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function cg(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function ug(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+fs.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),e.splice(n,0,t)}he.log=console.debug||console.log||(()=>{});function hg(e){try{e?he.storage.setItem("debug",e):he.storage.removeItem("debug")}catch{}}function lg(){let e;try{e=he.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function pg(){try{return localStorage}catch{}}fs.exports=Eh()(he);var{formatters:dg}=fs.exports;dg.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var xg={};Ot(xg,{noise:()=>gg,stablelib:()=>Ks});function je(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function He(e=0){return globalThis.Buffer?.alloc!=null?je(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function Se(e=0){return globalThis.Buffer?.allocUnsafe!=null?je(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Ut(e,t){t==null&&(t=e.reduce((i,s)=>i+s.length,0));let r=Se(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return je(r)}function Nt(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var Io=Symbol.for("@achingbrain/uint8arraylist");function To(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let i=r+n.byteLength;if(t<i)return{buf:n,index:t-r};r=i}throw new RangeError("index is out of bounds")}function ds(e){return Boolean(e?.[Io])}var re=class{constructor(...t){Object.defineProperty(this,Io,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(ds(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(ds(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=To(this.bufs,t);return r.buf[r.index]}set(t,r){let n=To(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(ds(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0))for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}slice(t,r){let{bufs:n,length:i}=this._subList(t,r);return Ut(n,i)}subarray(t,r){let{bufs:n,length:i}=this._subList(t,r);return n.length===1?n[0]:Ut(n,i)}sublist(t,r){let{bufs:n,length:i}=this._subList(t,r),s=new re;return s.length=i,s.bufs=n,s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let a=this.bufs[s],o=i,f=o+a.byteLength;if(i=f,t>=f)continue;let c=t>=o&&t<f,u=r>o&&r<=f;if(c&&u){if(t===o&&r===f){n.push(a);break}let h=t-o;n.push(a.subarray(h,h+(r-t)));break}if(c){if(t===0){n.push(a);continue}n.push(a.subarray(t-o));continue}if(u){if(r===f){n.push(a);break}n.push(a.subarray(0,r-o));break}n.push(a)}return{bufs:n,length:r-t}}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=Se(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let i=He(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let i=He(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let i=He(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=Se(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let i=He(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let i=He(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let i=He(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let i=He(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let i=He(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof re)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Nt(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new re;return n.bufs=t,r==null&&(r=t.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function Lo(e){let t=async function*(){let r=yield,n=new re;for await(let i of e){if(r==null){n.append(i),r=yield n,n=new re;continue}for(n.append(i);n.length>=r;){let s=n.sublist(0,r);if(n.consume(r),r=yield s,r==null){n.length>0&&(r=yield n,n=new re);break}}}if(r!=null)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return t.next(),t}var si=class{constructor(t){if(!(t>0)||(t-1&t)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){let t=this.buffer[this.btm];if(t!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return this.buffer[this.btm]===void 0}},Fr=class{constructor(t={}){this.hwm=t.splitLimit??16,this.head=new si(this.hwm),this.tail=this.head,this.size=0}calculateSize(t){return t?.byteLength!=null?t.byteLength:1}push(t){if(t?.value!=null&&(this.size+=this.calculateSize(t.value)),!this.head.push(t)){let r=this.head;this.head=r.next=new si(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(t===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,t=this.tail.shift()}return t?.value!=null&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}};function ai(e={}){return kh(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},e)}function kh(e,t){t=t??{};let r=t.onEnd,n=new Fr,i,s,a,o=async()=>n.isEmpty()?a?{done:!0}:await new Promise((y,g)=>{s=m=>{s=null,n.push(m);try{y(e(n))}catch(b){g(b)}return i}}):e(n),f=y=>s!=null?s(y):(n.push(y),i),c=y=>(n=new Fr,s!=null?s({error:y}):(n.push({error:y}),i)),u=y=>{if(a)return i;if(t?.objectMode!==!0&&y?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return f({done:!1,value:y})},h=y=>a?i:(a=!0,y!=null?c(y):f({done:!0})),l=()=>(n=new Fr,h(),{done:!0}),d=y=>(h(y),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:l,throw:d,push:u,end:h,get readableLength(){return n.size}},r==null)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(y){return p.throw(y),r!=null&&(r(y),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:u,end(y){return p.end(y),r!=null&&(r(y),r=void 0),i},get readableLength(){return p.readableLength}},i}function wn(){let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}function Ro(e){let t=ai(),r=Lo(e.source),n=wn(),i,s=e.sink(async function*(){yield*t,yield*await n.promise}());return s.catch(o=>{i=o}),{reader:r,writer:t,stream:{sink:async o=>i!=null?await Promise.reject(i):(n.resolve(o),await s),source:r},rest:()=>t.end(),write:t.push,read:async()=>{let o=await r.next();if(o.value!=null)return o.value}}}function oi(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}var Uo=4294967296,ae=class{constructor(t=0,r=0){this.hi=t,this.lo=r}toBigInt(t){if(t===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(t){return Number(this.toBigInt(t))}zzDecode(){let t=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^t)>>>0,n=(this.hi>>>1^t)>>>0;return new ae(n,r)}zzEncode(){let t=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^t)>>>0,n=(this.lo<<1^t)>>>0;return new ae(r,n)}toBytes(t,r=0){let n=oi(t);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(t){if(t===0n)return new ae;let r=t<0;r&&(t=-t);let n=Number(t>>32n)|0,i=Number(t-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>Uo&&(i=0,++n>Uo&&(n=0))),new ae(n,i)}static fromNumber(t){if(t===0)return new ae;let r=t<0;r&&(t=-t);let n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new ae(i,n)}static fromBytes(t,r=0){let n=oi(t),i=new ae,s=0;if(t.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else for(;s<4;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}if(t.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else if(r<t.byteLength)for(;s<5;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var Dh=Math.pow(2,7),Kh=Math.pow(2,14),Fh=Math.pow(2,21),Mh=Math.pow(2,28),Oh=Math.pow(2,35),Hh=Math.pow(2,42),Vh=Math.pow(2,49),qh=Math.pow(2,56),zh=Math.pow(2,63),yr={encodingLength(e){return e<Dh?1:e<Kh?2:e<Fh?3:e<Mh?4:e<Oh?5:e<Hh?6:e<Vh?7:e<qh?8:e<zh?9:10},encode(e,t,r=0){if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return t==null&&(t=Se(yr.encodingLength(e))),ae.fromNumber(e).toBytes(t,r),t},decode(e,t=0){return ae.fromBytes(e,t).toNumber(!0)}};function No(e){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}var fi=e=>{let t=yr.encodingLength(e),r=No(t);return yr.encode(e,r),fi.bytes=t,r};fi.bytes=0;function ci(e){e=e??{};let t=e.lengthEncoder??fi;return async function*(n){for await(let i of n){let s=t(i.byteLength);s instanceof Uint8Array?yield s:yield*s,i instanceof Uint8Array?yield i:yield*i}}}ci.single=(e,t)=>{t=t??{};let r=t.lengthEncoder??fi;return new re(r(e.byteLength),e)};var bn=Y(oe(),1),Wh=8,Yh=1024*1024*4,gr;(function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"})(gr||(gr={}));var ys=e=>{let t=yr.decode(e);return ys.bytes=yr.encodingLength(t),t};ys.bytes=0;function xr(e){return async function*(r){let n=new re,i=gr.LENGTH,s=-1,a=e?.lengthDecoder??ys,o=e?.maxLengthLength??Wh,f=e?.maxDataLength??Yh;for await(let c of r)for(n.append(c);n.byteLength>0;){if(i===gr.LENGTH)try{if(s=a(n),s<0)throw(0,bn.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(s>f)throw(0,bn.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=a.bytes;n.consume(u),e?.onLength!=null&&e.onLength(s),i=gr.DATA}catch(u){if(u instanceof RangeError){if(n.byteLength>o)throw(0,bn.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(i===gr.DATA){if(n.byteLength<s)break;let u=n.sublist(0,s);n.consume(s),e?.onData!=null&&e.onData(u),yield u,i=gr.LENGTH}}if(n.byteLength>0)throw(0,bn.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}xr.fromReader=(e,t)=>{let r=1,n=async function*(){for(;;)try{let{done:s,value:a}=await e.next(r);if(s===!0)return;a!=null&&(yield a)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}();return xr({...t??{},onLength:s=>{r=s}})(n)};function gs(e,t={}){let r=Ro(e),n=xr.fromReader(r.reader,t),i={read:async s=>{let{value:a}=await r.reader.next(s);if(a==null)throw new Error("Value is null");return a},readLP:async()=>{let{value:s}=await n.next();if(s==null)throw new Error("Value is null");return s},readPB:async s=>{let a=await i.readLP();if(a==null)throw new Error("Value is null");let o=a instanceof Uint8Array?a:a.slice();return s.decode(o)},write:s=>{s instanceof Uint8Array?r.writer.push(s):r.writer.push(s.slice())},writeLP:s=>{i.write(ci.single(s,t))},writePB:(s,a)=>{i.writeLP(a.encode(s))},pb:s=>({read:async()=>await i.readPB(s),write:a=>i.writePB(a,s)}),unwrap:()=>(r.rest(),r.stream)};return i}function xs(){let e=wn(),t=!1;return{sink:async r=>{if(t)throw new Error("already piped");t=!0,e.resolve(r)},source:async function*(){yield*await e.promise}()}}function Do(){let e=xs(),t=xs();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}var Wo=Y(Go(),1),Qh=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},Yo=e=>e!=null&&(typeof e[Symbol.asyncIterator]=="function"||typeof e[Symbol.iterator]=="function"||typeof e.next=="function"),vs=e=>e!=null&&typeof e.sink=="function"&&Yo(e.source),Jh=e=>t=>{let r=e.sink(t);if(r.then!=null){let n=ai({objectMode:!0});return r.then(()=>{n.end()},s=>{n.end(s)}),(0,Wo.default)(n,async function*(){yield*e.source,n.end()}())}return e.source};function Xo(e,...t){if(vs(e)){let n=e;e=()=>n.source}else if(Yo(e)){let n=e;e=()=>n}let r=[e,...t];if(r.length>1&&vs(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)vs(r[n])&&(r[n]=Jh(r[n]));return Qh(...r)}var $o=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);var I0=Y(r0(),1),Or=Y(w0(),1),Si=Y(E0(),1),Ds=Y(ks(),1),Ks={hashSHA256(e){return(0,Si.hash)(e)},getHKDF(e,t){let i=new I0.HKDF(Si.SHA256,t,e).expand(96),s=i.subarray(0,32),a=i.subarray(32,64),o=i.subarray(64,96);return[s,a,o]},generateX25519KeyPair(){let e=Or.generateKeyPair();return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519KeyPairFromSeed(e){let t=Or.generateKeyPairFromSeed(e);return{publicKey:t.publicKey,privateKey:t.secretKey}},generateX25519SharedKey(e,t){return Or.sharedKey(e,t)},chaCha20Poly1305Encrypt(e,t,r,n){return new Ds.ChaCha20Poly1305(n).seal(t,e,r)},chaCha20Poly1305Decrypt(e,t,r,n,i){return new Ds.ChaCha20Poly1305(n).open(t,e,r,i)}};var Fs=Y(ks(),1);var op=e=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e),Hr=e=>{let t=op(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};Hr.bytes=2;var Cn=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};Cn.bytes=2;function L0(e){return Ut([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}function R0(e){return Ut([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}function U0(e){return Ut([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}function N0(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}function P0(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}function k0(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}function K0(e,t){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65519){let s=i+65519;s>n.length&&(s=n.length);let a=e.encrypt(n.subarray(i,s),e.session);t?.encryptedPackets.increment(),yield Hr(a.byteLength),yield a}}}function F0(e,t){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65535){let s=i+65535;if(s>n.length&&(s=n.length),s-Fs.TAG_LENGTH<i)throw new Error("Invalid chunk");let a=n.subarray(i,s),o=n.subarray(i,s-Fs.TAG_LENGTH),{plaintext:f,valid:c}=e.decrypt(a,e.session,o);if(!c)throw t?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");t?.decryptedPackets.increment(),yield f}}}var vr=class extends Error{constructor(t="Unexpected Peer"){super(t),this.code=vr.code}static get code(){return"ERR_UNEXPECTED_PEER"}},Ge=class extends Error{constructor(t="Invalid crypto exchange"){super(t),this.code=Ge.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}};var Qs=Y(qs(),1),_f=Y(mf(),1),Js=Y(Zs(),1),Cf=Y(Af(),1),Tf=Y(br(),1);function gp(){Tf.default._configure(),Qs.default._configure(_f.default),Js.default._configure(Cf.default)}gp();var If=["uint64","int64","sint64","fixed64","sfixed64"];function xp(e){for(let t of If){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function js(e){return xp(new Qs.default(e))}function mp(e){for(let t of If){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function ta(){return mp(Js.default.create())}function Sr(e,t){let r=js(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function Br(e,t){let r=ta();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var qr;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(qr||(qr={}));function Ti(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function ea(e){function t(i){if(e[i.toString()]==null)throw new Error("Invalid enum value");return e[i]}let r=function(s,a){let o=t(s);a.int32(o)},n=function(s){let a=s.int32();return t(a)};return Ti("enum",qr.VARINT,r,n)}function Ar(e,t){return Ti("message",qr.LENGTH_DELIMITED,e,t)}var bt;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(bt||(bt={}));var ra;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(ra||(ra={}));(function(e){e.codec=()=>ea(ra)})(bt||(bt={}));var Ie;(function(e){let t;e.codec=()=>(t==null&&(t=Ar((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),bt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=bt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>Br(r,e.codec()),e.decode=r=>Sr(r,e.codec())})(Ie||(Ie={}));var Le;(function(e){let t;e.codec=()=>(t==null&&(t=Ar((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),bt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=bt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>Br(r,e.codec()),e.decode=r=>Sr(r,e.codec())})(Le||(Le={}));var zw=Y(Pn(),1),Gw=Y(Gc(),1),Z2=Y(yt(),1),uh=Y(oe(),1);var Ia={};Ot(Ia,{identity:()=>X1});function q1(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var o=e.length,f=e.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,g=0,m=0,b=p.length;m!==b&&p[m]===0;)m++,y++;for(var w=(b-m)*u+1>>>0,C=new Uint8Array(w);m!==b;){for(var A=p[m],B=0,L=w-1;(A!==0||B<g)&&L!==-1;L--,B++)A+=256*C[L]>>>0,C[L]=A%o>>>0,A=A/o>>>0;if(A!==0)throw new Error("Non-zero carry");g=B,m++}for(var R=w-g;R!==w&&C[R]===0;)R++;for(var D=f.repeat(y);R<w;++R)D+=e.charAt(C[R]);return D}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var g=0,m=0;p[y]===f;)g++,y++;for(var b=(p.length-y)*c+1>>>0,w=new Uint8Array(b);p[y];){var C=r[p.charCodeAt(y)];if(C===255)return;for(var A=0,B=b-1;(C!==0||A<m)&&B!==-1;B--,A++)C+=o*w[B]>>>0,w[B]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");m=A,y++}if(p[y]!==" "){for(var L=b-m;L!==b&&w[L]===0;)L++;for(var R=new Uint8Array(g+(b-L)),D=g;L!==b;)R[D++]=w[L++];return R}}}function d(p){var y=l(p);if(y)return y;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var z1=q1,G1=z1,Wc=G1;var qm=new Uint8Array(0);var Yc=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},$e=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var Xc=e=>new TextEncoder().encode(e),$c=e=>new TextDecoder().decode(e);var Aa=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},_a=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Qc(this,t)}},Ca=class{constructor(t){this.decoders=t}or(t){return Qc(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Qc=(e,t)=>new Ca({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Ta=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Aa(t,r,n),this.decoder=new _a(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},Xr=({name:e,prefix:t,encode:r,decode:n})=>new Ta(e,t,r,n),or=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=Wc(r,t);return Xr({prefix:e,name:t,encode:n,decode:s=>$e(i(s))})},W1=(e,t,r,n)=>{let i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;e[s-1]==="=";)--s;let a=new Uint8Array(s*r/8|0),o=0,f=0,c=0;for(let u=0;u<s;++u){let h=i[e[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,o+=r,o>=8&&(o-=8,a[c++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return a},Y1=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,s="",a=0,o=0;for(let f=0;f<e.length;++f)for(o=o<<8|e[f],a+=8;a>r;)a-=r,s+=t[i&o>>a];if(a&&(s+=t[i&o<<r-a]),n)for(;s.length*r&7;)s+="=";return s},It=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Xr({prefix:t,name:e,encode(i){return Y1(i,n,r)},decode(i){return W1(i,n,r,e)}});var X1=Xr({prefix:"\0",name:"identity",encode:e=>$c(e),decode:e=>Xc(e)});var La={};Ot(La,{base2:()=>$1});var $1=It({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ra={};Ot(Ra,{base8:()=>Z1});var Z1=It({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ua={};Ot(Ua,{base10:()=>Q1});var Q1=or({prefix:"9",name:"base10",alphabet:"0123456789"});var Na={};Ot(Na,{base16:()=>J1,base16upper:()=>j1});var J1=It({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),j1=It({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Pa={};Ot(Pa,{base32:()=>fr,base32hex:()=>ny,base32hexpad:()=>sy,base32hexpadupper:()=>ay,base32hexupper:()=>iy,base32pad:()=>ey,base32padupper:()=>ry,base32upper:()=>ty,base32z:()=>oy});var fr=It({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ty=It({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ey=It({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ry=It({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ny=It({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),iy=It({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),sy=It({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ay=It({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),oy=It({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ka={};Ot(ka,{base36:()=>fy,base36upper:()=>cy});var fy=or({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),cy=or({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Da={};Ot(Da,{base58btc:()=>Ht,base58flickr:()=>uy});var Ht=or({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),uy=or({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ka={};Ot(Ka,{base64:()=>$r,base64pad:()=>hy,base64url:()=>ly,base64urlpad:()=>py});var $r=It({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),hy=It({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ly=It({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),py=It({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Fa={};Ot(Fa,{base256emoji:()=>my});var Jc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),dy=Jc.reduce((e,t,r)=>(e[r]=t,e),[]),yy=Jc.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function gy(e){return e.reduce((t,r)=>(t+=dy[r],t),"")}function xy(e){let t=[];for(let r of e){let n=yy[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var my=Xr({prefix:"\u{1F680}",name:"base256emoji",encode:gy,decode:xy});var Va={};Ot(Va,{sha256:()=>Vt,sha512:()=>Ky});var vy=eu,jc=128,wy=127,by=~wy,Ey=Math.pow(2,31);function eu(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Ey;)t[r++]=e&255|jc,e/=128;for(;e&by;)t[r++]=e&255|jc,e>>>=7;return t[r]=e|0,eu.bytes=r-n+1,t}var Sy=Ma,By=128,tu=127;function Ma(e,n){var r=0,n=n||0,i=0,s=n,a,o=e.length;do{if(s>=o)throw Ma.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&tu)<<i:(a&tu)*Math.pow(2,i),i+=7}while(a>=By);return Ma.bytes=s-n,r}var Ay=Math.pow(2,7),_y=Math.pow(2,14),Cy=Math.pow(2,21),Ty=Math.pow(2,28),Iy=Math.pow(2,35),Ly=Math.pow(2,42),Ry=Math.pow(2,49),Uy=Math.pow(2,56),Ny=Math.pow(2,63),Py=function(e){return e<Ay?1:e<_y?2:e<Cy?3:e<Ty?4:e<Iy?5:e<Ly?6:e<Ry?7:e<Uy?8:e<Ny?9:10},ky={encode:vy,decode:Sy,encodingLength:Py},Dy=ky,Kn=Dy;var Fn=(e,t=0)=>[Kn.decode(e,t),Kn.decode.bytes],Zr=(e,t,r=0)=>(Kn.encode(e,t,r),t),Qr=e=>Kn.encodingLength(e);var Ke=(e,t)=>{let r=t.byteLength,n=Qr(e),i=n+Qr(r),s=new Uint8Array(i+r);return Zr(e,s,0),Zr(r,s,n),s.set(t,i),new Jr(e,r,t,s)},Mn=e=>{let t=$e(e),[r,n]=Fn(t),[i,s]=Fn(t.subarray(n)),a=t.subarray(n+s);if(a.byteLength!==i)throw new Error("Incorrect length");return new Jr(r,i,a,t)},ru=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Yc(e.bytes,r.bytes)}},Jr=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}};var Ha=({name:e,code:t,encode:r})=>new Oa(e,t,r),Oa=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?Ke(this.code,r):r.then(n=>Ke(this.code,n))}else throw Error("Unknown type, must be binary type")}};var iu=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Vt=Ha({name:"sha2-256",code:18,encode:iu("SHA-256")}),Ky=Ha({name:"sha2-512",code:19,encode:iu("SHA-512")});var qa={};Ot(qa,{identity:()=>cr});var su=0,Fy="identity",au=$e,My=e=>Ke(su,au(e)),cr={code:su,name:Fy,encode:au,digest:My};var uv=new TextEncoder,hv=new TextDecoder;var Vy=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return zy(r,za(e),t||Ht.encoder);default:return Gy(r,za(e),t||fr.encoder)}},ou=new WeakMap,za=e=>{let t=ou.get(e);if(t==null){let r=new Map;return ou.set(e,r),r}return t},At=class{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==On)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Wy)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return At.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Ke(t,r);return At.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return At.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&ru(t.multihash,n.multihash)}toString(t){return Vy(this,t)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof At)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:a}=r;return new At(n,i,s,a||fu(n,i,s.bytes))}else if(r[Yy]===!0){let{version:n,multihash:i,code:s}=r,a=Mn(i);return At.create(n,s,a)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==On)throw new Error(`Version 0 CID must use dag-pb (code: ${On}) block encoding`);return new At(t,r,n,n.bytes)}case 1:{let i=fu(t,r,n.bytes);return new At(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return At.create(0,On,t)}static createV1(t,r){return At.create(1,t,r)}static decode(t){let[r,n]=At.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=At.inspectBytes(t),n=r.size-r.multihashSize,i=$e(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),a=new Jr(r.multihashCode,r.digestSize,s,i);return[r.version===0?At.createV0(a):At.createV1(r.codec,a),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,l]=Fn(t.subarray(r));return r+=l,h},i=n(),s=On;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let a=r,o=n(),f=n(),c=r+f,u=c-a;return{version:i,codec:s,multihashCode:o,digestSize:f,multihashSize:u,size:c}}static parse(t,r){let[n,i]=qy(t,r),s=At.decode(i);return za(s).set(n,t),s}},qy=(e,t)=>{switch(e[0]){case"Q":{let r=t||Ht;return[Ht.prefix,r.decode(`${Ht.prefix}${e}`)]}case Ht.prefix:{let r=t||Ht;return[Ht.prefix,r.decode(e)]}case fr.prefix:{let r=t||fr;return[fr.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},zy=(e,t,r)=>{let{prefix:n}=r;if(n!==Ht.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return i},Gy=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let s=r.encode(e);return t.set(n,s),s}else return i},On=112,Wy=18,fu=(e,t,r)=>{let n=Qr(e),i=n+Qr(t),s=new Uint8Array(i+r.byteLength);return Zr(e,s,0),Zr(t,s,n),s.set(r,i),s},Yy=Symbol.for("@ipld/js-cid/CID");var tn={...Ia,...La,...Ra,...Ua,...Na,...Pa,...ka,...Da,...Ka,...Fa},bv={...Va,...qa};function uu(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var cu=uu("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Ga=uu("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=Se(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Xy={utf8:cu,"utf-8":cu,hex:tn.base16,latin1:Ga,ascii:Ga,binary:Ga,...tn},Xi=Xy;function qt(e,t="utf8"){let r=Xi[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?je(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}var Zy=Y(oe(),1);var ie={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var Qy=Y(oe(),1);var Ov=Y(Rt(),1),Hv=Y(qi(),1),hu=Y(yt(),1);function _t(e,t="utf8"){let r=Xi[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function be(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Ut([new Uint8Array(t-r.length),r])}return _t(r,"base64url")}function ce(e){let t=lu(e);return new hu.default.jsbn.BigInteger(_t(t,"base16"),16)}function lu(e,t){let r=qt(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Ut([new Uint8Array(t-r.length),r])}return r}var Jy={"P-256":256,"P-384":384,"P-521":521},jy=Object.keys(Jy),Qv=jy.join(" / ");function Wa(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,a=e?.iterations??32767,o=ie.get();r*=8;async function f(h,l){let d=o.getRandomValues(new Uint8Array(s)),p=o.getRandomValues(new Uint8Array(n)),y={name:t,iv:p};typeof l=="string"&&(l=qt(l));let g={name:"PBKDF2",salt:d,iterations:a,hash:{name:i}},m=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(g,m,{name:t,length:r},!0,["encrypt"]),w=await o.subtle.encrypt(y,b,h);return Ut([d,y.iv,new Uint8Array(w)])}async function c(h,l){let d=h.slice(0,s),p=h.slice(s,s+n),y=h.slice(s+n),g={name:t,iv:p};typeof l=="string"&&(l=qt(l));let m={name:"PBKDF2",salt:d,iterations:a,hash:{name:i}},b=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),w=await o.subtle.deriveKey(m,b,{name:t,length:r},!0,["decrypt"]),C=await o.subtle.decrypt(g,w,y);return new Uint8Array(C)}return{encrypt:f,decrypt:c}}var io={};Ot(io,{RsaPrivateKey:()=>cn,RsaPublicKey:()=>Yn,fromJwk:()=>B2,generateKeyPair:()=>A2,unmarshalRsaPrivateKey:()=>E2,unmarshalRsaPublicKey:()=>S2});var no=Y(oe(),1);var Tw=Y(mu(),1),Wn=Y(yt(),1);var e2=Y(mr(),1);var tt=BigInt(0),wt=BigInt(1),ur=BigInt(2),qn=BigInt(3),r2=BigInt(8),St=Object.freeze({a:tt,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:wt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")});function vu(e){let{a:t,b:r}=St,n=P(e*e),i=P(n*e);return P(i+t*e+r)}var $i=St.a===tt,Qi=class extends Error{constructor(t){super(t)}},ht=class{constructor(t,r,n){this.x=t,this.y=r,this.z=n}static fromAffine(t){if(!(t instanceof dt))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new ht(t.x,t.y,wt)}static toAffineBatch(t){let r=o2(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return ht.toAffineBatch(t).map(ht.fromAffine)}equals(t){if(!(t instanceof ht))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t,f=P(i*i),c=P(o*o),u=P(r*c),h=P(s*f),l=P(P(n*o)*c),d=P(P(a*i)*f);return u===h&&l===d}negate(){return new ht(this.x,P(-this.y),this.z)}double(){let{x:t,y:r,z:n}=this,i=P(t*t),s=P(r*r),a=P(s*s),o=t+s,f=P(ur*(P(o*o)-i-a)),c=P(qn*i),u=P(c*c),h=P(u-ur*f),l=P(c*(f-h)-r2*a),d=P(ur*r*n);return new ht(h,l,d)}add(t){if(!(t instanceof ht))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t;if(s===tt||a===tt)return this;if(r===tt||n===tt)return t;let f=P(i*i),c=P(o*o),u=P(r*c),h=P(s*f),l=P(P(n*o)*c),d=P(P(a*i)*f),p=P(h-u),y=P(d-l);if(p===tt)return y===tt?this.double():ht.ZERO;let g=P(p*p),m=P(p*g),b=P(u*g),w=P(y*y-m-ur*b),C=P(y*(b-w)-l*m),A=P(i*o*p);return new ht(w,C,A)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let r=ht.ZERO;if(typeof t=="bigint"&&t===tt)return r;let n=Eu(t);if(n===wt)return this;if(!$i){let h=r,l=this;for(;n>tt;)n&wt&&(h=h.add(l)),l=l.double(),n>>=wt;return h}let{k1neg:i,k1:s,k2neg:a,k2:o}=Bu(n),f=r,c=r,u=this;for(;s>tt||o>tt;)s&wt&&(f=f.add(u)),o&wt&&(c=c.add(u)),u=u.double(),s>>=wt,o>>=wt;return i&&(f=f.negate()),a&&(c=c.negate()),c=new ht(P(c.x*St.beta),c.y,c.z),f.add(c)}precomputeWindow(t){let r=$i?128/t+1:256/t+1,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(t-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(ht.BASE)&&(r=dt.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Za.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=ht.normalizeZ(i),Za.set(r,i)));let s=ht.ZERO,a=ht.ZERO,o=1+($i?128/n:256/n),f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(t&c);if(t>>=h,p>f&&(p-=u,t+=wt),p===0){let y=i[d];l%2&&(y=y.negate()),a=a.add(y)}else{let y=i[d+Math.abs(p)-1];p<0&&(y=y.negate()),s=s.add(y)}}return{p:s,f:a}}multiply(t,r){let n=Eu(t),i,s;if($i){let{k1neg:a,k1:o,k2neg:f,k2:c}=Bu(n),{p:u,f:h}=this.wNAF(o,r),{p:l,f:d}=this.wNAF(c,r);a&&(u=u.negate()),f&&(l=l.negate()),l=new ht(P(l.x*St.beta),l.y,l.z),i=u.add(l),s=h.add(d)}else{let{p:a,f:o}=this.wNAF(n,r);i=a,s=o}return ht.normalizeZ([i,s])[0]}toAffine(t=on(this.z)){let{x:r,y:n,z:i}=this,s=t,a=P(s*s),o=P(a*s),f=P(r*a),c=P(n*o);if(P(i*s)!==wt)throw new Error("invZ was invalid");return new dt(f,c)}};ht.BASE=new ht(St.Gx,St.Gy,wt);ht.ZERO=new ht(tt,wt,tt);var Za=new WeakMap,dt=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,Za.delete(this)}hasEvenY(){return this.y%ur===tt}static fromCompressedHex(t){let r=t.length===32,n=Ze(r?t:t.subarray(1));if(!$a(n))throw new Error("Point is not on curve");let i=vu(n),s=a2(i),a=(s&wt)===wt;r?a&&(s=P(-s)):(t[0]&1)===1!==a&&(s=P(-s));let o=new dt(n,s);return o.assertValidity(),o}static fromUncompressedHex(t){let r=Ze(t.subarray(1,33)),n=Ze(t.subarray(33,65)),i=new dt(r,n);return i.assertValidity(),i}static fromHex(t){let r=an(t),n=r.length,i=r[0];if(n===32||n===33&&(i===2||i===3))return this.fromCompressedHex(r);if(n===65&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${n}`)}static fromPrivateKey(t){return dt.BASE.multiply(ji(t))}static fromSignature(t,r,n){t=an(t);let i=Au(t),{r:s,s:a}=_u(r);if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid recovery bit");let o=n&1?"03":"02",f=dt.fromHex(o+rn(s)),{n:c}=St,u=on(s,c),h=P(-i*u,c),l=P(a*u,c),d=dt.BASE.multiplyAndAddUnsafe(f,h,l);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(t=!1){return Ur(this.toHex(t))}toHex(t=!1){let r=rn(this.x);return t?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${rn(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let t="Point is not on elliptic curve",{x:r,y:n}=this;if(!$a(r)||!$a(n))throw new Error(t);let i=P(n*n),s=vu(r);if(P(i-s)!==tt)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new dt(this.x,P(-this.y))}double(){return ht.fromAffine(this).double().toAffine()}add(t){return ht.fromAffine(this).add(ht.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return ht.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,r,n){let i=ht.fromAffine(this),s=r===tt||r===wt||this!==dt.BASE?i.multiplyUnsafe(r):i.multiply(r),a=ht.fromAffine(t).multiplyUnsafe(n),o=s.add(a);return o.equals(ht.ZERO)?void 0:o.toAffine()}};dt.BASE=new dt(St.Gx,St.Gy);dt.ZERO=new dt(tt,tt);function wu(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function bu(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${sn(e)}`);let t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Ze(r),left:e.subarray(t+2)}}function n2(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${sn(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");let{data:t,left:r}=bu(e.subarray(2)),{data:n,left:i}=bu(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${sn(i)}`);return{r:t,s:n}}var Fe=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromCompact(t){let r=t instanceof Uint8Array,n="Signature.fromCompact";if(typeof t!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?sn(t):t;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new Fe(Ji(i.slice(0,64)),Ji(i.slice(64,128)))}static fromDER(t){let r=t instanceof Uint8Array;if(typeof t!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=n2(r?t:Ur(t));return new Fe(n,i)}static fromHex(t){return this.fromDER(t)}assertValidity(){let{r:t,s:r}=this;if(!Gn(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Gn(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let t=St.n>>wt;return this.s>t}normalizeS(){return this.hasHighS()?new Fe(this.r,St.n-this.s):this}toDERRawBytes(t=!1){return Ur(this.toDERHex(t))}toDERHex(t=!1){let r=wu(Vn(this.s));if(t)return r;let n=wu(Vn(this.r)),i=Vn(n.length/2),s=Vn(r.length/2);return`30${Vn(n.length/2+r.length/2+4)}02${i}${n}02${s}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Ur(this.toCompactHex())}toCompactHex(){return rn(this.r)+rn(this.s)}};function en(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var i2=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function sn(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=i2[e[r]];return t}var s2=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function rn(e){if(typeof e!="bigint")throw new Error("Expected bigint");if(!(tt<=e&&e<s2))throw new Error("Expected number < 2^256");return e.toString(16).padStart(64,"0")}function Qa(e){let t=Ur(rn(e));if(t.length!==32)throw new Error("Error: expected 32 bytes");return t}function Vn(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function Ji(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function Ur(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function Ze(e){return Ji(sn(e))}function an(e){return e instanceof Uint8Array?Uint8Array.from(e):Ur(e)}function Eu(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&Gn(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function P(e,t=St.P){let r=e%t;return r>=tt?r:t+r}function ye(e,t){let{P:r}=St,n=e;for(;t-- >tt;)n*=n,n%=r;return n}function a2(e){let{P:t}=St,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),o=BigInt(88),f=e*e*e%t,c=f*f*e%t,u=ye(c,qn)*c%t,h=ye(u,qn)*c%t,l=ye(h,ur)*f%t,d=ye(l,n)*l%t,p=ye(d,i)*d%t,y=ye(p,a)*p%t,g=ye(y,o)*y%t,m=ye(g,a)*p%t,b=ye(m,qn)*c%t,w=ye(b,s)*d%t,C=ye(w,r)*f%t;return ye(C,ur)}function on(e,t=St.P){if(e===tt||t<=tt)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=P(e,t),n=t,i=tt,s=wt,a=wt,o=tt;for(;r!==tt;){let c=n/r,u=n%r,h=i-a*c,l=s-o*c;n=r,r=u,i=a,s=o,a=h,o=l}if(n!==wt)throw new Error("invert: does not exist");return P(i,t)}function o2(e,t=St.P){let r=new Array(e.length),n=e.reduce((s,a,o)=>a===tt?s:(r[o]=s,P(s*a,t)),wt),i=on(n,t);return e.reduceRight((s,a,o)=>a===tt?s:(r[o]=P(s*r[o],t),P(s*a,t)),i),r}var Su=(e,t)=>(e+t/ur)/t,f2={a1:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),b1:-wt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a2:BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),b2:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),POW_2_128:BigInt("0x100000000000000000000000000000000")};function Bu(e){let{n:t}=St,{a1:r,b1:n,a2:i,b2:s,POW_2_128:a}=f2,o=Su(s*e,t),f=Su(-n*e,t),c=P(e-o*r-f*i,t),u=P(-o*n-f*s,t),h=c>a,l=u>a;if(h&&(c=t-c),l&&(u=t-u),c>a||u>a)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:h,k1:c,k2neg:l,k2:u}}function Au(e){let{n:t}=St,n=e.length*8-256,i=Ze(e);return n>0&&(i=i>>BigInt(n)),i>=t&&(i-=t),i}var nn,zn,Ja=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...t){return Ee.hmacSha256(this.k,...t)}hmacSync(...t){return zn(this.k,...t)}checkSync(){if(typeof zn!="function")throw new Qi("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.checkSync(),this.incr(),this.v=this.hmacSync(this.v),this.v}};function Gn(e){return tt<e&&e<St.n}function $a(e){return tt<e&&e<St.P}function c2(e,t,r){let n=Ze(e);if(!Gn(n))return;let{n:i}=St,s=dt.BASE.multiply(n),a=P(s.x,i);if(a===tt)return;let o=P(on(n,i)*P(t+r*a,i),i);if(o===tt)return;let f=new Fe(a,o),c=(s.x===f.r?0:2)|Number(s.y&wt);return{sig:f,recovery:c}}function ji(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==64)throw new Error("Expected 32 bytes of private key");t=Ji(e)}else if(e instanceof Uint8Array){if(e.length!==32)throw new Error("Expected 32 bytes of private key");t=Ze(e)}else throw new TypeError("Expected valid private key");if(!Gn(t))throw new Error("Expected private key: 0 < key < n");return t}function u2(e){return e instanceof dt?(e.assertValidity(),e):dt.fromHex(e)}function _u(e){if(e instanceof Fe)return e.assertValidity(),e;try{return Fe.fromDER(e)}catch{return Fe.fromCompact(e)}}function ja(e,t=!1){return dt.fromPrivateKey(e).toRawBytes(t)}function Cu(e){let t=e.length>32?e.slice(0,32):e;return Ze(t)}function h2(e){let t=Cu(e),r=P(t,St.n);return Tu(r<tt?t:r)}function Tu(e){return Qa(e)}function l2(e,t,r){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);let n=an(e),i=ji(t),s=[Tu(i),h2(n)];if(r!=null){r===!0&&(r=Ee.randomBytes(32));let f=an(r);if(f.length!==32)throw new Error("sign: Expected 32 bytes of extra data");s.push(f)}let a=en(...s),o=Cu(n);return{seed:a,m:o,d:i}}function p2(e,t){let{sig:r,recovery:n}=e,{canonical:i,der:s,recovered:a}=Object.assign({canonical:!0,der:!0},t);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let o=s?r.toDERRawBytes():r.toCompactRawBytes();return a?[o,n]:o}async function Iu(e,t,r={}){let{seed:n,m:i,d:s}=l2(e,t,r.extraEntropy),a,o=new Ja;for(await o.reseed(n);!(a=c2(await o.generate(),i,s));)await o.reseed();return p2(a,r)}var d2={strict:!0};function Lu(e,t,r,n=d2){let i;try{i=_u(e),t=an(t)}catch{return!1}let{r:s,s:a}=i;if(n.strict&&i.hasHighS())return!1;let o=Au(t),f;try{f=u2(r)}catch{return!1}let{n:c}=St,u=on(a,c),h=P(o*u,c),l=P(s*u,c),d=dt.BASE.multiplyAndAddUnsafe(f,h,l);return d?P(d.x,c)===s:!1}dt.BASE._setWindowSize(8);var ue={node:e2,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Zi={},Ee={bytesToHex:sn,hexToBytes:Ur,concatBytes:en,mod:P,invert:on,isValidPrivateKey(e){try{return ji(e),!0}catch{return!1}},_bigintTo32Bytes:Qa,_normalizePrivateKey:ji,hashToPrivateKey:e=>{if(e=an(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let t=P(Ze(e),St.n-wt)+wt;return Qa(t)},randomBytes:(e=32)=>{if(ue.web)return ue.web.getRandomValues(new Uint8Array(e));if(ue.node){let{randomBytes:t}=ue.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ee.hashToPrivateKey(Ee.randomBytes(40)),sha256:async(...e)=>{if(ue.web){let t=await ue.web.subtle.digest("SHA-256",en(...e));return new Uint8Array(t)}else if(ue.node){let{createHash:t}=ue.node,r=t("sha256");return e.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(ue.web){let r=await ue.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=en(...t),i=await ue.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(ue.node){let{createHmac:r}=ue.node,n=r("sha256",e);return t.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=Zi[e];if(r===void 0){let n=await Ee.sha256(Uint8Array.from(e,i=>i.charCodeAt(0)));r=en(n,n),Zi[e]=r}return Ee.sha256(r,...t)},taggedHashSync:(e,...t)=>{if(typeof nn!="function")throw new Qi("sha256Sync is undefined, you need to set it");let r=Zi[e];if(r===void 0){let n=nn(Uint8Array.from(e,i=>i.charCodeAt(0)));r=en(n,n),Zi[e]=r}return nn(r,...t)},precompute(e=8,t=dt.BASE){let r=t===dt.BASE?t:new dt(t.x,t.y);return r._setWindowSize(e),r.multiply(qn),r}};Object.defineProperties(Ee,{sha256Sync:{configurable:!1,get(){return nn},set(e){nn||(nn=e)}},hmacSha256Sync:{configurable:!1,get(){return zn},set(e){zn||(zn=e)}}});var Ru=Y(oe(),1);function ts(e){if(isNaN(e)||e<=0)throw(0,Ru.default)(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return Ee.randomBytes(e)}var Nr={};Ot(Nr,{jwkToPkcs1:()=>x2,jwkToPkix:()=>v2,pkcs1ToJwk:()=>g2,pkixToJwk:()=>m2});var uw=Y(Pn(),1),hw=Y(Wi(),1),Qe=Y(yt(),1);var to=Y(oe(),1);function g2(e){let t=Qe.default.asn1.fromDer(_t(e,"ascii")),r=Qe.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:be(r.n),e:be(r.e),d:be(r.d),p:be(r.p),q:be(r.q),dp:be(r.dP),dq:be(r.dQ),qi:be(r.qInv),alg:"RS256"}}function x2(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw(0,to.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let t=Qe.default.pki.privateKeyToAsn1({n:ce(e.n),e:ce(e.e),d:ce(e.d),p:ce(e.p),q:ce(e.q),dP:ce(e.dp),dQ:ce(e.dq),qInv:ce(e.qi)});return qt(Qe.default.asn1.toDer(t).getBytes(),"ascii")}function m2(e){let t=Qe.default.asn1.fromDer(_t(e,"ascii")),r=Qe.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:be(r.n),e:be(r.e)}}function v2(e){if(e.n==null||e.e==null)throw(0,to.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let t=Qe.default.pki.publicKeyToAsn1({n:ce(e.n),e:ce(e.e)});return qt(Qe.default.asn1.toDer(t).getBytes(),"ascii")}var yw=Y(Wi(),1),eo=Y(yt(),1);function Uu(e,t){return t.map(r=>ce(e[r]))}function Nu(e){return eo.default.pki.setRsaPrivateKey(...Uu(e,["n","e","d","p","q","dp","dq","qi"]))}function Pu(e){return eo.default.pki.setRsaPublicKey(...Uu(e,["n","e"]))}var ku=Y(oe(),1);async function Du(e){let t=await ie.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Mu(t);return{privateKey:r[0],publicKey:r[1]}}async function ro(e){let r=[await ie.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await w2(e)],n=await Mu({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Ku(e,t){let r=await ie.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await ie.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function Fu(e,t,r){let n=await ie.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await ie.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function Mu(e){if(e.privateKey==null||e.publicKey==null)throw(0,ku.default)(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([ie.get().subtle.exportKey("jwk",e.privateKey),ie.get().subtle.exportKey("jwk",e.publicKey)])}async function w2(e){return await ie.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Ou(e,t,r,n){let i=t?Pu(e):Nu(e),s=_t(Uint8Array.from(r),"ascii"),a=n(s,i);return qt(a,"ascii")}function Hu(e,t){return Ou(e,!0,t,(r,n)=>n.encrypt(r))}function Vu(e,t){return Ou(e,!1,t,(r,n)=>n.decrypt(r))}async function fn(e,t){let n=await Wa().encrypt(e,t);return $r.encode(n)}var Yn=class{constructor(t){this._key=t}async verify(t,r){return await Fu(this._key,r,t)}marshal(){return Nr.jwkToPkix(this._key)}get bytes(){return Ie.encode({Type:bt.RSA,Data:this.marshal()}).subarray()}encrypt(t){return Hu(this._key,t)}equals(t){return Nt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Vt.digest(this.bytes);return t}},cn=class{constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return ts(16)}async sign(t){return await Ku(this._key,t)}get public(){if(this._publicKey==null)throw(0,no.default)(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Yn(this._publicKey)}decrypt(t){return Vu(this._key,t)}marshal(){return Nr.jwkToPkcs1(this._key)}get bytes(){return Le.encode({Type:bt.RSA,Data:this.marshal()}).subarray()}equals(t){return Nt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Vt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return _t(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new Wn.default.util.ByteBuffer(this.marshal()),i=Wn.default.asn1.fromDer(n),s=Wn.default.pki.privateKeyFromAsn1(i),a={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Wn.default.pki.encryptRsaPrivateKey(s,t,a)}else{if(r==="libp2p-key")return await fn(this.bytes,t);throw(0,no.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function E2(e){let t=Nr.pkcs1ToJwk(e),r=await ro(t);return new cn(r.privateKey,r.publicKey)}function S2(e){let t=Nr.pkixToJwk(e);return new Yn(t)}async function B2(e){let t=await ro(e);return new cn(t.privateKey,t.publicKey)}async function A2(e){let t=await Du(e);return new cn(t.privateKey,t.publicKey)}var yo={};Ot(yo,{Ed25519PrivateKey:()=>kr,Ed25519PublicKey:()=>Jn,generateKeyPair:()=>G2,generateKeyPairFromSeed:()=>rh,unmarshalEd25519PrivateKey:()=>q2,unmarshalEd25519PublicKey:()=>z2});var po=Y(oe(),1);var _2=Y(mr(),1);var Ft=BigInt(0),rt=BigInt(1),un=BigInt(2),qu=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),Bt=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:qu,n:qu,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var Yu=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Xn=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Lw=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),C2=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),T2=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),I2=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),L2=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),et=class{constructor(t,r,n,i){this.x=t,this.y=r,this.z=n,this.t=i}static fromAffine(t){if(!(t instanceof Ct))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(Ct.ZERO)?et.ZERO:new et(t.x,t.y,rt,T(t.x*t.y))}static toAffineBatch(t){let r=N2(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){zu(t);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t,f=T(r*o),c=T(s*i),u=T(n*o),h=T(a*i);return f===c&&u===h}negate(){return new et(T(-this.x),this.y,this.z,T(-this.t))}double(){let{x:t,y:r,z:n}=this,{a:i}=Bt,s=T(t*t),a=T(r*r),o=T(un*T(n*n)),f=T(i*s),c=t+r,u=T(T(c*c)-s-a),h=f+a,l=h-o,d=f-a,p=T(u*l),y=T(h*d),g=T(u*d),m=T(l*h);return new et(p,y,m,g)}add(t){zu(t);let{x:r,y:n,z:i,t:s}=this,{x:a,y:o,z:f,t:c}=t,u=T((n-r)*(o+a)),h=T((n+r)*(o-a)),l=T(h-u);if(l===Ft)return this.double();let d=T(i*un*c),p=T(s*un*f),y=p+d,g=h+u,m=p-d,b=T(y*l),w=T(g*m),C=T(y*m),A=T(l*g);return new et(b,w,A,C)}subtract(t){return this.add(t.negate())}precomputeWindow(t){let r=1+256/t,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(t-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(et.BASE)&&(r=Ct.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&co.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=et.normalizeZ(i),co.set(r,i)));let s=et.ZERO,a=et.ZERO,o=1+256/n,f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(t&c);if(t>>=h,p>f&&(p-=u,t+=rt),p===0){let y=i[d];l%2&&(y=y.negate()),a=a.add(y)}else{let y=i[d+Math.abs(p)-1];p<0&&(y=y.negate()),s=s.add(y)}}return et.normalizeZ([s,a])[0]}multiply(t,r){return this.wNAF(rs(t,Bt.l),r)}multiplyUnsafe(t){let r=rs(t,Bt.l,!1),n=et.BASE,i=et.ZERO;if(r===Ft)return i;if(this.equals(i)||r===rt)return this;if(this.equals(n))return this.wNAF(r);let s=i,a=this;for(;r>Ft;)r&rt&&(s=s.add(a)),a=a.double(),r>>=rt;return s}isSmallOrder(){return this.multiplyUnsafe(Bt.h).equals(et.ZERO)}isTorsionFree(){return this.multiplyUnsafe(Bt.l).equals(et.ZERO)}toAffine(t=ns(this.z)){let{x:r,y:n,z:i}=this,s=T(r*t),a=T(n*t);if(T(i*t)!==rt)throw new Error("invZ was invalid");return new Ct(s,a)}fromRistrettoBytes(){ao()}toRistrettoBytes(){ao()}fromRistrettoHash(){ao()}};et.BASE=new et(Bt.Gx,Bt.Gy,rt,T(Bt.Gx*Bt.Gy));et.ZERO=new et(Ft,rt,rt,Ft);function zu(e){if(!(e instanceof et))throw new TypeError("ExtendedPoint expected")}function so(e){if(!(e instanceof se))throw new TypeError("RistrettoPoint expected")}function ao(){throw new Error("Legacy method: switch to RistrettoPoint")}var se=class{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){let{d:r}=Bt,n=T(Xn*t*t),i=T((n+rt)*I2),s=BigInt(-1),a=T((s-r*n)*T(n+r)),{isValid:o,value:f}=ho(i,a),c=T(f*t);lr(c)||(c=T(-c)),o||(f=c),o||(s=n);let u=T(s*(n-rt)*L2-a),h=f*f,l=T((f+f)*a),d=T(u*C2),p=T(rt-h),y=T(rt+h);return new et(T(l*y),T(p*d),T(d*y),T(l*p))}static hashToCurve(t){t=pr(t,64);let r=oo(t.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=oo(t.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new se(n.add(s))}static fromHex(t){t=pr(t,32);let{a:r,d:n}=Bt,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=oo(t);if(!k2($n(s),t)||lr(s))throw new Error(i);let a=T(s*s),o=T(rt+r*a),f=T(rt-r*a),c=T(o*o),u=T(f*f),h=T(r*n*c-u),{isValid:l,value:d}=Wu(T(h*u)),p=T(d*f),y=T(d*p*h),g=T((s+s)*p);lr(g)&&(g=T(-g));let m=T(o*y),b=T(g*m);if(!l||lr(b)||m===Ft)throw new Error(i);return new se(new et(g,m,rt,b))}toRawBytes(){let{x:t,y:r,z:n,t:i}=this.ep,s=T(T(n+r)*T(n-r)),a=T(t*r),o=T(a*a),{value:f}=Wu(T(s*o)),c=T(f*s),u=T(f*a),h=T(c*u*i),l;if(lr(i*h)){let p=T(r*Xn),y=T(t*Xn);t=p,r=y,l=T(c*T2)}else l=u;lr(t*h)&&(r=T(-r));let d=T((n-r)*l);return lr(d)&&(d=T(-d)),$n(d)}toHex(){return Zn(this.toRawBytes())}toString(){return this.toHex()}equals(t){so(t);let r=this.ep,n=t.ep,i=T(r.x*n.y)===T(r.y*n.x),s=T(r.y*n.y)===T(r.x*n.x);return i||s}add(t){return so(t),new se(this.ep.add(t.ep))}subtract(t){return so(t),new se(this.ep.subtract(t.ep))}multiply(t){return new se(this.ep.multiply(t))}multiplyUnsafe(t){return new se(this.ep.multiplyUnsafe(t))}};se.BASE=new se(et.BASE);se.ZERO=new se(et.ZERO);var co=new WeakMap,Ct=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,co.delete(this)}static fromHex(t,r=!0){let{d:n,P:i}=Bt;t=pr(t,32);let s=t.slice();s[31]=t[31]&-129;let a=Qn(s);if(r&&a>=i)throw new Error("Expected 0 < hex < P");if(!r&&a>=Yu)throw new Error("Expected 0 < hex < 2**256");let o=T(a*a),f=T(o-rt),c=T(n*o+rt),{isValid:u,value:h}=ho(f,c);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&rt)===rt;return(t[31]&128)!==0!==l&&(h=T(-h)),new Ct(h,a)}static async fromPrivateKey(t){return(await is(t)).point}toRawBytes(){let t=$n(this.y);return t[31]|=this.x&rt?128:0,t}toHex(){return Zn(this.toRawBytes())}toX25519(){let{y:t}=this,r=T((rt+t)*ns(rt-t));return $n(r)}isTorsionFree(){return et.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new Ct(T(-this.x),this.y)}add(t){return et.fromAffine(this).add(et.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return et.fromAffine(this).multiply(t,this).toAffine()}};Ct.BASE=new Ct(Bt.Gx,Bt.Gy);Ct.ZERO=new Ct(Ft,rt);var Pr=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromHex(t){let r=pr(t,64),n=Ct.fromHex(r.slice(0,32),!1),i=Qn(r.slice(32,64));return new Pr(n,i)}assertValidity(){let{r:t,s:r}=this;if(!(t instanceof Ct))throw new Error("Expected Point instance");return rs(r,Bt.l,!1),this}toRawBytes(){let t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set($n(this.s),32),t}toHex(){return Zn(this.toRawBytes())}};function Gu(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var R2=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Zn(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=R2[e[r]];return t}function uo(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function Xu(e){let r=e.toString(16).padStart(64,"0");return uo(r)}function $n(e){return Xu(e).reverse()}function lr(e){return(T(e)&rt)===rt}function Qn(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Zn(Uint8Array.from(e).reverse()))}var U2=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function oo(e){return T(Qn(e)&U2)}function T(e,t=Bt.P){let r=e%t;return r>=Ft?r:t+r}function ns(e,t=Bt.P){if(e===Ft||t<=Ft)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=T(e,t),n=t,i=Ft,s=rt,a=rt,o=Ft;for(;r!==Ft;){let c=n/r,u=n%r,h=i-a*c,l=s-o*c;n=r,r=u,i=a,s=o,a=h,o=l}if(n!==rt)throw new Error("invert: does not exist");return T(i,t)}function N2(e,t=Bt.P){let r=new Array(e.length),n=e.reduce((s,a,o)=>a===Ft?s:(r[o]=s,T(s*a,t)),rt),i=ns(n,t);return e.reduceRight((s,a,o)=>a===Ft?s:(r[o]=T(s*r[o],t),T(s*a,t)),i),r}function Me(e,t){let{P:r}=Bt,n=e;for(;t-- >Ft;)n*=n,n%=r;return n}function P2(e){let{P:t}=Bt,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),a=BigInt(80),f=e*e%t*e%t,c=Me(f,un)*f%t,u=Me(c,rt)*e%t,h=Me(u,r)*u%t,l=Me(h,n)*h%t,d=Me(l,i)*l%t,p=Me(d,s)*d%t,y=Me(p,a)*p%t,g=Me(y,a)*p%t,m=Me(g,n)*h%t;return{pow_p_5_8:Me(m,un)*e%t,b2:f}}function ho(e,t){let r=T(t*t*t),n=T(r*r*t),i=P2(e*n).pow_p_5_8,s=T(e*r*i),a=T(t*s*s),o=s,f=T(s*Xn),c=a===e,u=a===T(-e),h=a===T(-e*Xn);return c&&(s=o),(u||h)&&(s=f),lr(s)&&(s=T(-s)),{isValid:c||u,value:s}}function Wu(e){return ho(rt,e)}function es(e){return T(Qn(e),Bt.l)}function k2(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function pr(e,t){let r=e instanceof Uint8Array?Uint8Array.from(e):uo(e);if(typeof t=="number"&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function rs(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if(typeof e=="number"&&Number.isSafeInteger(e)&&(e=BigInt(e)),typeof e=="bigint"&&e<t){if(r){if(Ft<e)return e}else if(Ft<=e)return e}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function D2(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function K2(e){if(e=typeof e=="bigint"||typeof e=="number"?Xu(rs(e,Yu)):pr(e),e.length!==32)throw new Error("Expected 32 bytes");return e}function F2(e){let t=D2(e.slice(0,32)),r=e.slice(32,64),n=es(t),i=Ct.BASE.multiply(n),s=i.toRawBytes();return{head:t,prefix:r,scalar:n,point:i,pointBytes:s}}var fo;async function is(e){return F2(await dr.sha512(K2(e)))}async function lo(e){return(await is(e)).pointBytes}async function $u(e,t){e=pr(e);let{prefix:r,scalar:n,pointBytes:i}=await is(t),s=es(await dr.sha512(r,e)),a=Ct.BASE.multiply(s),o=es(await dr.sha512(a.toRawBytes(),i,e)),f=T(s+o*n,Bt.l);return new Pr(a,f).toRawBytes()}function M2(e,t,r){t=pr(t),r instanceof Ct||(r=Ct.fromHex(r,!1));let{r:n,s:i}=e instanceof Pr?e.assertValidity():Pr.fromHex(e),s=et.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:s,pub:r,msg:t}}function O2(e,t,r,n){let i=es(n),s=et.fromAffine(e).multiplyUnsafe(i);return et.fromAffine(t).add(s).subtract(r).multiplyUnsafe(Bt.h).equals(et.ZERO)}async function Zu(e,t,r){let{r:n,SB:i,msg:s,pub:a}=M2(e,t,r),o=await dr.sha512(n.toRawBytes(),a.toRawBytes(),s);return O2(a,n,i,o)}Ct.BASE._setWindowSize(8);var hr={node:_2,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},dr={bytesToHex:Zn,hexToBytes:uo,concatBytes:Gu,getExtendedPublicKey:is,mod:T,invert:ns,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if(e=pr(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return T(Qn(e),Bt.l-rt)+rt},randomBytes:(e=32)=>{if(hr.web)return hr.web.getRandomValues(new Uint8Array(e));if(hr.node){let{randomBytes:t}=hr.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>dr.randomBytes(32),sha512:async(...e)=>{let t=Gu(...e);if(hr.web){let r=await hr.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(r)}else{if(hr.node)return Uint8Array.from(hr.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=Ct.BASE){let r=t.equals(Ct.BASE)?t:new Ct(t.x,t.y);return r._setWindowSize(e),r.multiply(un),r},sha512Sync:void 0};Object.defineProperties(dr,{sha512Sync:{configurable:!1,get(){return fo},set(e){fo||(fo=e)}}});var hn=32,Je=64,ss=32;async function Qu(){let e=dr.randomPrivateKey(),t=await lo(e);return{privateKey:eh(e,t),publicKey:t}}async function Ju(e){if(e.length!==ss)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await lo(t);return{privateKey:eh(t,r),publicKey:r}}async function ju(e,t){let r=e.slice(0,ss);return await $u(t,r)}async function th(e,t,r){return await Zu(t,r,e)}function eh(e,t){let r=new Uint8Array(Je);for(let n=0;n<ss;n++)r[n]=e[n],r[ss+n]=t[n];return r}var Jn=class{constructor(t){this._key=ln(t,hn)}async verify(t,r){return await th(this._key,r,t)}marshal(){return this._key}get bytes(){return Ie.encode({Type:bt.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Nt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Vt.digest(this.bytes);return t}},kr=class{constructor(t,r){this._key=ln(t,Je),this._publicKey=ln(r,hn)}async sign(t){return await ju(this._key,t)}get public(){return new Jn(this._publicKey)}marshal(){return this._key}get bytes(){return Le.encode({Type:bt.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Nt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Vt.digest(this.bytes);return t}async id(){let t=await cr.digest(this.public.bytes);return Ht.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return await fn(this.bytes,t);throw(0,po.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function q2(e){if(e.length>Je){e=ln(e,Je+hn);let n=e.slice(0,Je),i=e.slice(Je,e.length);return new kr(n,i)}e=ln(e,Je);let t=e.slice(0,Je),r=e.slice(hn);return new kr(t,r)}function z2(e){return e=ln(e,hn),new Jn(e)}async function G2(){let{privateKey:e,publicKey:t}=await Qu();return new kr(e,t)}async function rh(e){let{privateKey:t,publicKey:r}=await Ju(e);return new kr(t,r)}function ln(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw(0,po.default)(new Error(`Key must be a Uint8Array of length ${t}, got ${e.length}`),"ERR_INVALID_KEY_TYPE");return e}var xo={};Ot(xo,{Secp256k1PrivateKey:()=>ti,Secp256k1PublicKey:()=>jn,generateKeyPair:()=>$2,unmarshalSecp256k1PrivateKey:()=>Y2,unmarshalSecp256k1PublicKey:()=>X2});var ch=Y(oe(),1);var pn=Y(oe(),1);function nh(){return Ee.randomPrivateKey()}async function ih(e,t){let{digest:r}=await Vt.digest(t);try{return await Iu(r,e)}catch(n){throw(0,pn.default)(n,"ERR_INVALID_INPUT")}}async function sh(e,t,r){try{let{digest:n}=await Vt.digest(r);return Lu(t,n,e)}catch(n){throw(0,pn.default)(n,"ERR_INVALID_INPUT")}}function ah(e){return dt.fromHex(e).toRawBytes(!0)}function oh(e){try{ja(e,!0)}catch(t){throw(0,pn.default)(t,"ERR_INVALID_PRIVATE_KEY")}}function go(e){try{dt.fromHex(e)}catch(t){throw(0,pn.default)(t,"ERR_INVALID_PUBLIC_KEY")}}function fh(e){try{return ja(e,!0)}catch(t){throw(0,pn.default)(t,"ERR_INVALID_PRIVATE_KEY")}}var jn=class{constructor(t){go(t),this._key=t}async verify(t,r){return await sh(this._key,r,t)}marshal(){return ah(this._key)}get bytes(){return Ie.encode({Type:bt.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Nt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Vt.digest(this.bytes);return t}},ti=class{constructor(t,r){this._key=t,this._publicKey=r??fh(t),oh(this._key),go(this._publicKey)}async sign(t){return await ih(this._key,t)}get public(){return new jn(this._publicKey)}marshal(){return this._key}get bytes(){return Le.encode({Type:bt.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Nt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Vt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return _t(t,"base58btc")}async export(t,r="libp2p-key"){if(r==="libp2p-key")return await fn(this.bytes,t);throw(0,ch.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function Y2(e){return new ti(e)}function X2(e){return new jn(e)}async function $2(){let e=await nh();return new ti(e)}var Dr={rsa:io,ed25519:yo,secp256k1:xo};function hh(e){let t=Object.keys(Dr).join(" / ");return(0,uh.default)(new Error(`invalid or unsupported key type ${e}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}function lh(e){let t=Ie.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case bt.RSA:return Dr.rsa.unmarshalRsaPublicKey(r);case bt.Ed25519:return Dr.ed25519.unmarshalEd25519PublicKey(r);case bt.Secp256k1:return Dr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw hh(t.Type??"RSA")}}async function ph(e){let t=Le.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case bt.RSA:return await Dr.rsa.unmarshalRsaPrivateKey(r);case bt.Ed25519:return Dr.ed25519.unmarshalEd25519PrivateKey(r);case bt.Secp256k1:return Dr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw hh(t.Type??"RSA")}}var Q2=Y(oe(),1);var dh=Symbol.for("@libp2p/peer-id");var yh=Object.values(tn).map(e=>e.decoder).reduce((e,t)=>e.or(t),tn.identity.decoder),gh=114,mo=36,vo=37,ei=class{constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[dh](){return!0}toString(){return this.string==null&&(this.string=Ht.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return At.createV1(gh,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return Nt(this.multihash.bytes,t);if(typeof t=="string")return J2(t).equals(this);if(t?.multihash?.bytes!=null)return Nt(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}},dn=class extends ei{constructor(t){super({...t,type:"RSA"}),this.type="RSA",this.publicKey=t.publicKey}},yn=class extends ei{constructor(t){super({...t,type:"Ed25519"}),this.type="Ed25519",this.publicKey=t.multihash.digest}},gn=class extends ei{constructor(t){super({...t,type:"secp256k1"}),this.type="secp256k1",this.publicKey=t.multihash.digest}};function J2(e,t){if(t=t??yh,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=Mn(Ht.decode(`z${e}`));return e.startsWith("12D")?new yn({multihash:r}):e.startsWith("16U")?new gn({multihash:r}):new dn({multihash:r})}return j2(yh.decode(e))}function j2(e){try{let t=Mn(e);if(t.code===cr.code){if(t.digest.length===mo)return new yn({multihash:t});if(t.digest.length===vo)return new gn({multihash:t})}if(t.code===Vt.code)return new dn({multihash:t})}catch{return tg(At.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function tg(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==gh)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===Vt.code)return new dn({multihash:e.multihash});if(t.code===cr.code){if(t.digest.length===mo)return new yn({multihash:e.multihash});if(t.digest.length===vo)return new gn({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function wo(e,t){return e.length===mo?new yn({multihash:Ke(cr.code,e),privateKey:t}):e.length===vo?new gn({multihash:Ke(cr.code,e),privateKey:t}):new dn({multihash:await Vt.digest(e),publicKey:e,privateKey:t})}var as;(function(e){let t;e.codec=()=>(t==null&&(t=Ar((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.webtransportCerthashes!=null)for(let s of r.webtransportCerthashes)n.uint32(10),n.bytes(s);i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={webtransportCerthashes:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.webtransportCerthashes.push(r.bytes());break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>Br(r,e.codec()),e.decode=r=>Sr(r,e.codec())})(as||(as={}));var ri;(function(e){let t;e.codec=()=>(t==null&&(t=Ar((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),(i.writeDefaults===!0||r.identityKey!=null&&r.identityKey.byteLength>0)&&(n.uint32(10),n.bytes(r.identityKey)),(i.writeDefaults===!0||r.identitySig!=null&&r.identitySig.byteLength>0)&&(n.uint32(18),n.bytes(r.identitySig)),r.extensions!=null&&(n.uint32(34),as.codec().encode(r.extensions,n,{writeDefaults:!1})),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.identityKey=r.bytes();break;case 2:i.identitySig=r.bytes();break;case 4:i.extensions=as.codec().decode(r,r.uint32());break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>Br(r,e.codec()),e.decode=r=>Sr(r,e.codec())})(ri||(ri={}));async function xh(e,t,r){let n=await rg(e,mh(t));if(e.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return eg(e.publicKey,n,r)}function eg(e,t,r){return ri.encode({identityKey:e,identitySig:t,extensions:r??{webtransportCerthashes:[]}}).subarray()}async function rg(e,t){if(e.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return await(await ph(e.privateKey)).sign(t)}async function bo(e){return await wo(e.identityKey)}function Eo(e){return ri.decode(e)}function mh(e){let t=qt("noise-libp2p-static-key:");return Ut([t,e],t.length+e.length)}async function So(e,t,r){let n=await wo(t.identityKey);if(!n.equals(r))throw new Error("Peer ID doesn't match libp2p public key.");let i=mh(e);if(n.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(t.identitySig==null)throw new Error("Signature was missing from message");if(!await lh(n.publicKey).verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function ni(e){return!(!(e instanceof Uint8Array)||e.length!==32)}var Oe=Y(Sh(),1);Oe.default.formatters.b=e=>e==null?"undefined":Ht.baseEncode(e);Oe.default.formatters.t=e=>e==null?"undefined":fr.baseEncode(e);Oe.default.formatters.m=e=>e==null?"undefined":$r.baseEncode(e);Oe.default.formatters.p=e=>e==null?"undefined":e.toString();Oe.default.formatters.c=e=>e==null?"undefined":e.toString();Oe.default.formatters.k=e=>e==null?"undefined":e.toString();function Bh(e){return Object.assign((0,Oe.default)(e),{error:(0,Oe.default)(`${e}:error`),trace:(0,Oe.default)(`${e}:trace`)})}var Mt=Bh("libp2p:noise");var ge;$o?ge=Mt:ge=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function Ah(e){ge(`LOCAL_STATIC_PUBLIC_KEY ${_t(e.publicKey,"hex")}`),ge(`LOCAL_STATIC_PRIVATE_KEY ${_t(e.privateKey,"hex")}`)}function Bo(e){e?(ge(`LOCAL_PUBLIC_EPHEMERAL_KEY ${_t(e.publicKey,"hex")}`),ge(`LOCAL_PRIVATE_EPHEMERAL_KEY ${_t(e.privateKey,"hex")}`)):ge("Missing local ephemeral keys.")}function _h(e){ge(`REMOTE_STATIC_PUBLIC_KEY ${_t(e,"hex")}`)}function Ao(e){ge(`REMOTE_EPHEMERAL_PUBLIC_KEY ${_t(e,"hex")}`)}function Ch(e){e.cs1&&e.cs2?(ge(`CIPHER_STATE_1 ${e.cs1.n.getUint64()} ${_t(e.cs1.k,"hex")}`),ge(`CIPHER_STATE_2 ${e.cs2.n.getUint64()} ${_t(e.cs2.k,"hex")}`)):ge("Missing cipher state.")}var yg="Cipherstate has reached maximum n, a new handshake must be performed",cs=class{constructor(t=0){this.n=t,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,t,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error(yg)}};var us=class{constructor(t){this.crypto=t}encryptWithAd(t,r,n){let i=this.encrypt(t.k,t.n,r,n);return t.n.increment(),i}decryptWithAd(t,r,n,i){let{plaintext:s,valid:a}=this.decrypt(t.k,t.n,r,n,i);return a&&t.n.increment(),{plaintext:s,valid:a}}hasKey(t){return!this.isEmptyKey(t.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(t){let r=this.createEmptyKey();return Nt(r,t)}encrypt(t,r,n,i){return r.assertValue(),this.crypto.chaCha20Poly1305Encrypt(i,r.getBytes(),n,t)}encryptAndHash(t,r){let n;return this.hasKey(t.cs)?n=this.encryptWithAd(t.cs,t.h,r):n=r,this.mixHash(t,n),n}decrypt(t,r,n,i,s){r.assertValue();let a=this.crypto.chaCha20Poly1305Decrypt(i,r.getBytes(),n,t,s);return a?{plaintext:a,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(t,r){let n,i=!0;return this.hasKey(t.cs)?{plaintext:n,valid:i}=this.decryptWithAd(t.cs,t.h,r):n=r,this.mixHash(t,r),{plaintext:n,valid:i}}dh(t,r){try{let n=this.crypto.generateX25519SharedKey(t,r);return n.length===32?n:n.subarray(0,32)}catch(n){return Mt(n.message),new Uint8Array(32)}}mixHash(t,r){t.h=this.getHash(t.h,r)}getHash(t,r){return this.crypto.hashSHA256(Ut([t,r],t.length+r.length))}mixKey(t,r){let[n,i]=this.crypto.getHKDF(t.ck,r);t.cs=this.initializeKey(i),t.ck=n}initializeKey(t){return{k:t,n:new cs}}initializeSymmetric(t){let r=qt(t,"utf-8"),n=this.hashProtocolName(r),i=n,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:i,h:n}}hashProtocolName(t){if(t.length<=32){let r=new Uint8Array(32);return r.set(t),r}else return this.getHash(t,new Uint8Array(0))}split(t){let[r,n]=this.crypto.getHKDF(t.ck,new Uint8Array(0)),i=this.initializeKey(r),s=this.initializeKey(n);return{cs1:i,cs2:s}}writeMessageRegular(t,r){let n=this.encryptWithAd(t,new Uint8Array(0),r),i=this.createEmptyKey(),s=new Uint8Array(0);return{ne:i,ns:s,ciphertext:n}}readMessageRegular(t,r){return this.decryptWithAd(t,new Uint8Array(0),r.ciphertext)}};var hs=class extends us{initializeInitiator(t,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",a=this.initializeSymmetric(s);this.mixHash(a,t);let o=new Uint8Array(32);return{ss:a,s:r,rs:n,psk:i,re:o}}initializeResponder(t,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",a=this.initializeSymmetric(s);this.mixHash(a,t);let o=new Uint8Array(32);return{ss:a,s:r,rs:n,psk:i,re:o}}writeMessageA(t,r,n){let i=new Uint8Array(0);n!==void 0?t.e=n:t.e=this.crypto.generateX25519KeyPair();let s=t.e.publicKey;this.mixHash(t.ss,s);let a=this.encryptAndHash(t.ss,r);return{ne:s,ns:i,ciphertext:a}}writeMessageB(t,r){t.e=this.crypto.generateX25519KeyPair();let n=t.e.publicKey;this.mixHash(t.ss,n),this.mixKey(t.ss,this.dh(t.e.privateKey,t.re));let i=t.s.publicKey,s=this.encryptAndHash(t.ss,i);this.mixKey(t.ss,this.dh(t.s.privateKey,t.re));let a=this.encryptAndHash(t.ss,r);return{ne:n,ns:s,ciphertext:a}}writeMessageC(t,r){let n=t.s.publicKey,i=this.encryptAndHash(t.ss,n);this.mixKey(t.ss,this.dh(t.s.privateKey,t.re));let s=this.encryptAndHash(t.ss,r),o={ne:this.createEmptyKey(),ns:i,ciphertext:s},{cs1:f,cs2:c}=this.split(t.ss);return{h:t.ss.h,messageBuffer:o,cs1:f,cs2:c}}readMessageA(t,r){return ni(r.ne)&&(t.re=r.ne),this.mixHash(t.ss,t.re),this.decryptAndHash(t.ss,r.ciphertext)}readMessageB(t,r){if(ni(r.ne)&&(t.re=r.ne),this.mixHash(t.ss,t.re),!t.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(t.ss,this.dh(t.e.privateKey,t.re));let{plaintext:n,valid:i}=this.decryptAndHash(t.ss,r.ns);i&&ni(n)&&(t.rs=n),this.mixKey(t.ss,this.dh(t.e.privateKey,t.rs));let{plaintext:s,valid:a}=this.decryptAndHash(t.ss,r.ciphertext);return{plaintext:s,valid:i&&a}}readMessageC(t,r){let{plaintext:n,valid:i}=this.decryptAndHash(t.ss,r.ns);if(i&&ni(n)&&(t.rs=n),!t.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(t.ss,this.dh(t.e.privateKey,t.rs));let{plaintext:s,valid:a}=this.decryptAndHash(t.ss,r.ciphertext),{cs1:o,cs2:f}=this.split(t.ss);return{h:t.ss.h,plaintext:s,valid:i&&a,cs1:o,cs2:f}}initSession(t,r,n){let i=this.createEmptyKey(),s=new Uint8Array(32),a;return t?a=this.initializeInitiator(r,n,s,i):a=this.initializeResponder(r,n,s,i),{hs:a,i:t,mc:0}}sendMessage(t,r,n){let i;if(t.mc===0)i=this.writeMessageA(t.hs,r,n);else if(t.mc===1)i=this.writeMessageB(t.hs,r);else if(t.mc===2){let{h:s,messageBuffer:a,cs1:o,cs2:f}=this.writeMessageC(t.hs,r);i=a,t.h=s,t.cs1=o,t.cs2=f}else if(t.mc>2)if(t.i){if(!t.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(t.cs1,r)}else{if(!t.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(t.cs2,r)}else throw new Error("Session invalid.");return t.mc++,i}recvMessage(t,r){let n=new Uint8Array(0),i=!1;if(t.mc===0)({plaintext:n,valid:i}=this.readMessageA(t.hs,r));else if(t.mc===1)({plaintext:n,valid:i}=this.readMessageB(t.hs,r));else if(t.mc===2){let{h:s,plaintext:a,valid:o,cs1:f,cs2:c}=this.readMessageC(t.hs,r);n=a,i=o,t.h=s,t.cs1=f,t.cs2=c}return t.mc++,{plaintext:n,valid:i}}};var ls=class{constructor(t,r,n,i,s,a,o,f){this.remoteExtensions={webtransportCerthashes:[]},this.isInitiator=t,this.payload=r,this.prologue=n,this.staticKeypair=s,this.connection=a,o&&(this.remotePeer=o),this.xx=f??new hs(i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(Ah(this.session.hs.s),this.isInitiator){Mt("Stage 0 - Initiator starting to send first message.");let t=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(L0(t)),Mt("Stage 0 - Initiator finished sending first message."),Bo(this.session.hs.e)}else{Mt("Stage 0 - Responder waiting to receive first message...");let t=N0((await this.connection.readLP()).subarray()),{valid:r}=this.xx.recvMessage(this.session,t);if(!r)throw new Ge("xx handshake stage 0 validation fail");Mt("Stage 0 - Responder received first message."),Ao(this.session.hs.re)}}async exchange(){if(this.isInitiator){Mt("Stage 1 - Initiator waiting to receive first message from responder...");let t=P0((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new Ge("xx handshake stage 1 validation fail");Mt("Stage 1 - Initiator received the message."),Ao(this.session.hs.re),_h(this.session.hs.rs),Mt("Initiator going to check remote's signature...");try{let i=Eo(r);this.remotePeer=this.remotePeer||await bo(i),await So(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let s=i;throw new vr(`Error occurred while verifying signed payload: ${s.message}`)}Mt("All good with the signature!")}else{Mt("Stage 1 - Responder sending out first message with signed payload and static key.");let t=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(R0(t)),Mt("Stage 1 - Responder sent the second handshake message with signed payload."),Bo(this.session.hs.e)}}async finish(){if(this.isInitiator){Mt("Stage 2 - Initiator sending third handshake message.");let t=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(U0(t)),Mt("Stage 2 - Initiator sent message with signed payload.")}else{Mt("Stage 2 - Responder waiting for third handshake message...");let t=k0((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new Ge("xx handshake stage 2 validation fail");Mt("Stage 2 - Responder received the message, finished handshake.");try{let i=Eo(r);this.remotePeer=this.remotePeer||await bo(i),await So(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let s=i;throw new vr(`Error occurred while verifying signed payload: ${s.message}`)}}Ch(this.session)}encrypt(t,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,new Uint8Array(0),t)}decrypt(t,r,n){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,new Uint8Array(0),t,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(t,r=!0){if(!t.cs1||!t.cs2)throw new Ge("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?t.cs1:t.cs2:r?t.cs2:t.cs1}setRemoteNoiseExtension(t){t&&(this.remoteExtensions=t)}};function Th(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}var ps=class{constructor(t={}){this.protocol="/noise";let{staticNoiseKey:r,extensions:n,crypto:i,prologueBytes:s,metrics:a}=t;this.crypto=i??Ks,this.extensions=n,this.metrics=a?Th(a):void 0,r?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(r):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=s??new Uint8Array(0)}async secureOutbound(t,r,n){let i=gs(r,{lengthEncoder:Hr,lengthDecoder:Cn,maxDataLength:65535}),s=await this.performHandshake({connection:i,isInitiator:!0,localPeer:t,remotePeer:n});return{conn:await this.createSecureConnection(i,s),remoteExtensions:s.remoteExtensions,remotePeer:s.remotePeer}}async secureInbound(t,r,n){let i=gs(r,{lengthEncoder:Hr,lengthDecoder:Cn,maxDataLength:65535}),s=await this.performHandshake({connection:i,isInitiator:!1,localPeer:t,remotePeer:n});return{conn:await this.createSecureConnection(i,s),remotePeer:s.remotePeer,remoteExtensions:s.remoteExtensions}}async performHandshake(t){let r=await xh(t.localPeer,this.staticKeys.publicKey,this.extensions);return await this.performXXHandshake(t,r)}async performXXHandshake(t,r){let{isInitiator:n,remotePeer:i,connection:s}=t,a=new ls(n,r,this.prologue,this.crypto,this.staticKeys,s,i);try{await a.propose(),await a.exchange(),await a.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(o){if(this.metrics?.xxHandshakeErrors.increment(),o instanceof Error)throw o.message=`Error occurred during XX handshake: ${o.message}`,o}return a}async createSecureConnection(t,r){let[n,i]=Do(),s=t.unwrap();return await Xo(n,K0(r,this.metrics),s,xr({lengthDecoder:Cn}),F0(r,this.metrics),n),i}};function gg(e={}){return()=>new ps(e)}return Ph(xg);})();
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
return ChainsafeLibp2PNoise}));
